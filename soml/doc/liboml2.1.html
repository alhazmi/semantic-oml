<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.7" />
<title>liboml2(1)</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

pre {
  padding: 0;
  margin: 0;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

tt {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
}

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

.monospaced {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
}

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}
</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install();
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>liboml2(1)</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="_name">NAME</h2>
<div class="sectionbody">
<div class="paragraph"><p>liboml2 - OML2 client library</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_synopsis">SYNOPSIS</h2>
<div class="sectionbody">
<div class="verseblock">
<pre class="content"><strong>&lt;oml2-enabled-app&gt;</strong> [APP-OPTIONS]
            [--oml-id OML_NAME --oml-domain OML_DOMAIN
              [--oml-collect OML_COLLECT] | --oml-noop]
            [--oml-instr-interval SECONDS]
            [--oml-interval SECONDS | --oml-samples COUNT]
            [--oml-log-level -2..4] [--oml-log-file]
            [--oml-config liboml2.conf]
            [--oml-bufsize BYTES]
            [--oml-text|--oml-binary]
            [--oml-help] [--oml-list-filters]
            [--oml-&#8230;]</pre>
<div class="attribution">
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_description">DESCRIPTION</h2>
<div class="sectionbody">
<div class="paragraph"><p><strong>liboml2</strong> is the client library for OML2.  It provides an API for
application writers to collect measurements from their applications via
user-defined <em>Measurement Points</em> (MPs).  It also provides a flexible
filtering and collection mechanism that allows application users to
customize how measurements are processed and stored by an OML-enabled
application. Data <em>injected</em> into an MP by the application is serialised
into a <em>Measurement Stream</em> (MS), and sent to a <em>Collection Point</em>
(e.g., an <a href="oml2-server.1.html">oml2-server(1)</a> or a file).  Measurement samples can
also be filtered, pre-processed or aggregated using a set of built-in
filters.</p></div>
<div class="paragraph"><p>This man page documents the command-line user configuration of
OML-enabled applications.  Application writers who want to learn how
to write an application using the <strong>liboml2</strong> API should consult
<a href="liboml2.3.html">liboml2(3)</a>. OML also supports an external configuration file,
documented in <a href="liboml2.conf.5.html">liboml2.conf(5)</a>.</p></div>
<div class="paragraph"><p>When an OML application starts up, it passes the command line arguments
to <strong>liboml2</strong>, which scans them for options that it understands, and uses
those to configure itself.  <strong>liboml2</strong> then removes its own options from
the command line so that the application proper does not get confused by
them.  All OML options start with the prefix <strong>--oml-</strong>.  The <strong>--oml-help</strong>
option lists all the known OML command line options.</p></div>
<div class="paragraph"><p>The command line options recognized by <strong>liboml2</strong> allow for a basic
configuration of the measurement library.  They are adequate for
testing and debugging, but do not offer as much flexibility as the
external configuration file format supports.  You can pass a
configuration file to <strong>liboml2</strong> using the <strong>--oml-config</strong> option.  For
details, see <a href="liboml2.conf.5.html">liboml2.conf(5)</a>.</p></div>
<div class="paragraph"><p>By default, any instrumentation starts with two OML-specific MPs. The
first one, <em>_experiment_metadata</em>, contains information about the
experiment currently running, as well as application specific details
that would not justify a full MP on their own such as version, command
line invokation, or unit or precision of some fields. The second
automatic MP is <em>_client_instrumentation</em>. When enabled (see option
<strong>--oml-instr-interval</strong> in <a href="#_oml_options">OML OPTIONS</a> below), the
application will periodically inject status report into that stream.
Status reports contain the following information</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_measurement_filtering">MEASUREMENT FILTERING</h2>
<div class="sectionbody">
<div class="paragraph"><p>The <strong>liboml2</strong> can process measurement tuples in-line before they are
sent to a collection point. The filtering mechanism allows to select a
subset of the fields of an MP which need to be sent along, apply
aggregation or summary functions on them rather than sending them
verbatim, and set the periodicity (time- or sample- based) at which
aggregate reports are sent (see <strong>--oml-interval</strong> or <strong>--oml-samples</strong> in
<a href="#_oml_options">OML OPTIONS</a> below).</p></div>
<div class="paragraph"><p>When no configuration file is given, <strong>liboml2</strong> provides a basic set of
filters for each MP, and sends measurements to just one
location (using the <strong>--oml-collect</strong> option).  For each measurement
point, each element of the measurement point&#8217;s injected tuple is given
its own filter.  The filter created depends on the type of the element
and the current sampling policy.</p></div>
<div class="paragraph"><p>For instance, suppose a measurement point defined with a measurement tuple
as follows:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>MeasurementPoint (name = "link_properties")
("source"      : OML_UINT64_VALUE,
 "destination" : OML_UINT64_VALUE,
 "length"      : OML_INT32_VALUE,
 "snr"         : OML_DOUBLE_VALUE,
 "name"        : OML_STRING_VALUE)</tt></pre>
</div></div>
<div class="paragraph"><p>Then <strong>liboml2</strong> will create a separate filter for each of "source",
"destination", "length", "snr", and "name".  The filters for the first
four numeric elements will be an averaging filter (filter type
<em>avg</em>), and the last string element will be given a <em>first</em> filter.
The <em>first</em> filter keeps the first injected value in the current
sampling period and throws away all others, passing the first value on
to the measurement output stage.</p></div>
<div class="paragraph"><p>The exception to this rule is that if <strong>--oml-samples</strong> was given, and
if the argument is 1, then numeric elements are filtered using the
<em>first</em> filter, not the averaging filter.</p></div>
<div class="paragraph"><p>For more information on OML filters and how they are configured, see
the documentation for the configuration file format,
<a href="liboml2.conf.5.html">liboml2.conf(5)</a>. For more information on measurement points and how
they are defined, see <a href="liboml2.3.html">liboml2(3)</a> and <a href="omlc_add_mp.3.html">omlc_add_mp(3)</a>.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_measurement_streams_and_schemas">MEASUREMENT STREAMS AND SCHEMAS</h2>
<div class="sectionbody">
<div class="paragraph"><p>Where MSs generated by an OML instrumentation are sent depends on the
collection URI (see <a href="#_uri_format">URI FORMAT</a> below). If using the
<strong>tcp</strong> scheme, it is sent to the named <a href="oml2-server.1.html">oml2-server(1)</a>, for
storage in an SQL database, while  using the <strong>file</strong> or <strong>flush</strong> schemes
will create a local file with the given name containing OML text mode
protocol which can later on be stream (e.g., using <a href="http://linux.die.net/man/1/nc">nc(1)</a>) to an
<strong>oml2-server</strong>. Measurement points are created with a <em>schema</em>, as above,
a schema being an ordered list of (name, type) pairs.</p></div>
<div class="paragraph"><p>OML filters also generate output with a declared schema. For each
measurement point, <strong>liboml2</strong> generates a single output measurement that
is the union of the outputs of all filters attached to the MP.  The
names of the fields (or columns) of the schema are derived from the
names of the original MP fields, and the output schemas of the filters.
The schemas can be observed directly with the <strong>file</strong> collection URI
schemes (e.g., <strong>file:-</strong>) output (identical schemas are sent to the
server when the <strong>tcp</strong> scheme is used).  For instance, here is the output
schema for a simple example MP that measures a string ("label") and an
integer ("seq_no"):</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>schema: 1 generator_lin label:string seq_no:uint32</tt></pre>
</div></div>
<div class="paragraph"><p>The schema name is "generator_lin"&#8201;&#8212;&#8201;a combination of the application
name ("generator") and the measurement point name ("lin").  (The
number <em>1</em> on this line is an index used in the output columns to
identify a line of measurement with the schema to which it conforms.)
This output was made using <strong>--oml-samples 1</strong> on the command line.
This creates a <em>first</em> filter for both of the fields of the
measurement point.  The <em>first</em> filter outputs a single value that has
the same type as the filter&#8217;s input.</p></div>
<div class="paragraph"><p>If we change the command line to use <strong>--oml-samples 2</strong>, then an
averaging filter is used for the numeric "seq_no" field ("label" is
unchanged).  The schema therefore changes as well:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>schema: 1 generator_lin label:string \
                        seq_no_avg:double \
                        seq_no_min:double \
                        seq_no_max:double</tt></pre>
</div></div>
<div class="paragraph"><p>(<strong>liboml2</strong> always emits schemas on a single line, but this schema is
split into several for readability.)</p></div>
<div class="paragraph"><p>An <em>avg</em> filter picks one field of the MP to filter (in this case
"seq_no") and then produces a 3-tuple as output (avg, min, max).
Therefore <strong>liboml2</strong> creates a schema for this filter output that looks
like:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>("seq_no_avg" : OML_DOUBLE_VALUE,
 "seq_no_min" : OML_DOUBLE_VALUE,
 "seq_no_max" : OML_DOUBLE_VALUE)</tt></pre>
</div></div>
<div class="paragraph"><p>This is the general pattern for filters:  their output schemas are
formed by appending the name of the source MP with the name of the
filter output field.  (The <em>first</em> filter is an exception in that it
just takes the name of the input field and uses that as the output
field name.)</p></div>
<div class="paragraph"><p>When a <strong>tcp</strong> collection URI is specified, the received <strong>oml2-server</strong>
creates a database table for each measurement point using the combined
OML output schema as schema for the table.  For instance, the above
example would translate to an SQL CREATE TABLE statement like:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>CREATE TABLE generator_lin (label TEXT, seq_no_avg REAL, seq_no_min REAL, seq_no_max REAL);</tt></pre>
</div></div>
<div class="paragraph"><p>Note that even though an MP field may have an integral type, it may be
represented as a floating point type in the output because the filter
may output floating point values.  For instance, the average of a set
of integers is real valued because of the division in the averaging
operation.</p></div>
<div class="paragraph"><p>Another situation may arise when a table by the same name, but with a
different schema, already exists in the target database. In this case,
the <a href="oml2-server.1.html">oml2-server(1)</a> tries to incrementally number the new
table&#8217;s name (e.g., <em>mymp_2</em>, <em>mymp_3</em>,&#8230; for stream <em>mymp</em>). It
makes 9 attempts at renaming the table before failing. Indeed, it
would be unwise for experiments that use a large number of instances
of the same application with different filter configuration to not
explicitly name each of them. This can be done through the use of a
configuration file, with these <em>rename</em> attribute of the relevant <em>mp</em>
element, see <a href="liboml2.conf.5.html">liboml2.conf(5)</a>.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_oml_options">OML OPTIONS</h2>
<div class="sectionbody">
<div class="dlist"><dl>
<dt class="hdlist1">
--oml-id OML_NAME
</dt>
<dd>
<p>
Set the OML client&#8217;s identity to <em>OML_NAME</em>.  This is used by the
<a href="oml2-server.1.html">oml2-server(1)</a> to distinguish measurements of the same type from
different sources (for example, the same application running on a
different machine).  If <strong>--oml-id</strong> is not given, an error is
printed and measurement collection will not occur (although the
application may still run).
</p>
</dd>
<dt class="hdlist1">
--oml-domain OML_DOMAIN
</dt>
<dt class="hdlist1">
--oml-exp-id OML_DOMAIN
</dt>
<dd>
<p>
Set the OML client&#8217;s experimental domain to <em>OML_DOMAIN</em>.  This is used by
the <a href="oml2-server.1.html">oml2-server(1)</a> to group measurements from different clients
that logically belong to the same group.  Multiple applications running
on different machines can contribute measurements to the same
experiment.  If <strong>--oml-domain</strong> is not given, an error is written to the
log file and measurement collection will not occur (although the
application may still run). The <strong>--oml-exp-id</strong> option is obsolescent,
and <strong>--oml-domain</strong> should be preferred.
</p>
</dd>
<dt class="hdlist1">
--oml-collect OML_COLLECT
</dt>
<dt class="hdlist1">
--oml-server OML_COLLECT
</dt>
<dd>
<p>
Send measurements to the OML server specified by the <em>OML_COLLECT</em> URI.
Only one of <strong>--oml-collect</strong> or <strong>--oml-server</strong> can be active at a time.
The format of <em>OML_COLLECT</em> is described in <a href="#_URI_format">URI
FORMAT</a> below.  The <em>OML_COLLECT</em> can specify the address and port at
which either an <strong>oml2-server</strong> or an <strong>oml2-proxy-server</strong> is listening.
The <strong>--oml-server</strong> option is obsolescent, and <strong>--oml-collect</strong> should be
preferred.
</p>
</dd>
<dt class="hdlist1">
--oml-file FILENAME
</dt>
<dd>
<p>
Write measurements to file <em>FILENAME</em>, in a human readable text format.
This is an exact equivalent to <strong>--oml-collect file:FILENAME</strong>, see below.
Only one of <strong>--oml-collect</strong> (or <strong>--oml-server</strong>) or*--oml-file* can be
specified at a time. This command line option is obsolescent, and
<strong>--oml-collect</strong> with the <strong>file</strong> scheme should be preferred.
</p>
</dd>
<dt class="hdlist1">
--oml-noop
</dt>
<dd>
<p>
If this option is given, no measurements are collected, and the
application does not attempt to connect to an OML server or write
measurements to file.
</p>
</dd>
<dt class="hdlist1">
--oml-instr-interval SECONDS
</dt>
<dd>
<p>
This option allows to set the periodicity of self-instrumentation
reports into the <em>_client_instrumentation</em> MS. The defaults is 1000ms,
and the feature can be disabled altogether by setting it to 0.
</p>
</dd>
<dt class="hdlist1">
--oml-interval SECONDS
</dt>
<dd>
<p>
Make all measurement point filters produce an output periodically with
a time period of <em>SECONDS</em>.  Only one of <strong>--oml-interval</strong> and
<strong>--oml-samples</strong> can be given on the same command line.
</p>
</dd>
<dt class="hdlist1">
--oml-samples COUNT
</dt>
<dd>
<p>
Make all measurement point filters produce an output after every <em>COUNT</em>
samples have been injected into them.  Only one of <strong>--oml-samples</strong> and
<strong>--oml-interval</strong> can be given on the same command line.  If neither
<strong>--oml-samples</strong> nor <strong>--oml-interval</strong> are given, then <strong>liboml2</strong> behaves
as if <strong>--oml-samples</strong> was given with an argument of <em>COUNT</em>=1.
</p>
</dd>
<dt class="hdlist1">
--oml-config FILE
</dt>
<dd>
<p>
Read the contents of <em>FILE</em> and use them to configure the <strong>liboml2</strong>
client.  See <a href="liboml2.conf.5.html">liboml2.conf(5)</a> for details of the configuration
file format.  Generally, the configuration taken from <em>FILE</em> overrides
any equivalents from the command line.  Command line options that cannot
be set using the configuration file are <strong>--oml-noop</strong>,
<strong>--oml-instr-interval</strong>, <strong>--oml-bufsize</strong>, <strong>--oml-log-level</strong>, and
<strong>--oml-log-file</strong>.
</p>
</dd>
<dt class="hdlist1">
--oml-log-level n
</dt>
<dd>
<p>
Record logging information at a level of detail given by <em>n</em>, which
should be an integer from 0 to 4.  The default level of logging is 0,
which prints <em>ERROR</em>, <em>WARNING</em>, and <em>INFO</em> messages.  Levels 1 to 4
add gradually larger amounts of debug logging (<em>DEBUG</em>, <em>DEBUG2</em>,
<em>DEBUG3</em>, <em>DEBUG4</em>).  It is possible to set <em>n</em> to -1 for only <em>ERROR</em>
and <em>WARNING</em> logging, or -2 for only <em>ERROR</em> logging.
</p>
</dd>
<dt class="hdlist1">
--oml-log-file file
</dt>
<dd>
<p>
Write OML logging information to <em>file</em>.  The amount of logging
information recorded is controlled by <strong>--oml-log-level</strong>.
</p>
</dd>
</dl></div>
<div class="paragraph"><p>By default, the OML library logs messages to the application&#8217;s <strong>stderr</strong>,
prefixed with the level of the messages. If logging to a file, messages
are also prefixed with a timestamp. The application writer can override
this behaviour by providing a custom logging function when calling
<a href="omlc_init.3.html">omlc_init(3)</a>.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
--oml-bufsize size (bytes)
</dt>
<dd>
<p>
Set the size of internal buffers used by <strong>liboml2</strong>.  There is one
buffer per output destination, and each one is allowed to grow to
roughly this size in bytes.  For various reasons the buffers can grow
a certain amount more than this size, but will still be bounded.
<strong>--oml-bufsize</strong> specifies the lower bound on the maximum buffer size.
The default is 2048 bytes.  If the maximum allowed buffer size is
exceeded, <strong>liboml2</strong> will start dropping measurement data (with a
message in the client log file).  Increasing the buffer size may
prevent this from happening, depending on the application design.
</p>
</dd>
<dt class="hdlist1">
--oml-text
</dt>
<dd>
<p>
Encode measurements using text format when writing to either a local
file or a remote server. Text format is easy for scripts to parse, with
one measurement per line, and is the default when a <strong>file</strong> URI scheme is
used. Only one of <strong>--oml-text</strong> and <strong>--oml-binary</strong> should be used on the
same command line.
</p>
</dd>
<dt class="hdlist1">
--oml-binary
</dt>
<dd>
<p>
Encode measurements using binary format when writing to either a local
file or a remote server. The binary format is the default when <strong>tcp</strong>
URI scheme is given, and provides better performance.  Only one of
<strong>--oml-text</strong> and <strong>--oml-binary</strong> should be used on the same command line.
</p>
</dd>
<dt class="hdlist1">
--oml-help
</dt>
<dd>
<p>
Prints a summary of the available OML options.
</p>
</dd>
<dt class="hdlist1">
--oml-list-filters
</dt>
<dd>
<p>
This option prints the available filters to the console and then
quits the application.
</p>
</dd>
</dl></div>
</div>
</div>
<div class="sect1">
<h2 id="_uri_format">URI FORMAT</h2>
<div class="sectionbody">
<div class="paragraph"><p><strong>liboml2</strong> accepts a <em>uri</em> argument for the <strong>--oml-collect</strong> option that
is similar to an IETF URI (see e.g. RFC3986).  The OML URI consists of
an optional network protocol, a host identifier, and an optional port
number, or a mandatory <strong>file</strong> (or <strong>flush</strong> )scheme and a local filesystem
path.  The format of the network server version is:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>[tcp:][//]&lt;host&gt;[:&lt;port&gt;]</tt></pre>
</div></div>
<div class="paragraph"><p>The formats for the local file version is:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>(file|flush):&lt;local-path&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>For instance, <em>tcp:collect.example.net:3003</em> or
<em>tcp://collect.example.net:3003</em> will send measurements to an
<strong>oml2-server</strong> listening on port <em>3003</em> on host <em>collect.example.net</em>,
using TCP. The <em>//</em> is recognized but optional and not recommended.
Either a hostname or an IP address can be used as the <em>&lt;host&gt;</em>
specifier. Both IPv4 and IPv6 addresses are supported, but it is
mandatory to put the latter between square brackets; this is optional
for the former.  <em>tcp:[2001:db8::1]:3003</em>, <em>tcp:[192.0.2.200]:3003</em> and
<em>tcp:192.0.2.200:3003</em> are all valid forms.  The <em>&lt;port&gt;</em> specifier is
optional, defaulting to port 3003. The <strong>tcp</strong> scheme is the default if
this part is omitted.</p></div>
<div class="paragraph"><p>Alternatively, <em>file:/tmp/myfile.txt</em> writes to the /tmp/myfile.txt file
in the local filesystem. Relative paths are also accepted. There should
be no double-slash after the colon: <em>file://myfile.txt</em> is treated the
same as <em>file:/myfile.txt</em>, i.e., it will try to write the output in the
root directory. The special file URL <em>file:-</em> will write output to the
standard output. The <strong>flush</strong> scheme behaves exactly in the same way as
<strong>file</strong> except the file descriptor is flushed after each a measurement
line is written out. This allows to prevent any size-based buffering in
the C library from delaying the recording of samples. This is useful in
case of, e.g., real time graphing of the data based on the contents of
the file.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_environment_variables">ENVIRONMENT VARIABLES</h2>
<div class="sectionbody">
<div class="paragraph"><p><strong>liboml2</strong> recognizes the following environment variables.  Note that
the equivalent command line options override any value set in an
environment variable.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
OML_NAME
</dt>
<dd>
<p>
The name to identify this client to the OML server, equivalent to the
<strong>--oml-id</strong> command line option.
</p>
</dd>
<dt class="hdlist1">
OML_DOMAIN
</dt>
<dt class="hdlist1">
OML_EXP_ID
</dt>
<dd>
<p>
The name of the experiment to which this client&#8217;s measurements belong.
Used for grouping measurements into the same database on the server.
Equivalent to the <strong>--oml-domain</strong> command line option. <em>OML_EXP_ID</em> is
obsolescent and kept for backward compatibility.
</p>
</dd>
<dt class="hdlist1">
OML_CONFIG
</dt>
<dd>
<p>
The path to the configuration file to use to configure the client.
Equivalent to the <strong>--oml-config</strong> command line option.
</p>
</dd>
<dt class="hdlist1">
OML_COLLECT
</dt>
<dt class="hdlist1">
OML_SERVER
</dt>
<dd>
<p>
The URI of the server to which the measurements should be sent.  The
value of this environment variable should be a URI in the same format
specified above (<a href="#_uri_format">URI FORMAT</a>).  If the URI specifies
the <strong>file</strong> scheme, the measurements are written to the local text
file specified in the URI, rather than being sent to an OML server.
Equivalent to the <strong>--oml-collect</strong> command line option. <em>OML_SERVER</em> is
obsolescent and kept for backward compatibility.
</p>
</dd>
<dt class="hdlist1">
OML_FEATURES
</dt>
<dd>
<p>
A comma-separated list of run-time features to enable.  Currently the
following are recognized:
</p>
<div class="ulist"><ul>
<li>
<p>
"default-log-simple" (default): All log output will be sent to
<strong>stderr</strong> if no log file was selected using --oml-log-file, or if the
argument of --oml-log-file was "-", and the logging will use new-style
logging to <strong>stderr</strong>.  This means all log messages are prefixed with a
label indicating the severity, i.e., "ERROR", "WARN", "INFO", "DEBUG",
"DEBUG2", etc.
</p>
</li>
</ul></div>
</dd>
</dl></div>
</div>
</div>
<div class="sect1">
<h2 id="_bugs">BUGS</h2>
<div class="sectionbody">
<div class="paragraph"><p>The selection of the <em>first</em> filter when <strong>--oml-samples 1</strong> is used can
be confusing for numeric MP fields because it results in a different
schema in the measurement output compared to other possible
configurations available from the command line, which use the <em>avg</em>
filter.  It is not clear whether this is a feature or a bug.</p></div>
<div class="paragraph"><p>If a problem you are experiencing is not addressed in the FAQ
(<a href="http://oml.mytestbed.net/projects/oml/wiki/FAQ_and_Support">http://oml.mytestbed.net/projects/oml/wiki/FAQ_and_Support</a>) nor already
present in the list of know bugs
(<a href="http://oml.mytestbed.net/projects/oml/issues">http://oml.mytestbed.net/projects/oml/issues</a>). You could discuss it on
the mailing list (details and archives at
<a href="http://oml.mytestbed.net/tab/show?id=oml">http://oml.mytestbed.net/tab/show?id=oml</a>).</p></div>
<div class="paragraph"><p>It is however advisable to open a ticket on our issue tracker at
<a href="http://oml.mytestbed.net/projects/oml/issues/new">http://oml.mytestbed.net/projects/oml/issues/new</a>. Don&#8217;t forget to
include details such as client and server logs (at <em>[--oml-log-level|-d]
2</em>). It also helps if you can share the source code of a (minimal, if
possible) example reliably triggering the problem.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_security_considerations">SECURITY CONSIDERATIONS</h2>
<div class="sectionbody">
<div class="paragraph"><p><em>oml2-server</em> does not use any authentication, and should thus be
considered insecure.  It is intended to be deployed behind firewalls
on a dedicated testbed network.  It should not be run as a daemon on
an open network.  Future versions of OML may be re-designed to be
suitable for use in insecure environments.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_see_also">SEE ALSO</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_manual_pages">Manual Pages</h3>
<div class="paragraph"><p><a href="oml2-server.1.html">oml2-server(1)</a>, <a href="oml2-proxy-server.1.html">oml2-proxy-server(1)</a>,
<a href="liboml2.3.html">liboml2(3)</a>, <a href="omlc_add_mp.3.html">omlc_add_mp(3)</a>, <a href="liboml2.conf.5.html">liboml2.conf(5)</a></p></div>
</div>
<div class="sect2">
<h3 id="_oml_user_manual">OML User Manual</h3>
<div class="paragraph"><p><a href="http://oml.mytestbed.net/projects/oml/wiki/Documentation">http://oml.mytestbed.net/projects/oml/wiki/Documentation</a></p></div>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
OML 2.12.0pre.79-58cf-dirty<br />
Last updated 2015-04-16 15:28:57 CEST
</div>
<div id="footer-badges">
<a href="http://validator.w3.org/check?uri=referer">
  <img style="border:0;width:88px;height:31px"
    src="http://www.w3.org/Icons/valid-xhtml11-blue"
    alt="Valid XHTML 1.1" height="31" width="88" />
</a>
<a href="http://jigsaw.w3.org/css-validator/">
  <img style="border:0;width:88px;height:31px"
    src="http://jigsaw.w3.org/css-validator/images/vcss-blue"
    alt="Valid CSS!" />
</a>
</div>
</div>
</body>
</html>
