<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>oml2: oml_util.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="oml_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">oml2
   &#160;<span id="projectnumber">2.12.0pre.79-58cf-dirty</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('oml__util_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">oml_util.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Various utility functions, mainly strings and memory-buffer related.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;ctype.h&gt;</code><br/>
<code>#include &lt;netdb.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="o__log_8h_source.html">ocomm/o_log.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="mem_8h_source.html">mem.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="oml__util_8h_source.html">oml_util.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for oml_util.c:</div>
<div class="dyncontent">
<div class="center"><img src="oml__util_8c__incl.png" border="0" usemap="#oml__util_8c" alt=""/></div>
<map name="oml__util_8c" id="oml__util_8c">
<area shape="rect" id="node13" href="o__log_8h.html" title="ocomm/o_log.h" alt="" coords="449,160,559,189"/><area shape="rect" id="node17" href="mem_8h.html" title="mem.h" alt="" coords="405,83,467,112"/><area shape="rect" id="node23" href="oml__util_8h.html" title="oml_util.h" alt="" coords="541,83,619,112"/></map>
</div>
</div>
<p><a href="oml__util_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ac6dca18bed49e6af79497968c3fa3345"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oml__util_8c.html#ac6dca18bed49e6af79497968c3fa3345">find_matching</a>(p, cond, len)</td></tr>
<tr class="memitem:a01e625c53b427676cbf23166d697cbc2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oml__util_8c.html#a01e625c53b427676cbf23166d697cbc2">trydup</a>(i)&#160;&#160;&#160;(parts[(i)] &amp;&amp; lengths[(i)]&gt;0 ? <a class="el" href="mem_8h.html#adca1f9f48333b1fa9af21312a3f4534c">oml_strndup</a> (parts[(i)], lengths[(i)]) : NULL)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6752d536938b11aa1ced5549a1cf3c7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oml__util_8c.html#a6752d536938b11aa1ced5549a1cf3c7e">chomp</a> (char *<a class="el" href="check__liboml2__omlvalue_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>)</td></tr>
<tr class="memitem:a447ac0e4e6e7e4bbab27d86affb06250"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oml__util_8c.html#a447ac0e4e6e7e4bbab27d86affb06250">skip_white</a> (const char *p)</td></tr>
<tr class="memitem:a250ca001350b172fd3fc8a5006c8af5b"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oml__util_8c.html#a250ca001350b172fd3fc8a5006c8af5b">find_white</a> (const char *p)</td></tr>
<tr class="memitem:ae4c72bcf9c2be2551cf6d3a357443aeb"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oml__util_8c.html#ae4c72bcf9c2be2551cf6d3a357443aeb">find_charn</a> (const char *<a class="el" href="check__liboml2__omlvalue_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, char c, int len)</td></tr>
<tr class="memitem:aacb2dc8b1ec079eb501d1a69d320a5fe"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oml__util_8c.html#aacb2dc8b1ec079eb501d1a69d320a5fe">to_octets</a> (unsigned char *buf, int len)</td></tr>
<tr class="memitem:a00488a8fd0b3440c9d2e1bc421438cd5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oml__util_8c.html#a00488a8fd0b3440c9d2e1bc421438cd5">resolve_service</a> (const char *service, int defport)</td></tr>
<tr class="memitem:a301fddeafe0b5443ef133e7fc16af68f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="oml__util_8h.html#a457629626f00794579ce6e607b0827d7">OmlURIType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oml__util_8c.html#a301fddeafe0b5443ef133e7fc16af68f">oml_uri_type</a> (const char *uri)</td></tr>
<tr class="memitem:ab026ccb8032d813d97fe53004d39e12d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oml__util_8c.html#ab026ccb8032d813d97fe53004d39e12d">parse_uri</a> (const char *uri, const char **protocol, const char **path, const char **port)</td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Various utility functions, mainly strings and memory-buffer related. </p>

<p>Definition in file <a class="el" href="oml__util_8c_source.html">oml_util.c</a>.</p>
</div><h2>Macro Definition Documentation</h2>
<a class="anchor" id="ac6dca18bed49e6af79497968c3fa3345"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define find_matching</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">cond, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">len&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                                 \</div>
<div class="line">  while (len-- &amp;&amp; *p &amp;&amp; !(cond)) {  \</div>
<div class="line">    p++;                             \</div>
<div class="line">  }                                  \</div>
<div class="line">} <span class="keywordflow">while</span>(0)</div>
</div><!-- fragment --><p>Template code to search for a matching condition in a string or array up to a given length or nil-terminator.</p>
<p>p should be of a dereferenceable type that can be compared to 0.</p>
<p>If len is negative, this allows for a very long string to be parsed. Very long here being entirely machine dependent, one should not really rely on this...</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p</td><td>pointer to the beginning of the string or array; updated to the matching element, or the end of the search area if not found </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cond</td><td>success condition involving p </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">len</td><td>maximum length to search for; updated to the remaining number of characters when finishing (-1 if not found) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="oml__util_8c_source.html#l00048">48</a> of file <a class="el" href="oml__util_8c_source.html">oml_util.c</a>.</p>

<p>Referenced by <a class="el" href="oml__util_8c_source.html#l00089">find_charn()</a>, <a class="el" href="oml__util_8c_source.html#l00074">find_white()</a>, and <a class="el" href="oml__util_8c_source.html#l00061">skip_white()</a>.</p>

</div>
</div>
<a class="anchor" id="a01e625c53b427676cbf23166d697cbc2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define trydup</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">i</td><td>)</td>
          <td>&#160;&#160;&#160;(parts[(i)] &amp;&amp; lengths[(i)]&gt;0 ? <a class="el" href="mem_8h.html#adca1f9f48333b1fa9af21312a3f4534c">oml_strndup</a> (parts[(i)], lengths[(i)]) : NULL)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="oml__util_8c_source.html#l00231">parse_uri()</a>.</p>

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="a6752d536938b11aa1ced5549a1cf3c7e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void chomp </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove trailing space from a string </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">str</td><td>nil-terminated string to chomp, with the first trailing space replaced by '\0' </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="oml__util_8c_source.html#l00026">26</a> of file <a class="el" href="oml__util_8c_source.html">oml_util.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> *p = <a class="code" href="check__liboml2__omlvalue_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> + strlen (<a class="code" href="check__liboml2__omlvalue_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">while</span> (p != <a class="code" href="check__liboml2__omlvalue_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> &amp;&amp; isspace (*--p));</div>
<div class="line"></div>
<div class="line">  *++p = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae4c72bcf9c2be2551cf6d3a357443aeb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* find_charn </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find the first occurence of a character in a string up to a nul character or a given number of characters, whichever comes first,</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">str</td><td>a possibly nul-terminated string </td></tr>
    <tr><td class="paramname">c</td><td>the character to look for </td></tr>
    <tr><td class="paramname">len</td><td>the maximum length to search the string for </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a pointer to character c in str, or NULL </dd></dl>

<p>Definition at line <a class="el" href="oml__util_8c_source.html#l00089">89</a> of file <a class="el" href="oml__util_8c_source.html">oml_util.c</a>.</p>

<p>References <a class="el" href="oml__util_8c_source.html#l00048">find_matching</a>, and <a class="el" href="check__liboml2__omlvalue_8c_source.html#l00406">str</a>.</p>

<p>Referenced by <a class="el" href="schema_8c_source.html#l00191">schema_field_from_meta()</a>, and <a class="el" href="check__libshared__util_8c_source.html#l00057">START_TEST()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <a class="code" href="oml__util_8c.html#ac6dca18bed49e6af79497968c3fa3345">find_matching</a>(<a class="code" href="check__liboml2__omlvalue_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, (*<a class="code" href="check__liboml2__omlvalue_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> == c), len);</div>
<div class="line">  <span class="keywordflow">if</span> (len&lt;0 || !*<a class="code" href="check__liboml2__omlvalue_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> NULL;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="check__liboml2__omlvalue_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a250ca001350b172fd3fc8a5006c8af5b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* find_white </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find first whitespace in a string</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>string to search for whitespace in </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a pointer to the first whitespace character of the string, which might be the end of the string </dd></dl>
<dl class="section see"><dt>See Also</dt><dd>isspace(3) </dd></dl>

<p>Definition at line <a class="el" href="oml__util_8c_source.html#l00074">74</a> of file <a class="el" href="oml__util_8c_source.html">oml_util.c</a>.</p>

<p>References <a class="el" href="oml__util_8c_source.html#l00048">find_matching</a>.</p>

<p>Referenced by <a class="el" href="headers_8c_source.html#l00286">header_from_string()</a>, <a class="el" href="schema_8c_source.html#l00245">schema_from_meta()</a>, <a class="el" href="schema_8c_source.html#l00490">schema_from_sql()</a>, and <a class="el" href="check__libshared__util_8c_source.html#l00057">START_TEST()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span> l = -1;</div>
<div class="line">  <a class="code" href="oml__util_8c.html#ac6dca18bed49e6af79497968c3fa3345">find_matching</a>(p, (isspace (*p)), l);</div>
<div class="line">  <span class="keywordflow">return</span> p;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a301fddeafe0b5443ef133e7fc16af68f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="oml__util_8h.html#a457629626f00794579ce6e607b0827d7">OmlURIType</a> oml_uri_type </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>uri</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse the scheme of na URI and return its type as an +OmlURIType+ </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">uri</td><td>the URI to parse </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an +OmlURIType+ indicating the type of the URI </dd></dl>

<p>Definition at line <a class="el" href="oml__util_8c_source.html#l00202">202</a> of file <a class="el" href="oml__util_8c_source.html">oml_util.c</a>.</p>

<p>References <a class="el" href="oml__util_8h_source.html#l00041">OML_URI_FILE</a>, <a class="el" href="oml__util_8h_source.html#l00042">OML_URI_FILE_FLUSH</a>, <a class="el" href="oml__util_8h_source.html#l00043">OML_URI_TCP</a>, <a class="el" href="oml__util_8h_source.html#l00044">OML_URI_UDP</a>, and <a class="el" href="oml__util_8h_source.html#l00040">OML_URI_UNKNOWN</a>.</p>

<p>Referenced by <a class="el" href="init_8c_source.html#l00741">create_writer()</a>, <a class="el" href="oml__util_8c_source.html#l00231">parse_uri()</a>, and <a class="el" href="check__libshared__util_8c_source.html#l00028">START_TEST()</a>.</p>
<div class="fragment"><div class="line">                                         {</div>
<div class="line">  <span class="keywordtype">int</span> len = strlen(uri);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span>(len&gt;5 &amp;&amp; !strncmp(uri, <span class="stringliteral">&quot;flush&quot;</span>, 5))</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="oml__util_8h.html#a457629626f00794579ce6e607b0827d7acc2544b5a845cf76b4cebd89282dbd76">OML_URI_FILE_FLUSH</a>;</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(len&gt;4 &amp;&amp; !strncmp(uri, <span class="stringliteral">&quot;file&quot;</span>, 4))</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="oml__util_8h.html#a457629626f00794579ce6e607b0827d7a66afb33e9859087d2e73d8993a78ddd6">OML_URI_FILE</a>;</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(len&gt;3 &amp;&amp; !strncmp(uri, <span class="stringliteral">&quot;tcp&quot;</span>, 3))</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code" href="oml__util_8h.html#a457629626f00794579ce6e607b0827d7afdf8749ba5e2701344f8f6d1774611df">OML_URI_TCP</a>;</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(len&gt;3 &amp;&amp; !strncmp(uri, <span class="stringliteral">&quot;udp&quot;</span>, 3))</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code" href="oml__util_8h.html#a457629626f00794579ce6e607b0827d7ade604f43fe087de4abb3150e6283668e">OML_URI_UDP</a>;</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="oml__util_8h.html#a457629626f00794579ce6e607b0827d7aff2ab904ae5d0f7efd417a62867c391c">OML_URI_UNKNOWN</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab026ccb8032d813d97fe53004d39e12d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int parse_uri </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>protocol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse a collection URI of the form [proto:]path[:service].</p>
<p>path can be a hostname, an IPv4 address or an IPv6 address within brackets if proto is a network protocol. service is invalid if proto indicates a local file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uri</td><td>string containing the URI to parse </td></tr>
    <tr><td class="paramname">protocol</td><td>pointer to be updated to a string containing the selected protocol, to be <a class="el" href="omlc_8h.html#aa191af748bdc144fc077967bdacaaf70">oml_free()</a>'d by the caller </td></tr>
    <tr><td class="paramname">path</td><td>pointer to be updated to a string containing the node name or address, to be <a class="el" href="omlc_8h.html#aa191af748bdc144fc077967bdacaaf70">oml_free()</a>'d by the caller </td></tr>
    <tr><td class="paramname">service</td><td>pointer to be updated to a string containing the service name or port number, to be <a class="el" href="omlc_8h.html#aa191af748bdc144fc077967bdacaaf70">oml_free()</a>'d by the caller </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="mem_8h.html#adca1f9f48333b1fa9af21312a3f4534c">oml_strndup</a>, <a class="el" href="mem_8h.html#aa191af748bdc144fc077967bdacaaf70">oml_free</a>, <a class="el" href="oml__util_8h.html#a301fddeafe0b5443ef133e7fc16af68f">oml_uri_type</a> </dd></dl>

<p>Definition at line <a class="el" href="oml__util_8c_source.html#l00231">231</a> of file <a class="el" href="oml__util_8c_source.html">oml_util.c</a>.</p>

<p>References <a class="el" href="log_8c_source.html#l00297">logerror()</a>, <a class="el" href="log_8c_source.html#l00309">logwarn()</a>, <a class="el" href="mem_8c_source.html#l00240">oml_free()</a>, <a class="el" href="mem_8c_source.html#l00288">oml_strndup()</a>, <a class="el" href="oml__util_8h_source.html#l00048">oml_uri_is_file</a>, <a class="el" href="oml__util_8h_source.html#l00049">oml_uri_is_network</a>, <a class="el" href="oml__util_8c_source.html#l00202">oml_uri_type()</a>, <a class="el" href="oml__util_8h_source.html#l00040">OML_URI_UNKNOWN</a>, and <a class="el" href="oml__util_8c.html#a01e625c53b427676cbf23166d697cbc2">trydup</a>.</p>

<p>Referenced by <a class="el" href="init_8c_source.html#l00741">create_writer()</a>, and <a class="el" href="check__libshared__util_8c_source.html#l00131">START_TEST()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> MAX_PARTS = 3;</div>
<div class="line">  <span class="keywordtype">char</span> *parts[3] = { NULL, NULL, NULL }, *tmp, *orig;</div>
<div class="line">  <span class="keywordtype">size_t</span> lengths[3] = { 0, 0, 0 };</div>
<div class="line">  <span class="keywordtype">int</span> is_valid = 1;</div>
<div class="line">  <span class="keywordtype">int</span> i;</div>
<div class="line">  <a class="code" href="oml__util_8h.html#a457629626f00794579ce6e607b0827d7">OmlURIType</a> uri_type;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (uri) {</div>
<div class="line">    uri_type = <a class="code" href="oml__util_8c.html#a301fddeafe0b5443ef133e7fc16af68f">oml_uri_type</a>(uri);</div>
<div class="line"></div>
<div class="line">    orig = parts[2] = <a class="code" href="mem_8c.html#adca1f9f48333b1fa9af21312a3f4534c">oml_strndup</a> (uri, strlen (uri));</div>
<div class="line">    parts[0] = strsep(&amp;parts[2], <span class="stringliteral">&quot;[&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (parts[2]) {</div>
<div class="line">      i = 0;</div>
<div class="line">      <span class="keywordflow">if</span> (*parts[i] != <span class="charliteral">&#39;\0&#39;</span>) {</div>
<div class="line">        <span class="comment">/* there was something before the brackets, clean it some more */</span></div>
<div class="line">        tmp = parts[i];</div>
<div class="line">        parts[i] = strsep(&amp;tmp, <span class="stringliteral">&quot;:&quot;</span>);</div>
<div class="line">        lengths[i] = parts[i] ? strlen (parts[i]) : 0;</div>
<div class="line">        i++;</div>
<div class="line">      } </div>
<div class="line"></div>
<div class="line">      parts[i] = strsep(&amp;parts[2], <span class="stringliteral">&quot;]&quot;</span>);</div>
<div class="line">      lengths[i] = parts[i] ? strlen (parts[i]) : 0;</div>
<div class="line">      i++;</div>
<div class="line"></div>
<div class="line">      parts[i] = parts[2];</div>
<div class="line">      tmp = strsep(&amp;parts[i], <span class="stringliteral">&quot;:&quot;</span>);</div>
<div class="line">      lengths[i] = parts[i] ? strlen (parts[i]) : 0;</div>
<div class="line"></div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="comment">/* restart the parsing */</span></div>
<div class="line">      parts[2] = parts[0];</div>
<div class="line"></div>
<div class="line">      i = 0;</div>
<div class="line"></div>
<div class="line">      parts[i] = strsep(&amp;parts[2], <span class="stringliteral">&quot;:&quot;</span>);</div>
<div class="line">      lengths[i] = parts[i] ? strlen (parts[i]) : 0;</div>
<div class="line">      i++;</div>
<div class="line"></div>
<div class="line">      parts[i] = strsep(&amp;parts[2], <span class="stringliteral">&quot;:&quot;</span>);</div>
<div class="line">      lengths[i] = parts[i] ? strlen (parts[i]) : 0;</div>
<div class="line">      i++;</div>
<div class="line"></div>
<div class="line">      lengths[i] = parts[i] ? strlen (parts[i]) : 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* make sure unused items are clearly so */</span></div>
<div class="line">    <span class="keywordflow">for</span>(++i; i&lt;MAX_PARTS; i++) {</div>
<div class="line">      parts[i] = NULL;</div>
<div class="line">      lengths[i] = 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define trydup(i) (parts[(i)] &amp;&amp; lengths[(i)]&gt;0 ? oml_strndup (parts[(i)], lengths[(i)]) : NULL)</span></div>
<div class="line"><span class="preprocessor"></span>    *protocol = *path = *port = NULL;</div>
<div class="line">    <span class="keywordflow">if</span> (lengths[0] &gt; 0 &amp;&amp; lengths[1] &gt; 0) {</div>
<div class="line">      <span class="comment">/* Case 1:  &quot;abc:xyz&quot; or &quot;abc:xyz:123&quot; -- if abc is a transport, use it; otherwise, it&#39;s a hostname/path */</span></div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="oml__util_8h.html#ae2401d16a62e3b39a9a225fd4b0d5a25">oml_uri_is_network</a>(uri_type)) {</div>
<div class="line">        *protocol = <a class="code" href="oml__util_8c.html#a01e625c53b427676cbf23166d697cbc2">trydup</a> (0);</div>
<div class="line">        *path = <a class="code" href="oml__util_8c.html#a01e625c53b427676cbf23166d697cbc2">trydup</a> (1);</div>
<div class="line">        *port = <a class="code" href="oml__util_8c.html#a01e625c53b427676cbf23166d697cbc2">trydup</a> (2);</div>
<div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="oml__util_8h.html#a1fd898bbff0329c28ba4c6825610e6a1">oml_uri_is_file</a>(uri_type)) {</div>
<div class="line">        *protocol = <a class="code" href="oml__util_8c.html#a01e625c53b427676cbf23166d697cbc2">trydup</a> (0);</div>
<div class="line">        *path = <a class="code" href="oml__util_8c.html#a01e625c53b427676cbf23166d697cbc2">trydup</a> (1);</div>
<div class="line">        *port = NULL;</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        *protocol = NULL;</div>
<div class="line">        *path = <a class="code" href="oml__util_8c.html#a01e625c53b427676cbf23166d697cbc2">trydup</a> (0);</div>
<div class="line">        *port = <a class="code" href="oml__util_8c.html#a01e625c53b427676cbf23166d697cbc2">trydup</a> (1);</div>
<div class="line">      }</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lengths[0] &gt; 0 &amp;&amp; lengths[2] &gt; 0) {</div>
<div class="line">      <span class="comment">/* Case 2:  &quot;abc::123&quot; -- not valid, as we can&#39;t infer a hostname/path */</span></div>
<div class="line">      <a class="code" href="log_8c.html#ac65b3f90d3228474368b2b48a488cd44">logwarn</a> (<span class="stringliteral">&quot;Server URI &#39;%s&#39; is invalid as it does not contain a hostname/path\n&quot;</span>, uri);</div>
<div class="line">      is_valid = 0;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lengths[0] &gt; 0) {</div>
<div class="line">      *protocol = NULL;</div>
<div class="line">      *path = <a class="code" href="oml__util_8c.html#a01e625c53b427676cbf23166d697cbc2">trydup</a> (0);</div>
<div class="line">      *port = NULL;</div>
<div class="line"></div>
<div class="line">      <span class="comment">/* Look for potential user errors and issue a warning but proceed as normal */</span></div>
<div class="line">      <span class="keywordflow">if</span> (uri_type != <a class="code" href="oml__util_8h.html#a457629626f00794579ce6e607b0827d7aff2ab904ae5d0f7efd417a62867c391c">OML_URI_UNKNOWN</a>) {</div>
<div class="line">        <a class="code" href="log_8c.html#ac65b3f90d3228474368b2b48a488cd44">logwarn</a> (<span class="stringliteral">&quot;Server URI with unknown scheme, assuming &#39;tcp:%s&#39;\n&quot;</span>,</div>
<div class="line">                 *path);</div>
<div class="line">      }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <a class="code" href="log_8c.html#a0548af6117bef6d5c78d45a36ab7013b">logerror</a> (<span class="stringliteral">&quot;Server URI &#39;%s&#39; seems to be empty\n&quot;</span>, uri);</div>
<div class="line">      is_valid = 0;</div>
<div class="line">    }</div>
<div class="line"><span class="preprocessor">#undef trydup</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    <a class="code" href="omlc_8h.html#aa191af748bdc144fc077967bdacaaf70">oml_free</a> (orig);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (is_valid)</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a00488a8fd0b3440c9d2e1bc421438cd5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int resolve_service </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>service</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>defport</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Resolve a string containing a service or port into an integer port.</p>
<p>Setting default to an impossible value (say, -1) is sufficient to catch resolving errors;</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">port</td><td>string containing the textual service name or port </td></tr>
    <tr><td class="paramname">defport</td><td>default port value to return if resolving fails </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the port number as a host-order integer, or the default value if something failed </dd></dl>
<dl class="section see"><dt>See Also</dt><dd>getservbyname(3) </dd></dl>

<p>Definition at line <a class="el" href="oml__util_8c_source.html#l00177">177</a> of file <a class="el" href="oml__util_8c_source.html">oml_util.c</a>.</p>

<p>References <a class="el" href="log_8c_source.html#l00309">logwarn()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keyword">struct </span>servent *sse;</div>
<div class="line">  <span class="keywordtype">char</span> *endptr;</div>
<div class="line">  <span class="keywordtype">int</span> portnum = defport, tmpport;</div>
<div class="line"></div>
<div class="line">  sse = getservbyname(service, NULL);</div>
<div class="line">  <span class="keywordflow">if</span> (sse) {</div>
<div class="line">    portnum = ntohs(sse-&gt;s_port);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    tmpport = strtol(service, &amp;endptr, 10);</div>
<div class="line">    <span class="keywordflow">if</span> (endptr &gt; service)</div>
<div class="line">      portnum = tmpport;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      <a class="code" href="log_8c.html#ac65b3f90d3228474368b2b48a488cd44">logwarn</a>(<span class="stringliteral">&quot;Could not resolve service &#39;%s&#39;, defaulting to %d\n&quot;</span>, service, portnum);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> portnum;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a447ac0e4e6e7e4bbab27d86affb06250"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* skip_white </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Skip whitespaces in a string</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>string to skip whitespace out of </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a pointer to the first non-white character of the string, which might be the end of the string </dd></dl>
<dl class="section see"><dt>See Also</dt><dd>isspace(3) </dd></dl>

<p>Definition at line <a class="el" href="oml__util_8c_source.html#l00061">61</a> of file <a class="el" href="oml__util_8c_source.html">oml_util.c</a>.</p>

<p>References <a class="el" href="oml__util_8c_source.html#l00048">find_matching</a>.</p>

<p>Referenced by <a class="el" href="headers_8c_source.html#l00286">header_from_string()</a>, <a class="el" href="testclient_8c_source.html#l00378">read_mp()</a>, <a class="el" href="testclient_8c_source.html#l00258">read_mp_def()</a>, <a class="el" href="schema_8c_source.html#l00245">schema_from_meta()</a>, <a class="el" href="schema_8c_source.html#l00490">schema_from_sql()</a>, and <a class="el" href="check__libshared__util_8c_source.html#l00057">START_TEST()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span> l = -1;</div>
<div class="line">  <a class="code" href="oml__util_8c.html#ac6dca18bed49e6af79497968c3fa3345">find_matching</a>(p, !(isspace (*p)), l);</div>
<div class="line">  <span class="keywordflow">return</span> p;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aacb2dc8b1ec079eb501d1a69d320a5fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* to_octets </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Dump the contents of a buffer as a string of hex characters</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>array of data to dump </td></tr>
    <tr><td class="paramname">len</td><td>length of buf </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a character string which needs to be <a class="el" href="omlc_8h.html#aa191af748bdc144fc077967bdacaaf70">oml_free()</a>'d</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="mem_8h.html#a8616cb714d6589098267bba8fc7b48c2">oml_malloc</a>, <a class="el" href="mem_8h.html#aa191af748bdc144fc077967bdacaaf70">oml_free</a> </dd></dl>

<p>Definition at line <a class="el" href="oml__util_8c_source.html#l00106">106</a> of file <a class="el" href="oml__util_8c_source.html">oml_util.c</a>.</p>

<p>References <a class="el" href="mem_8c_source.html#l00157">oml_malloc()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> octet_width = 2;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> columns = 16;</div>
<div class="line">  len = (len&gt;0xff)?0xff:len; <span class="comment">/* Limit the output to something manageable */</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> rows = len / columns + 2; <span class="comment">/* Integer division plus first line */</span></div>
<div class="line">  <span class="comment">/* Each row has 7 non-data characters (numbers and spaces), one more space, and columns*ASCII characters, plus a &#39;\n&#39; */</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> rowlength = (octet_width * columns + 7 + 1 + columns + 1);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> outlength = rows * rowlength + 1;</div>
<div class="line">  <span class="keywordtype">char</span> *out = <a class="code" href="omlc_8h.html#a8616cb714d6589098267bba8fc7b48c2">oml_malloc</a> (outlength);</div>
<div class="line">  <span class="keywordtype">char</span> strrep[columns + 1];</div>
<div class="line">  <span class="keywordtype">int</span> n = 0, i, col, rw=0;</div>
<div class="line"></div>
<div class="line">  strrep[columns] = 0;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span>(out) {</div>
<div class="line">    <span class="comment">/* Don&#39;t forget nil-terminator in snprintf&#39;s size */</span></div>
<div class="line">    n += snprintf(out, outlength - n, <span class="stringliteral">&quot;   0 1 2 3  4 5 6 7   8 9 a b  c d e f  0123456789abcdef\n%2x &quot;</span>, rw++);</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; len; i++) {</div>
<div class="line">      col = i % columns;</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line">        <span class="keywordflow">while</span>(0); <span class="comment">/* Do nothing */</span></div>
<div class="line"></div>
<div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (col == 0) {</div>
<div class="line">        n += snprintf(&amp;out[n], outlength - n,  <span class="stringliteral">&quot; %s\n%2x &quot;</span>, strrep, rw++);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Add some spacing for readability */</span></div>
<div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == (col % 8)) {</div>
<div class="line">        n += snprintf(&amp;out[n], outlength - n, <span class="stringliteral">&quot;  &quot;</span>);</div>
<div class="line"></div>
<div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == (col % 4)) {</div>
<div class="line">        n += snprintf(&amp;out[n], outlength - n, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">      n += snprintf(&amp;out[n], outlength - n, <span class="stringliteral">&quot;%02x&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)buf[i]);</div>
<div class="line">      <span class="keywordflow">if</span> (isprint(buf[i])) {</div>
<div class="line">        strrep[col] = buf[i];</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        strrep[col] = <span class="charliteral">&#39;.&#39;</span>;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>(col != 0) {</div>
<div class="line">      <span class="keywordflow">while</span>(++col&lt;columns) {</div>
<div class="line">        <span class="comment">/* Add padding to align ASCII output */</span></div>
<div class="line">        <span class="keywordflow">if</span> (0 == (col % 8)) {</div>
<div class="line">          n += snprintf(&amp;out[n], outlength - n, <span class="stringliteral">&quot;    &quot;</span>);</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == (col % 4)) {</div>
<div class="line">          n += snprintf(&amp;out[n], outlength - n, <span class="stringliteral">&quot;   &quot;</span>);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">          n += snprintf(&amp;out[n], outlength - n, <span class="stringliteral">&quot;  &quot;</span>);</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      strrep[col] = 0;</div>
<div class="line">      n += snprintf(&amp;out[n], outlength - n, <span class="stringliteral">&quot; %s&quot;</span>, strrep);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  out[outlength - 1] = 0;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> out;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_0ce1951afc5b1d55c9adea1f4ae57fb4.html">shared</a></li><li class="navelem"><a class="el" href="oml__util_8c.html">oml_util.c</a></li>
    <li class="footer">Generated on Thu Jun 25 2015 15:31:55 for oml2 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
