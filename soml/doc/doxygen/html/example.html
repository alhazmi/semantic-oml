<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>oml2: Example sine generator reporting over OML</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="oml_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">oml2
   &#160;<span id="projectnumber">2.12.0pre.79-58cf-dirty</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('example.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Example sine generator reporting over OML </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This simple example demonstrates both a simple OML-instrumented application, as well as the code-generating capabilities of <a href="http://oml.mytestbed.net/doc/oml/2.12/oml2-scaffold.1.html">oml2-scaffold(1)</a>. See <a href="http://oml.mytestbed.net/projects/oml/wiki/OML2_scaffold_Tutorial">oml-scaffold-tute</a> for more details.</p>
<p>Most of the code has been generated with the following few steps. </p>
<pre class="fragment">$ oml2-scaffold --app generator # Create template description file
Created 'generator.rb'
$ vim generator.rb
[edit measurement points and options]
^]:wq
$ oml2-scaffold --main generator.rb # Create template C code
Created 'generator.c' and 'version.h'
$ vim generator.c
[add missing includes and sine-generation logic]
^]:wq
$ oml2-scaffold --make generator.rb # Create template Makefile
$ vim Makefile
[add -lm to LIBS, necessary for sin(3)]
^]:wq
</pre><p>The binary can be built with a simple call to <code>make</code>. In the process, <a href="http://oml.mytestbed.net/doc/oml/2.12/oml2-scaffold.1.html">oml2-scaffold(1)</a> will be used twice more, as called by the default Makefile template:</p>
<ul>
<li><code>generator_oml.h</code>, based on the <code>defMeasurement</code>s in the description file, which contains the declaration of the measurement points, as well as helper functions to register them to OML and inject samples;</li>
<li><code>generator_popt.h</code>, base on the <code>defPropertys</code> in the description file, which contain the basic option-parsing logics for the declared properties (not the <code>--oml-*</code> ones, which are directly handled by the OML client library, though options can be given in any order on the command line).</li>
</ul>
<p>Using diff(1) on the distributed files, as compared to those generated by the sequence of commands above, can further show how much of the code can be generated automatically, so the developer can concentrate on the logic of the application, rather than the samples management and reporting tasks.</p>
<p>The <code>config_*.xml</code> files are examples, usable with the generator, of how OML Measurement Streams can be directed to one or more collection point, and filterred or further processed along the way.</p>
<p>To build this example without installing the OML components system wide, run make CC="$PWD/../../libtool compile gcc" CCLD="$PWD/../../libtool link &amp;ndash;tag=CC gcc" \ SCAFFOLD="ruby $PWD/../../ruby/oml2-scaffold" \ CFLAGS="-I$PWD/../../lib/client -I$PWD/../../lib/ocomm" \ LDFLAGS="-L$PWD/../../lib/client/.libs -L$PWD/../../lib/ocomm/.libs"</p>
<p>The generator can then be run with, e.g., LD_LIBRARY_PATH=$PWD/../../lib/client/.libs:$PWD/../../lib/ocomm/.libs \ ./generator -n 10 -i .5 &ndash;oml-id generator &ndash;oml-domain test </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Jun 25 2015 15:31:56 for oml2 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
