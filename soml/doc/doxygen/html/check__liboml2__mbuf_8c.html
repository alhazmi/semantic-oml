<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>oml2: check_liboml2_mbuf.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="oml_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">oml2
   &#160;<span id="projectnumber">2.12.0pre.79-58cf-dirty</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('check__liboml2__mbuf_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">check_liboml2_mbuf.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;stdint.h&gt;</code><br/>
<code>#include &lt;check.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="mbuf_8h_source.html">mbuf.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="check__util_8h_source.html">check_util.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for check_liboml2_mbuf.c:</div>
<div class="dyncontent">
<div class="center"><img src="check__liboml2__mbuf_8c__incl.png" border="0" usemap="#check__liboml2__mbuf_8c" alt=""/></div>
<map name="check__liboml2__mbuf_8c" id="check__liboml2__mbuf_8c">
<area shape="rect" id="node13" href="mbuf_8h.html" title="mbuf.h" alt="" coords="141,315,203,344"/><area shape="rect" id="node19" href="check__util_8h.html" title="check_util.h" alt="" coords="321,83,412,112"/><area shape="rect" id="node21" href="omlc_8h.html" title="Public API of the OML client library." alt="" coords="397,315,491,344"/><area shape="rect" id="node35" href="oml__filter_8h.html" title="Abstract interface for filters." alt="" coords="308,160,425,189"/><area shape="rect" id="node32" href="o__log_8h.html" title="ocomm/o_log.h" alt="" coords="395,392,504,421"/><area shape="rect" id="node38" href="oml__writer_8h.html" title="Abstract interface for writers." alt="" coords="277,237,403,267"/></map>
</div>
</div>
<p><a href="check__liboml2__mbuf_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a369266c24eacffb87046522897a570d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#a369266c24eacffb87046522897a570d5">_GNU_SOURCE</a>&#160;&#160;&#160;/* For NAN */</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4c615bb0ce8505323851fc046667a3a6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#a4c615bb0ce8505323851fc046667a3a6">START_TEST</a> (test_mbuf_create)</td></tr>
<tr class="memitem:aea435bfcd5b3eecf0dca7c8a4639c699"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#aea435bfcd5b3eecf0dca7c8a4639c699">START_TEST</a> (test_mbuf_buffer)</td></tr>
<tr class="memitem:adcf92af0a5be06d1128fa75cfadc56ef"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#adcf92af0a5be06d1128fa75cfadc56ef">START_TEST</a> (test_mbuf_length)</td></tr>
<tr class="memitem:acea514d9707487f640999f43d5877cd7"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#acea514d9707487f640999f43d5877cd7">START_TEST</a> (test_mbuf_resize)</td></tr>
<tr class="memitem:ae611c7ebb022ed30f965536f56c24170"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#ae611c7ebb022ed30f965536f56c24170">START_TEST</a> (test_mbuf_resize_contents)</td></tr>
<tr class="memitem:a4d2124eb8c40a4627e02871e69f8dfeb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#a4d2124eb8c40a4627e02871e69f8dfeb">START_TEST</a> (test_mbuf_write)</td></tr>
<tr class="memitem:aee1055a2450492772e9346289db56bc6"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#aee1055a2450492772e9346289db56bc6">START_TEST</a> (test_mbuf_write_null)</td></tr>
<tr class="memitem:a95ec311d2b141449a423967b802ba366"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#a95ec311d2b141449a423967b802ba366">START_TEST</a> (test_mbuf_read)</td></tr>
<tr class="memitem:a2246e2a733225ac887ce55884880bb86"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#a2246e2a733225ac887ce55884880bb86">START_TEST</a> (test_mbuf_read_null)</td></tr>
<tr class="memitem:adb29e1b0c784515dfd8ad581f2557f11"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#adb29e1b0c784515dfd8ad581f2557f11">START_TEST</a> (test_mbuf_begin_read)</td></tr>
<tr class="memitem:aa42287550541771e7d19d25d31144be5"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#aa42287550541771e7d19d25d31144be5">START_TEST</a> (test_mbuf_begin_write)</td></tr>
<tr class="memitem:a982eefabdfdeecebc78bdf11756fb7f8"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#a982eefabdfdeecebc78bdf11756fb7f8">START_TEST</a> (test_mbuf_reset_read)</td></tr>
<tr class="memitem:a7d8820b186515ca764f6ccd72888d961"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#a7d8820b186515ca764f6ccd72888d961">START_TEST</a> (test_mbuf_reset_write)</td></tr>
<tr class="memitem:a68b737cc90efc28afce4b1bd4a1eac1c"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#a68b737cc90efc28afce4b1bd4a1eac1c">START_TEST</a> (test_mbuf_consume_message)</td></tr>
<tr class="memitem:a8ec137a031203d00e7324bc459cefbd4"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#a8ec137a031203d00e7324bc459cefbd4">START_TEST</a> (test_mbuf_repack)</td></tr>
<tr class="memitem:a01b59fc8dc2865868266200334676330"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#a01b59fc8dc2865868266200334676330">START_TEST</a> (test_mbuf_repack_message)</td></tr>
<tr class="memitem:a37a54fa11257aba81734ad4f0646c261"><td class="memItemLeft" align="right" valign="top">END_TEST Suite *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__liboml2__mbuf_8c.html#a37a54fa11257aba81734ad4f0646c261">mbuf_suite</a> (void)</td></tr>
</table>
<h2>Macro Definition Documentation</h2>
<a class="anchor" id="a369266c24eacffb87046522897a570d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _GNU_SOURCE&#160;&#160;&#160;/* For NAN */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00024">24</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="a37a54fa11257aba81734ad4f0646c261"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST Suite* mbuf_suite </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00620">620</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

<p>Referenced by <a class="el" href="check__liboml2_8c_source.html#l00017">main()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  Suite* s = suite_create (<span class="stringliteral">&quot;Mbuf&quot;</span>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Mbuf test cases */</span></div>
<div class="line">  TCase* tc_mbuf = tcase_create (<span class="stringliteral">&quot;Mbuf&quot;</span>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Add tests to &quot;Mbuf&quot; */</span></div>
<div class="line">  tcase_add_test (tc_mbuf, test_mbuf_create);</div>
<div class="line">  tcase_add_test (tc_mbuf, test_mbuf_buffer);</div>
<div class="line">  tcase_add_test (tc_mbuf, test_mbuf_length);</div>
<div class="line">  tcase_add_test (tc_mbuf, test_mbuf_resize);</div>
<div class="line">  tcase_add_test (tc_mbuf, test_mbuf_resize_contents);</div>
<div class="line">  tcase_add_test (tc_mbuf, test_mbuf_write);</div>
<div class="line">  tcase_add_test (tc_mbuf, test_mbuf_write_null);</div>
<div class="line">  tcase_add_test (tc_mbuf, test_mbuf_read);</div>
<div class="line">  tcase_add_test (tc_mbuf, test_mbuf_read_null);</div>
<div class="line">  tcase_add_test (tc_mbuf, test_mbuf_begin_read);</div>
<div class="line">  tcase_add_test (tc_mbuf, test_mbuf_begin_write);</div>
<div class="line">  tcase_add_test (tc_mbuf, test_mbuf_reset_read);</div>
<div class="line">  tcase_add_test (tc_mbuf, test_mbuf_reset_write);</div>
<div class="line">  tcase_add_test (tc_mbuf, test_mbuf_consume_message);</div>
<div class="line">  tcase_add_test (tc_mbuf, test_mbuf_repack);</div>
<div class="line">  tcase_add_test (tc_mbuf, test_mbuf_repack_message);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  suite_add_tcase (s, tc_mbuf);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> s;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4c615bb0ce8505323851fc046667a3a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_mbuf_create&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00034">34</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="mbuf_8h_source.html#l00041">MBuffer::fill</a>, <a class="el" href="mbuf_8h_source.html#l00035">MBuffer::length</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8h_source.html#l00039">MBuffer::rd_remaining</a>, <a class="el" href="mbuf_8h_source.html#l00044">MBuffer::rdptr</a>, <a class="el" href="mbuf_8h_source.html#l00037">MBuffer::wr_remaining</a>, and <a class="el" href="mbuf_8h_source.html#l00046">MBuffer::wrptr</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">void</span>* buf = malloc (4096);</div>
<div class="line">  <span class="keywordflow">if</span> (buf == NULL)</div>
<div class="line">    fail (<span class="stringliteral">&quot;malloc(3) failed, so mbuf_create() might fail too\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">  free (buf);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line"></div>
<div class="line">  fail_if (mbuf == NULL);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#ac8b0500b1655048c350b8e3a45c8e123">fill</a> != 0);</div>
<div class="line">  fail_unless (mbuf-&gt;<a class="code" href="structMBuffer.html#aa513d3a69c07fdfab78133f5fe220e69">length</a> &gt; 0);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4c6858d7501c31c61820fca0a9b542e0">wr_remaining</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#aa513d3a69c07fdfab78133f5fe220e69">length</a>);</div>
<div class="line">  fail_if ((<span class="keywordtype">int</span>)mbuf-&gt;<a class="code" href="structMBuffer.html#a66620d08cfc91ca5f54b60f5b84a4be4">rd_remaining</a> != (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> - mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a>));</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; mbuf-&gt;<a class="code" href="structMBuffer.html#aa513d3a69c07fdfab78133f5fe220e69">length</a>; i++)</div>
<div class="line">    fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>[i] != 0);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aea435bfcd5b3eecf0dca7c8a4639c699"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_mbuf_buffer&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00058">58</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="mbuf_8c_source.html#l00109">mbuf_buffer()</a>, and <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  fail_if (<a class="code" href="mbuf_8c.html#a9aeb314b9a5fd87a790a75bda56d47e4">mbuf_buffer</a> (mbuf) != mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adcf92af0a5be06d1128fa75cfadc56ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_mbuf_length&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00065">65</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00035">MBuffer::length</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, and <a class="el" href="mbuf_8c_source.html#l00120">mbuf_length()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  fail_if (<a class="code" href="mbuf_8c.html#ad77cb9e3d579e54318162f30c847b8f4">mbuf_length</a> (mbuf) != mbuf-&gt;<a class="code" href="structMBuffer.html#aa513d3a69c07fdfab78133f5fe220e69">length</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acea514d9707487f640999f43d5877cd7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_mbuf_resize&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00072">72</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00120">mbuf_length()</a>, and <a class="el" href="mbuf_8c_source.html#l00303">mbuf_resize()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> result = 0;</div>
<div class="line">  <span class="keywordtype">size_t</span> length_1 = <a class="code" href="mbuf_8c.html#ad77cb9e3d579e54318162f30c847b8f4">mbuf_length</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#a2ee5265b405f90d567f5291c636ed185">mbuf_resize</a> (mbuf, length_1 / 2);</div>
<div class="line"></div>
<div class="line">  fail_if (result == -1);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line">  fail_if (<a class="code" href="mbuf_8c.html#ad77cb9e3d579e54318162f30c847b8f4">mbuf_length</a> (mbuf) != length_1); <span class="comment">// Don&#39;t resize if new length is less</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">size_t</span> length_2 = length_1 + 1;</div>
<div class="line"></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#a2ee5265b405f90d567f5291c636ed185">mbuf_resize</a> (mbuf, length_2);</div>
<div class="line"></div>
<div class="line">  fail_if (result == -1);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line">  fail_if (<a class="code" href="mbuf_8c.html#ad77cb9e3d579e54318162f30c847b8f4">mbuf_length</a> (mbuf) != length_2);</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">size_t</span> length_3 = 2 * length_1;</div>
<div class="line"></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#a2ee5265b405f90d567f5291c636ed185">mbuf_resize</a> (mbuf, length_3);</div>
<div class="line"></div>
<div class="line">  fail_if (result == -1);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line">  fail_if (<a class="code" href="mbuf_8c.html#ad77cb9e3d579e54318162f30c847b8f4">mbuf_length</a> (mbuf) != length_3);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae611c7ebb022ed30f965536f56c24170"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_mbuf_resize_contents&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00102">102</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00120">mbuf_length()</a>, and <a class="el" href="mbuf_8c_source.html#l00303">mbuf_resize()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  <span class="keywordtype">int</span> result = 0;</div>
<div class="line">  uint8_t s[8192];</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">size_t</span> length_1 = <a class="code" href="mbuf_8c.html#ad77cb9e3d579e54318162f30c847b8f4">mbuf_length</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  memset (s, 0, <span class="keyword">sizeof</span> (s));</div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; length_1; i++)</div>
<div class="line">    {</div>
<div class="line">      s[i] = <span class="charliteral">&#39;A&#39;</span> + (i % 16);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">  memcpy (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>, s, length_1);</div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#a2ee5265b405f90d567f5291c636ed185">mbuf_resize</a> (mbuf, length_1 / 2);</div>
<div class="line">  fail_unless(result == 0, <span class="stringliteral">&quot;Error when testing mbuf_resize&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4d2124eb8c40a4627e02871e69f8dfeb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_mbuf_write&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00154">154</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="mbuf_8h_source.html#l00041">MBuffer::fill</a>, <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00120">mbuf_length()</a>, <a class="el" href="mbuf_8c_source.html#l00381">mbuf_write()</a>, <a class="el" href="mbuf_8h_source.html#l00039">MBuffer::rd_remaining</a>, <a class="el" href="mbuf_8h_source.html#l00044">MBuffer::rdptr</a>, <a class="el" href="mbuf_8h_source.html#l00037">MBuffer::wr_remaining</a>, and <a class="el" href="mbuf_8h_source.html#l00046">MBuffer::wrptr</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> s[8192];</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> result = 0;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  <span class="keywordtype">size_t</span> n = 0;</div>
<div class="line">  <span class="keywordtype">size_t</span> length = <a class="code" href="mbuf_8c.html#ad77cb9e3d579e54318162f30c847b8f4">mbuf_length</a> (mbuf);</div>
<div class="line">  <span class="keywordtype">size_t</span> len = strlen ((<span class="keywordtype">char</span>*)test_strings[0]);</div>
<div class="line">  memset (s, 0, <span class="keyword">sizeof</span> (s));</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">while</span> (n + len &lt; length &amp;&amp; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (test_strings))</div>
<div class="line">    {</div>
<div class="line">      strcat (s, test_strings[i]);</div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#acb5cd36b259b0df7a3173259835dbba0">mbuf_write</a> (mbuf, (uint8_t*)test_strings[i], len);</div>
<div class="line">      n += len;</div>
<div class="line"></div>
<div class="line">      fail_if (result == -1);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#ac8b0500b1655048c350b8e3a45c8e123">fill</a> != n);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> - mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> != (<span class="keywordtype">int</span>)n);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4c6858d7501c31c61820fca0a9b542e0">wr_remaining</a> != length - n);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a66620d08cfc91ca5f54b60f5b84a4be4">rd_remaining</a> != n);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> &lt; mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a>);</div>
<div class="line">      fail_if (strncmp ((<span class="keywordtype">char</span>*)mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>, s, n) != 0,</div>
<div class="line">               <span class="stringliteral">&quot;Expected:\n%s\nActual:\n%s\n&quot;</span>, s, mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line"></div>
<div class="line">      i++;</div>
<div class="line">      <span class="keywordflow">if</span> (i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (test_strings))</div>
<div class="line">        len = strlen (test_strings[i]);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Now do it again and try to overrun the buffer */</span></div>
<div class="line">  i = 0;</div>
<div class="line">  <span class="keywordtype">int</span> done = 0;</div>
<div class="line">  len = strlen (test_strings[i]);</div>
<div class="line">  <span class="keywordflow">while</span> (i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (test_strings) &amp;&amp; !done)</div>
<div class="line">    {</div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#acb5cd36b259b0df7a3173259835dbba0">mbuf_write</a> (mbuf, (uint8_t*)test_strings[i], len);</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span> (result != -1)</div>
<div class="line">        {</div>
<div class="line">          strcat (s, test_strings[i]);</div>
<div class="line">          n += len;</div>
<div class="line"></div>
<div class="line">          i++;</div>
<div class="line">          <span class="keywordflow">if</span> (i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (test_strings))</div>
<div class="line">            len = strlen (test_strings[i]);</div>
<div class="line">        }</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">          done = 1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">  <span class="comment">// FIXME:  semantics changed:  mbuf_write() now resizes buffer as needed.</span></div>
<div class="line">  <span class="comment">//  fail_unless (done == 1); // Fail if we didn&#39;t overflow the buf</span></div>
<div class="line"></div>
<div class="line">  fail_unless (strncmp ((<span class="keywordtype">char</span>*)mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>, s, n) == 0,</div>
<div class="line">               <span class="stringliteral">&quot;Expected:\n%s\nActual:\n%s\n&quot;</span>, s, mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Check that we didn&#39;t write any bytes the last mbuf_write()</span></div>
<div class="line">  <span class="comment">//  for (i = n; i &lt; length; i++)</span></div>
<div class="line">  <span class="comment">//    fail_unless (mbuf-&gt;base[i] == 0);</span></div>
<div class="line"></div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#ac8b0500b1655048c350b8e3a45c8e123">fill</a> != n);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> - mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> != (<span class="keywordtype">int</span>)n);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line">  <span class="comment">//fail_if (mbuf-&gt;wr_remaining != length - n);</span></div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a66620d08cfc91ca5f54b60f5b84a4be4">rd_remaining</a> != n);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> &lt; mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aee1055a2450492772e9346289db56bc6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_mbuf_write_null&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00228">228</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="mbuf_8h_source.html#l00041">MBuffer::fill</a>, <a class="el" href="mbuf_8h_source.html#l00035">MBuffer::length</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00381">mbuf_write()</a>, <a class="el" href="mbuf_8h_source.html#l00037">MBuffer::wr_remaining</a>, and <a class="el" href="mbuf_8h_source.html#l00046">MBuffer::wrptr</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> s[] = <span class="stringliteral">&quot;abc&quot;</span>;</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> result = 0;</div>
<div class="line">  memset (s, 0, <span class="keyword">sizeof</span> (s));</div>
<div class="line"></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#acb5cd36b259b0df7a3173259835dbba0">mbuf_write</a> (NULL, (uint8_t*)s, 1);</div>
<div class="line">  fail_if (result != -1);</div>
<div class="line"></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#acb5cd36b259b0df7a3173259835dbba0">mbuf_write</a> (mbuf, NULL, 1);</div>
<div class="line">  fail_if (result != -1);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#ac8b0500b1655048c350b8e3a45c8e123">fill</a> != 0);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4c6858d7501c31c61820fca0a9b542e0">wr_remaining</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#aa513d3a69c07fdfab78133f5fe220e69">length</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a95ec311d2b141449a423967b802ba366"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_mbuf_read&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00246">246</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="mbuf_8h_source.html#l00041">MBuffer::fill</a>, <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="mbuf_8h_source.html#l00035">MBuffer::length</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00120">mbuf_length()</a>, <a class="el" href="mbuf_8c_source.html#l00466">mbuf_read()</a>, <a class="el" href="mbuf_8c_source.html#l00381">mbuf_write()</a>, <a class="el" href="mbuf_8h_source.html#l00048">MBuffer::msgptr</a>, <a class="el" href="mbuf_8h_source.html#l00039">MBuffer::rd_remaining</a>, <a class="el" href="mbuf_8h_source.html#l00044">MBuffer::rdptr</a>, <a class="el" href="mbuf_8h_source.html#l00037">MBuffer::wr_remaining</a>, and <a class="el" href="mbuf_8h_source.html#l00046">MBuffer::wrptr</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> s[8192];</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> result = 0;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  <span class="keywordtype">size_t</span> n = 0;</div>
<div class="line">  <span class="keywordtype">size_t</span> rdstart = 0;</div>
<div class="line">  <span class="keywordtype">size_t</span> length = <a class="code" href="mbuf_8c.html#ad77cb9e3d579e54318162f30c847b8f4">mbuf_length</a> (mbuf);</div>
<div class="line">  memset (s, 0, <span class="keyword">sizeof</span> (s));</div>
<div class="line"></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#a7217f65b708944e4f3f5d2f45e436a99">mbuf_read</a> (mbuf, (uint8_t*)s, 100);</div>
<div class="line"></div>
<div class="line">  fail_if (result != -1, <span class="stringliteral">&quot;Trying to read from an empty buffer did not fail!\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (s); i++)</div>
<div class="line">    s[i] = <span class="charliteral">&#39;A&#39;</span> + (i % 16);</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Fill the buffer</span></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#acb5cd36b259b0df7a3173259835dbba0">mbuf_write</a> (mbuf, (uint8_t*)s, length);</div>
<div class="line">  fail_if (result == -1, <span class="stringliteral">&quot;Trying to write test data into the buffer\n&quot;</span>);</div>
<div class="line">  memset (s, 0, <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(s));</div>
<div class="line"></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#a7217f65b708944e4f3f5d2f45e436a99">mbuf_read</a> (mbuf, (uint8_t*)s, 0);</div>
<div class="line">  fail_if (result == -1, <span class="stringliteral">&quot;Trying to read 0 bytes\n&quot;</span>);</div>
<div class="line">  fail_if (s[0] != 0);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a66620d08cfc91ca5f54b60f5b84a4be4">rd_remaining</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#ac8b0500b1655048c350b8e3a45c8e123">fill</a>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">size_t</span> old_remaining = mbuf-&gt;<a class="code" href="structMBuffer.html#a66620d08cfc91ca5f54b60f5b84a4be4">rd_remaining</a>;</div>
<div class="line">  <span class="keywordtype">size_t</span> remaining = mbuf-&gt;<a class="code" href="structMBuffer.html#a66620d08cfc91ca5f54b60f5b84a4be4">rd_remaining</a>;</div>
<div class="line">  <span class="keywordflow">while</span> (remaining)</div>
<div class="line">    {</div>
<div class="line">      memset (s, 0, <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (s));</div>
<div class="line">      <span class="keywordtype">int</span> rdlen = remaining * (((double)rand())/RAND_MAX) + 1;</div>
<div class="line"></div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#a7217f65b708944e4f3f5d2f45e436a99">mbuf_read</a> (mbuf, (uint8_t*)s, rdlen);</div>
<div class="line">      fail_if (result == -1, <span class="stringliteral">&quot;Unabled to read %d bytes from mbuf\n&quot;</span>, rdlen);</div>
<div class="line"></div>
<div class="line">      n += rdlen;</div>
<div class="line">      fail_if (strncmp (s, (<span class="keywordtype">char</span>*)&amp;mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>[rdstart], rdlen) != 0);</div>
<div class="line">      rdstart += rdlen;</div>
<div class="line">      fail_if (remaining &gt; old_remaining);</div>
<div class="line">      old_remaining = remaining;</div>
<div class="line">      remaining = mbuf-&gt;<a class="code" href="structMBuffer.html#a66620d08cfc91ca5f54b60f5b84a4be4">rd_remaining</a>;</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> &gt; mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">  fail_if (n != length);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a66620d08cfc91ca5f54b60f5b84a4be4">rd_remaining</a> != 0);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> - mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> != (<span class="keywordtype">int</span>)mbuf-&gt;<a class="code" href="structMBuffer.html#aa513d3a69c07fdfab78133f5fe220e69">length</a>);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a>);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4c6858d7501c31c61820fca0a9b542e0">wr_remaining</a> != 0);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2246e2a733225ac887ce55884880bb86"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_mbuf_read_null&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00303">303</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="mbuf_8h_source.html#l00041">MBuffer::fill</a>, <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00120">mbuf_length()</a>, <a class="el" href="mbuf_8c_source.html#l00466">mbuf_read()</a>, <a class="el" href="mbuf_8c_source.html#l00381">mbuf_write()</a>, <a class="el" href="mbuf_8h_source.html#l00039">MBuffer::rd_remaining</a>, and <a class="el" href="mbuf_8h_source.html#l00044">MBuffer::rdptr</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> s[8192];</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> result = 0;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  <span class="keywordtype">size_t</span> length = <a class="code" href="mbuf_8c.html#ad77cb9e3d579e54318162f30c847b8f4">mbuf_length</a> (mbuf);</div>
<div class="line">  memset (s, 0, <span class="keyword">sizeof</span> (s));</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (s); i++)</div>
<div class="line">    s[i] = <span class="charliteral">&#39;A&#39;</span> + (i % 16);</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Fill the buffer</span></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#acb5cd36b259b0df7a3173259835dbba0">mbuf_write</a> (mbuf, (uint8_t*)s, length);</div>
<div class="line">  fail_if (result == -1, <span class="stringliteral">&quot;Trying to write test data into the buffer\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#a7217f65b708944e4f3f5d2f45e436a99">mbuf_read</a> (mbuf, NULL, 1);</div>
<div class="line">  fail_if (result != -1);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a66620d08cfc91ca5f54b60f5b84a4be4">rd_remaining</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#ac8b0500b1655048c350b8e3a45c8e123">fill</a>);</div>
<div class="line"></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#a7217f65b708944e4f3f5d2f45e436a99">mbuf_read</a> (NULL, (uint8_t*)s, 1);</div>
<div class="line">  fail_if (result != -1);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adb29e1b0c784515dfd8ad581f2557f11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_mbuf_begin_read&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00329">329</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

<p>References <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="mbuf_8c_source.html#l00592">mbuf_begin_read()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00466">mbuf_read()</a>, <a class="el" href="mbuf_8c_source.html#l00381">mbuf_write()</a>, <a class="el" href="mbuf_8h_source.html#l00048">MBuffer::msgptr</a>, and <a class="el" href="mbuf_8h_source.html#l00044">MBuffer::rdptr</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> s[8192];</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> result = 0;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  memset (s, 0, <span class="keyword">sizeof</span> (s));</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (test_strings); i++)</div>
<div class="line">    {</div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#acb5cd36b259b0df7a3173259835dbba0">mbuf_write</a> (mbuf, (uint8_t*)test_strings[i], strlen (test_strings[i]));</div>
<div class="line">      fail_if (result == -1);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (test_strings); i++)</div>
<div class="line">    {</div>
<div class="line">      memset (s, 0, <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (s));</div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#a7217f65b708944e4f3f5d2f45e436a99">mbuf_read</a> (mbuf, (uint8_t*)s, strlen (test_strings[i]));</div>
<div class="line">      fail_if (result == -1);</div>
<div class="line"></div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#a15b039c1f8b9f4e0d5fdffdc5f554192">mbuf_begin_read</a> (mbuf);</div>
<div class="line">      fail_if (result == -1);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a>);</div>
<div class="line">      fail_if (strncmp (s, test_strings[i], strlen (test_strings[i])) != 0);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa42287550541771e7d19d25d31144be5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_mbuf_begin_write&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00357">357</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

<p>References <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="mbuf_8c_source.html#l00614">mbuf_begin_write()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00381">mbuf_write()</a>, <a class="el" href="mbuf_8h_source.html#l00048">MBuffer::msgptr</a>, and <a class="el" href="mbuf_8h_source.html#l00046">MBuffer::wrptr</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> s[8192];</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> result = 0;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  memset (s, 0, <span class="keyword">sizeof</span> (s));</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (test_strings); i++)</div>
<div class="line">    {</div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#acb5cd36b259b0df7a3173259835dbba0">mbuf_write</a> (mbuf, (uint8_t*)test_strings[i], strlen (test_strings[i]));</div>
<div class="line">      fail_if (result == -1);</div>
<div class="line"></div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#a0b154f7d6f90e0c1fae4dc360c28f8eb">mbuf_begin_write</a> (mbuf);</div>
<div class="line">      fail_if (result == -1);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a982eefabdfdeecebc78bdf11756fb7f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_mbuf_reset_read&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00377">377</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="mbuf_8c_source.html#l00592">mbuf_begin_read()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00466">mbuf_read()</a>, <a class="el" href="mbuf_8c_source.html#l00703">mbuf_reset_read()</a>, <a class="el" href="mbuf_8c_source.html#l00381">mbuf_write()</a>, <a class="el" href="mbuf_8h_source.html#l00048">MBuffer::msgptr</a>, and <a class="el" href="mbuf_8h_source.html#l00044">MBuffer::rdptr</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> s[4096];</div>
<div class="line">  <span class="keywordtype">char</span> t[4096];</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> result = 0;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  <span class="keywordtype">size_t</span> n = 0;</div>
<div class="line">  memset (s, 0, <span class="keyword">sizeof</span> (s));</div>
<div class="line">  memset (t, 0, <span class="keyword">sizeof</span> (t));</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (test_strings[i]); i++)</div>
<div class="line">    {</div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#acb5cd36b259b0df7a3173259835dbba0">mbuf_write</a> (mbuf, (uint8_t*)test_strings[i], strlen (test_strings[i]));</div>
<div class="line">      fail_if (result == -1);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#a15b039c1f8b9f4e0d5fdffdc5f554192">mbuf_begin_read</a> (mbuf);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (test_strings[i]); i++)</div>
<div class="line">    {</div>
<div class="line">      uint8_t* old_msgptr = mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a>;</div>
<div class="line">      memset (s, 0, <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(s));</div>
<div class="line">      strcat (t, test_strings[i]);</div>
<div class="line">      n += strlen (test_strings[i]);</div>
<div class="line"></div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#a7217f65b708944e4f3f5d2f45e436a99">mbuf_read</a> (mbuf, (uint8_t*)s, n);</div>
<div class="line">      fail_if (result == -1);</div>
<div class="line"></div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> - mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> != (<span class="keywordtype">int</span>)n,</div>
<div class="line">               <span class="stringliteral">&quot;\nRead(%d) of string %s (%d) gives rdptr-start = %d (rdptr=%d, start=%d)\n&quot;</span>,</div>
<div class="line">               i,</div>
<div class="line">               test_strings[i], strlen(test_strings[i]),</div>
<div class="line">               mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> - mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a>,</div>
<div class="line">               mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> - mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>,</div>
<div class="line">               mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> - mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line">      fail_if (strncmp (s, t, n) != 0);</div>
<div class="line"></div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#abf9a6c655d77bfc4f8d0299ce65a08c1">mbuf_reset_read</a> (mbuf);</div>
<div class="line">      fail_if (result == -1);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> != old_msgptr);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7d8820b186515ca764f6ccd72888d961"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_mbuf_reset_write&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00426">426</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00675">mbuf_reset_write()</a>, <a class="el" href="mbuf_8c_source.html#l00381">mbuf_write()</a>, <a class="el" href="mbuf_8h_source.html#l00048">MBuffer::msgptr</a>, <a class="el" href="mbuf_8h_source.html#l00044">MBuffer::rdptr</a>, and <a class="el" href="mbuf_8h_source.html#l00046">MBuffer::wrptr</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> s[4096];</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> result = 0;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  memset (s, 0, <span class="keyword">sizeof</span> (s));</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(test_strings); i++)</div>
<div class="line">    {</div>
<div class="line">      uint8_t* old_msgptr = mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a>;</div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#acb5cd36b259b0df7a3173259835dbba0">mbuf_write</a> (mbuf, (uint8_t*)test_strings[i], strlen (test_strings[i]));</div>
<div class="line"></div>
<div class="line">      fail_if (result == -1);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> &lt; mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a>);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> &lt; mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a>);</div>
<div class="line">      fail_if (strncmp ((<span class="keywordtype">char</span>*)mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>, test_strings[i], strlen (test_strings[i])) != 0);</div>
<div class="line"></div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#ac4ddd843a465364728d9b113cc2e63d8">mbuf_reset_write</a> (mbuf);</div>
<div class="line"></div>
<div class="line">      fail_if (result == -1);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> != old_msgptr);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a>);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a68b737cc90efc28afce4b1bd4a1eac1c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_mbuf_consume_message&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00454">454</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

<p>References <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="mbuf_8c_source.html#l00731">mbuf_consume_message()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00466">mbuf_read()</a>, <a class="el" href="mbuf_8c_source.html#l00703">mbuf_reset_read()</a>, <a class="el" href="mbuf_8c_source.html#l00381">mbuf_write()</a>, <a class="el" href="mbuf_8h_source.html#l00048">MBuffer::msgptr</a>, <a class="el" href="mbuf_8h_source.html#l00044">MBuffer::rdptr</a>, and <a class="el" href="mbuf_8h_source.html#l00046">MBuffer::wrptr</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> s[4096];</div>
<div class="line">  <span class="keywordtype">char</span> t[4096];</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> result = 0;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  memset (s, 0, <span class="keyword">sizeof</span> (s));</div>
<div class="line">  memset (t, 0, <span class="keyword">sizeof</span> (t));</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (test_strings); i++)</div>
<div class="line">    {</div>
<div class="line">      memset (s, 0, <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (s));</div>
<div class="line">      uint8_t* old_msgptr = mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a>;</div>
<div class="line">      <span class="keywordtype">size_t</span> msglen = strlen (test_strings[i]);</div>
<div class="line"></div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#acb5cd36b259b0df7a3173259835dbba0">mbuf_write</a> (mbuf, (uint8_t*)test_strings[i], msglen);</div>
<div class="line">      fail_if (result == -1);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> &lt; mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a>);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> &lt; mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a>);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> - mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> != (<span class="keywordtype">int</span>)msglen);</div>
<div class="line"></div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#a7217f65b708944e4f3f5d2f45e436a99">mbuf_read</a> (mbuf, (uint8_t*)s, msglen);</div>
<div class="line">      fail_if (result == -1);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a>);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> != old_msgptr);</div>
<div class="line">      fail_if (strcmp (s, test_strings[i]) != 0);</div>
<div class="line"></div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#abf9a6c655d77bfc4f8d0299ce65a08c1">mbuf_reset_read</a> (mbuf);</div>
<div class="line">      fail_if (result == -1);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> != old_msgptr);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a>);</div>
<div class="line"></div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#a7217f65b708944e4f3f5d2f45e436a99">mbuf_read</a> (mbuf, (uint8_t*)s, msglen);</div>
<div class="line">      fail_if (result == -1);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a>);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> != old_msgptr);</div>
<div class="line">      fail_if (strcmp (s, test_strings[i]) != 0);</div>
<div class="line"></div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#a29740cb378aba1d1a0a2a654e6ed0052">mbuf_consume_message</a> (mbuf);</div>
<div class="line">      fail_if (result == -1);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> - old_msgptr != (<span class="keywordtype">int</span>)msglen);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a>);</div>
<div class="line">      fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8ec137a031203d00e7324bc459cefbd4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_mbuf_repack&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00502">502</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="mbuf_8h_source.html#l00041">MBuffer::fill</a>, <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="mbuf_8c_source.html#l00592">mbuf_begin_read()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00466">mbuf_read()</a>, <a class="el" href="mbuf_8c_source.html#l00758">mbuf_repack()</a>, <a class="el" href="mbuf_8c_source.html#l00381">mbuf_write()</a>, <a class="el" href="mbuf_8h_source.html#l00048">MBuffer::msgptr</a>, <a class="el" href="mbuf_8h_source.html#l00039">MBuffer::rd_remaining</a>, <a class="el" href="mbuf_8h_source.html#l00044">MBuffer::rdptr</a>, and <a class="el" href="mbuf_8h_source.html#l00046">MBuffer::wrptr</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> s[4096];</div>
<div class="line">  <span class="keywordtype">char</span> t[4096];</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> result = 0;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  <span class="keywordtype">size_t</span> n = 0;</div>
<div class="line">  <span class="keywordtype">size_t</span> m = 0;</div>
<div class="line">  memset (s, 0, <span class="keyword">sizeof</span> (s));</div>
<div class="line">  memset (t, 0, <span class="keyword">sizeof</span> (t));</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">size_t</span> n_test_strings = <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (test_strings);</div>
<div class="line">  <span class="keywordtype">size_t</span> consumed = n_test_strings / 2;</div>
<div class="line"></div>
<div class="line">  <span class="comment">// FIXME: this is a weak test.</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; n_test_strings; i++)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">if</span> (i &lt; consumed)</div>
<div class="line">        n += strlen (test_strings[i]);</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">          m += strlen (test_strings[i]);</div>
<div class="line">          strcat (s, test_strings[i]);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#acb5cd36b259b0df7a3173259835dbba0">mbuf_write</a> (mbuf, (uint8_t*)test_strings[i], strlen (test_strings[i]));</div>
<div class="line">      fail_if (result == -1);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#a15b039c1f8b9f4e0d5fdffdc5f554192">mbuf_begin_read</a> (mbuf);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; consumed; i++)</div>
<div class="line">    {</div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#a7217f65b708944e4f3f5d2f45e436a99">mbuf_read</a> (mbuf, (uint8_t*)t, strlen (test_strings[i]));</div>
<div class="line">      fail_if (result == -1);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">  fail_unless (mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> - mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == (<span class="keywordtype">int</span>)n);</div>
<div class="line">  fail_unless (mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> == mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line"></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#a88e6f090bbfc4005582dd69424611a41">mbuf_repack</a> (mbuf);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> + mbuf-&gt;<a class="code" href="structMBuffer.html#ac8b0500b1655048c350b8e3a45c8e123">fill</a>);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#ac8b0500b1655048c350b8e3a45c8e123">fill</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a66620d08cfc91ca5f54b60f5b84a4be4">rd_remaining</a>);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#ac8b0500b1655048c350b8e3a45c8e123">fill</a> != m);</div>
<div class="line">  fail_if (strncmp ((<span class="keywordtype">char</span>*)mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>, s, mbuf-&gt;<a class="code" href="structMBuffer.html#ac8b0500b1655048c350b8e3a45c8e123">fill</a>) != 0);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a01b59fc8dc2865868266200334676330"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_mbuf_repack_message&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__liboml2__mbuf_8c_source.html#l00555">555</a> of file <a class="el" href="check__liboml2__mbuf_8c_source.html">check_liboml2_mbuf.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="mbuf_8h_source.html#l00041">MBuffer::fill</a>, <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="mbuf_8c_source.html#l00592">mbuf_begin_read()</a>, <a class="el" href="mbuf_8c_source.html#l00731">mbuf_consume_message()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00466">mbuf_read()</a>, <a class="el" href="mbuf_8c_source.html#l00785">mbuf_repack_message()</a>, <a class="el" href="mbuf_8c_source.html#l00381">mbuf_write()</a>, <a class="el" href="mbuf_8h_source.html#l00048">MBuffer::msgptr</a>, <a class="el" href="mbuf_8h_source.html#l00039">MBuffer::rd_remaining</a>, <a class="el" href="mbuf_8h_source.html#l00044">MBuffer::rdptr</a>, and <a class="el" href="mbuf_8h_source.html#l00046">MBuffer::wrptr</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> s[4096];</div>
<div class="line">  <span class="keywordtype">char</span> t[4096];</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> result = 0;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  <span class="keywordtype">size_t</span> n = 0;</div>
<div class="line">  <span class="keywordtype">size_t</span> m = 0;</div>
<div class="line">  memset (s, 0, <span class="keyword">sizeof</span> (s));</div>
<div class="line">  memset (t, 0, <span class="keyword">sizeof</span> (t));</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">size_t</span> n_test_strings = <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (test_strings);</div>
<div class="line">  <span class="keywordtype">size_t</span> consumed = n_test_strings / 2;</div>
<div class="line"></div>
<div class="line">  <span class="comment">// FIXME: this is a weak test.</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; n_test_strings; i++)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">if</span> (i &lt; consumed - 1) <span class="comment">// consumed - 1 is intentional</span></div>
<div class="line">        n += strlen (test_strings[i]);</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">          m += strlen (test_strings[i]);</div>
<div class="line">          strcat (s, test_strings[i]);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#acb5cd36b259b0df7a3173259835dbba0">mbuf_write</a> (mbuf, (uint8_t*)test_strings[i], strlen (test_strings[i]));</div>
<div class="line">      fail_if (result == -1);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#a15b039c1f8b9f4e0d5fdffdc5f554192">mbuf_begin_read</a> (mbuf);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; consumed - 1; i++)  <span class="comment">// consumed - 1 is intentional</span></div>
<div class="line">    {</div>
<div class="line">      result = <a class="code" href="mbuf_8c.html#a7217f65b708944e4f3f5d2f45e436a99">mbuf_read</a> (mbuf, (uint8_t*)t, strlen (test_strings[i]));</div>
<div class="line">      fail_if (result == -1);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Set the msgptr equal to the current rdptr</span></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#a29740cb378aba1d1a0a2a654e6ed0052">mbuf_consume_message</a> (mbuf);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line">  fail_unless (mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> - mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == (<span class="keywordtype">int</span>)n);</div>
<div class="line">  fail_unless (mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> == mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Make the rdptr different to the msgptr by reading one more string</span></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#a7217f65b708944e4f3f5d2f45e436a99">mbuf_read</a> (mbuf, (uint8_t*)t, strlen (test_strings[i]));</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line">  fail_unless (mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> &lt; mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">size_t</span> old_rd_offset = mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> - mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a>;</div>
<div class="line">  <span class="keywordtype">size_t</span> old_rd_remaining = mbuf-&gt;<a class="code" href="structMBuffer.html#a66620d08cfc91ca5f54b60f5b84a4be4">rd_remaining</a>;</div>
<div class="line"></div>
<div class="line">  result = <a class="code" href="mbuf_8c.html#a6197418fb3ef89250ac51be751e7805c">mbuf_repack_message</a> (mbuf);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a4f88072e9349ab18678d611eea4196ac">rdptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#af292d017b7c04e797f0d1467b84d00b5">msgptr</a> + old_rd_offset);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a859c46c105f32fcf1113e7ec9151cc28">wrptr</a> != mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> + mbuf-&gt;<a class="code" href="structMBuffer.html#ac8b0500b1655048c350b8e3a45c8e123">fill</a>);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a66620d08cfc91ca5f54b60f5b84a4be4">rd_remaining</a> != old_rd_remaining);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#ac8b0500b1655048c350b8e3a45c8e123">fill</a> != m);</div>
<div class="line">  fail_if (strncmp ((<span class="keywordtype">char</span>*)mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>, s, mbuf-&gt;<a class="code" href="structMBuffer.html#ac8b0500b1655048c350b8e3a45c8e123">fill</a>) != 0);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_13e138d54eb8818da29c3992edef070a.html">test</a></li><li class="navelem"><a class="el" href="dir_cb6d4dd8a38058a0954022986ea6be37.html">lib</a></li><li class="navelem"><a class="el" href="check__liboml2__mbuf_8c.html">check_liboml2_mbuf.c</a></li>
    <li class="footer">Generated on Thu Jun 25 2015 15:31:54 for oml2 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
