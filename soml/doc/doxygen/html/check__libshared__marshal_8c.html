<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>oml2: check_libshared_marshal.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="oml_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">oml2
   &#160;<span id="projectnumber">2.12.0pre.79-58cf-dirty</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('check__libshared__marshal_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">check_libshared_marshal.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;stdint.h&gt;</code><br/>
<code>#include &lt;inttypes.h&gt;</code><br/>
<code>#include &lt;arpa/inet.h&gt;</code><br/>
<code>#include &lt;check.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="omlc_8h_source.html">oml2/omlc.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="oml__util_8h_source.html">oml_util.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="htonll_8h_source.html">htonll.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="oml__value_8h_source.html">oml_value.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="marshal_8h_source.html">marshal.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="check__util_8h_source.html">check_util.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for check_libshared_marshal.c:</div>
<div class="dyncontent">
<div class="center"><img src="check__libshared__marshal_8c__incl.png" border="0" usemap="#check__libshared__marshal_8c" alt=""/></div>
<map name="check__libshared__marshal_8c" id="check__libshared__marshal_8c">
<area shape="rect" id="node19" href="omlc_8h.html" title="Public API of the OML client library." alt="" coords="647,315,740,344"/><area shape="rect" id="node34" href="oml__util_8h.html" title="oml_util.h" alt="" coords="1235,83,1312,112"/><area shape="rect" id="node36" href="htonll_8h.html" title="Macros for converting 64 bit integers between host and network representation." alt="" coords="1056,83,1120,112"/><area shape="rect" id="node39" href="oml__value_8h.html" title="oml_value.h" alt="" coords="285,237,376,267"/><area shape="rect" id="node46" href="marshal_8h.html" title="marshal.h" alt="" coords="400,237,477,267"/><area shape="rect" id="node55" href="check__util_8h.html" title="check_util.h" alt="" coords="688,83,779,112"/><area shape="rect" id="node30" href="o__log_8h.html" title="ocomm/o_log.h" alt="" coords="523,392,632,421"/><area shape="rect" id="node50" href="mbuf_8h.html" title="mbuf.h" alt="" coords="416,315,477,344"/><area shape="rect" id="node58" href="oml__filter_8h.html" title="Abstract interface for filters." alt="" coords="611,160,728,189"/><area shape="rect" id="node61" href="oml__writer_8h.html" title="Abstract interface for writers." alt="" coords="552,237,677,267"/></map>
</div>
</div>
<p><a href="check__libshared__marshal_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a369266c24eacffb87046522897a570d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a369266c24eacffb87046522897a570d5">_GNU_SOURCE</a>&#160;&#160;&#160;/* For NAN, M_PI */</td></tr>
<tr class="memitem:ae1436e5becd1f19af3526bc0467c0af1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf)&#160;&#160;&#160;(mbuf-&gt;base + 5)</td></tr>
<tr class="memitem:a002b2f4894492820fe708b1b7e7c5e70"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a002b2f4894492820fe708b1b7e7c5e70">EPSILON</a>&#160;&#160;&#160;1e-8</td></tr>
<tr class="memitem:a8eb978c63d7c9fe86a9544bdf8d54fe6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a8eb978c63d7c9fe86a9544bdf8d54fe6">MAX_MARSHALLED_STRING_LENGTH</a>&#160;&#160;&#160;254</td></tr>
<tr class="memitem:a69bfb6e73bae0625ac56f441ccf542d1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a69bfb6e73bae0625ac56f441ccf542d1">PACKET_HEADER_SIZE</a>&#160;&#160;&#160;5</td></tr>
<tr class="memitem:aed366c04ade17b819f78a3e69e102f01"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#aed366c04ade17b819f78a3e69e102f01">dumpmessage</a>(mbuf)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a14cae643cddb7b34662a96e71017deb7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a14cae643cddb7b34662a96e71017deb7">relative_error</a> (double v1, double v2)</td></tr>
<tr class="memitem:a96bd26769c4f92505f71a06f65ad7bf9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a96bd26769c4f92505f71a06f65ad7bf9">START_TEST</a> (test_marshal_init)</td></tr>
<tr class="memitem:aa8276e4c0647bc53d45b7cc0079fff91"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#aa8276e4c0647bc53d45b7cc0079fff91">START_TEST</a> (test_marshal_value_long)</td></tr>
<tr class="memitem:acf99cc3fb66016285584cde146c55a9c"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#acf99cc3fb66016285584cde146c55a9c">START_TEST</a> (test_marshal_value_int32)</td></tr>
<tr class="memitem:af4e367a2b1e79e3bbc46a100141a6fb2"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#af4e367a2b1e79e3bbc46a100141a6fb2">START_TEST</a> (test_marshal_value_uint32)</td></tr>
<tr class="memitem:a9e4e243c303f29558b8957540bbe4db0"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a9e4e243c303f29558b8957540bbe4db0">START_TEST</a> (test_marshal_value_int64)</td></tr>
<tr class="memitem:ad80f2ea68a85801abf8eca3a6cb6ab11"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#ad80f2ea68a85801abf8eca3a6cb6ab11">START_TEST</a> (test_marshal_value_uint64)</td></tr>
<tr class="memitem:a3a49038330783541297f933acf2f1f52"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a3a49038330783541297f933acf2f1f52">START_TEST</a> (test_marshal_value_double)</td></tr>
<tr class="memitem:abfdf106b045a296ebfd74fb67408c74f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#abfdf106b045a296ebfd74fb67408c74f">START_TEST</a> (test_marshal_value_string)</td></tr>
<tr class="memitem:a3225d0a7c4dac23cb03838df65d5d766"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a3225d0a7c4dac23cb03838df65d5d766">START_TEST</a> (test_marshal_guid)</td></tr>
<tr class="memitem:a88cb17b6b9b1cea97c82ec426319f739"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a88cb17b6b9b1cea97c82ec426319f739">START_TEST</a> (test_marshal_bool)</td></tr>
<tr class="memitem:af5daf5ee4cdd4e15e6ea1db84f668fff"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#af5daf5ee4cdd4e15e6ea1db84f668fff">START_TEST</a> (test_marshal_unmarshal_long)</td></tr>
<tr class="memitem:ac9fc4ffdae099e3ff4163502b5f949f6"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#ac9fc4ffdae099e3ff4163502b5f949f6">START_TEST</a> (test_marshal_unmarshal_int32)</td></tr>
<tr class="memitem:acc34a8566b9501a3ec815ef55cdcb5d3"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#acc34a8566b9501a3ec815ef55cdcb5d3">START_TEST</a> (test_marshal_unmarshal_uint32)</td></tr>
<tr class="memitem:a7d7c3661f186fa20ef69b4e295b5b142"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a7d7c3661f186fa20ef69b4e295b5b142">START_TEST</a> (test_marshal_unmarshal_int64)</td></tr>
<tr class="memitem:a16fdf784ef43ee02d7d89fa9f2ef60a4"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a16fdf784ef43ee02d7d89fa9f2ef60a4">START_TEST</a> (test_marshal_unmarshal_uint64)</td></tr>
<tr class="memitem:a803940ece31831641f15ed4f81429698"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a803940ece31831641f15ed4f81429698">START_TEST</a> (test_marshal_unmarshal_double)</td></tr>
<tr class="memitem:a85b9ed30111d475095014efb50739652"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a85b9ed30111d475095014efb50739652">START_TEST</a> (test_marshal_unmarshal_string)</td></tr>
<tr class="memitem:a61e87431b4980a6b61393a639121721a"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a61e87431b4980a6b61393a639121721a">START_TEST</a> (test_marshal_unmarshal_guid)</td></tr>
<tr class="memitem:a64f3910f995ee5a89e538e63c179ec62"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a64f3910f995ee5a89e538e63c179ec62">START_TEST</a> (test_marshal_unmarshal_bool)</td></tr>
<tr class="memitem:afd19d64288e3d2e1e3ea05d94673853b"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#afd19d64288e3d2e1e3ea05d94673853b">START_TEST</a> (test_marshal_unmarshal_vector_double)</td></tr>
<tr class="memitem:a4b582f6153d3905134ff1fe49b1f40ee"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a4b582f6153d3905134ff1fe49b1f40ee">START_TEST</a> (test_marshal_unmarshal_vector_int32)</td></tr>
<tr class="memitem:a9f3b2e4534b437fde22e453306b582ec"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a9f3b2e4534b437fde22e453306b582ec">START_TEST</a> (test_marshal_unmarshal_vector_int64)</td></tr>
<tr class="memitem:a04677ba86ffbc4a1248eec888629cf55"><td class="memItemLeft" align="right" valign="top">END_TEST&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#a04677ba86ffbc4a1248eec888629cf55">START_TEST</a> (test_marshal_unmarshal_vector_bool)</td></tr>
<tr class="memitem:abdba2a42e0a13223c08a79dc8d5542be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#abdba2a42e0a13223c08a79dc8d5542be">START_TEST</a> (test_marshal_full)</td></tr>
<tr class="memitem:aa2e8dd5a70e817c032a6594e3c52a87e"><td class="memItemLeft" align="right" valign="top">END_TEST Suite *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#aa2e8dd5a70e817c032a6594e3c52a87e">marshal_suite</a> (void)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa7aa04bfed2ab466dc2cd231d9392e1c"><td class="memItemLeft" align="right" valign="top">END_TEST unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check__libshared__marshal_8c.html#aa7aa04bfed2ab466dc2cd231d9392e1c">string_buf</a> [<a class="el" href="check__libshared__marshal_8c.html#a8eb978c63d7c9fe86a9544bdf8d54fe6">MAX_MARSHALLED_STRING_LENGTH</a> *2]</td></tr>
</table>
<h2>Macro Definition Documentation</h2>
<a class="anchor" id="a369266c24eacffb87046522897a570d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _GNU_SOURCE&#160;&#160;&#160;/* For NAN, M_PI */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00024">24</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

</div>
</div>
<a class="anchor" id="aed366c04ade17b819f78a3e69e102f01"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define dumpmessage</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">mbuf</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                                                                                                      \</div>
<div class="line">    uint8_t *_m = <a class="code" href="mbuf_8c.html#a64f532f1d7946c6969320cc4313bc687">mbuf_message</a>(mbuf), *_p = _m;                                                             \</div>
<div class="line">    logdebug(<span class="stringliteral">&quot;Message of length %d\n&quot;</span>, <a class="code" href="mbuf_8c.html#a1afcdf8eb3312a3006b1ed5cc8e8843e">mbuf_message_length</a>(mbuf));                                          \</div>
<div class="line">    do <a class="code" href="log_8c.html#a1db1902215b0897e1ec8c2a8766465b2">logdebug</a>(<span class="stringliteral">&quot;&gt; %02d: %#02x\t(%c)\n&quot;</span>, (<span class="keywordtype">int</span>)(_p-_m), (uint8_t)*_p, ((uint8_t)*_p&gt;=<span class="charliteral">&#39; &#39;</span>?(uint8_t)*_p:<span class="charliteral">&#39;X&#39;</span>)); \</div>
<div class="line">    while (++_p &lt; _m + <a class="code" href="mbuf_8c.html#a1afcdf8eb3312a3006b1ed5cc8e8843e">mbuf_message_length</a>(mbuf));                                                          \</div>
<div class="line">  } <span class="keywordflow">while</span>(0)</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l01366">1366</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>Referenced by <a class="el" href="check__libshared__marshal_8c_source.html#l01374">START_TEST()</a>.</p>

</div>
</div>
<a class="anchor" id="a002b2f4894492820fe708b1b7e7c5e70"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EPSILON&#160;&#160;&#160;1e-8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00043">43</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>Referenced by <a class="el" href="check__libshared__marshal_8c_source.html#l00472">START_TEST()</a>.</p>

</div>
</div>
<a class="anchor" id="ae1436e5becd1f19af3526bc0467c0af1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FIRST_VALPTR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">mbuf</td><td>)</td>
          <td>&#160;&#160;&#160;(mbuf-&gt;base + 5)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00041">41</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>Referenced by <a class="el" href="check__libshared__marshal_8c_source.html#l00350">START_TEST()</a>.</p>

</div>
</div>
<a class="anchor" id="a8eb978c63d7c9fe86a9544bdf8d54fe6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_MARSHALLED_STRING_LENGTH&#160;&#160;&#160;254</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00045">45</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>Referenced by <a class="el" href="check__libshared__marshal_8c_source.html#l00514">START_TEST()</a>.</p>

</div>
</div>
<a class="anchor" id="a69bfb6e73bae0625ac56f441ccf542d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PACKET_HEADER_SIZE&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00060">60</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>Referenced by <a class="el" href="check__libshared__marshal_8c_source.html#l01374">START_TEST()</a>.</p>

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="aa2e8dd5a70e817c032a6594e3c52a87e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST Suite* marshal_suite </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l01811">1811</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>.</p>

<p>Referenced by <a class="el" href="check__libshared_8c_source.html#l00031">main()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  Suite* s = suite_create (<span class="stringliteral">&quot;Marshal&quot;</span>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Marshalling test cases */</span></div>
<div class="line">  TCase* tc_marshal = tcase_create (<span class="stringliteral">&quot;Marshal&quot;</span>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Add tests to &quot;Marshal&quot; */</span></div>
<div class="line">  tcase_add_test (tc_marshal, test_marshal_init);</div>
<div class="line">  tcase_add_loop_test (tc_marshal, test_marshal_value_long,   0, <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (long_values));</div>
<div class="line">  tcase_add_loop_test (tc_marshal, test_marshal_value_int32,  0, <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (int32_values));</div>
<div class="line">  tcase_add_loop_test (tc_marshal, test_marshal_value_uint32, 0, <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (int32_values));</div>
<div class="line">  tcase_add_loop_test (tc_marshal, test_marshal_value_int64,  0, <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (int64_values));</div>
<div class="line">  tcase_add_loop_test (tc_marshal, test_marshal_value_uint64, 0, <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (int64_values));</div>
<div class="line">  tcase_add_loop_test (tc_marshal, test_marshal_value_double, 0, <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (double_values));</div>
<div class="line">  tcase_add_loop_test (tc_marshal, test_marshal_value_string, 0, <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (string_values));</div>
<div class="line">  tcase_add_loop_test (tc_marshal, test_marshal_guid,         0, <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (guid_values));</div>
<div class="line">  tcase_add_loop_test (tc_marshal, test_marshal_bool,         0, <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (bool_values));</div>
<div class="line"></div>
<div class="line">  tcase_add_test (tc_marshal, test_marshal_unmarshal_long);</div>
<div class="line">  tcase_add_test (tc_marshal, test_marshal_unmarshal_int32);</div>
<div class="line">  tcase_add_test (tc_marshal, test_marshal_unmarshal_uint32);</div>
<div class="line">  tcase_add_test (tc_marshal, test_marshal_unmarshal_int64);</div>
<div class="line">  tcase_add_test (tc_marshal, test_marshal_unmarshal_uint64);</div>
<div class="line">  tcase_add_test (tc_marshal, test_marshal_unmarshal_double);</div>
<div class="line">  tcase_add_test (tc_marshal, test_marshal_unmarshal_string);</div>
<div class="line">  tcase_add_test (tc_marshal, test_marshal_unmarshal_guid);</div>
<div class="line">  tcase_add_test (tc_marshal, test_marshal_unmarshal_bool);</div>
<div class="line">  tcase_add_test (tc_marshal, test_marshal_unmarshal_vector_double);</div>
<div class="line">  tcase_add_test (tc_marshal, test_marshal_unmarshal_vector_int32);</div>
<div class="line">  tcase_add_test (tc_marshal, test_marshal_unmarshal_vector_int64);</div>
<div class="line">  tcase_add_test (tc_marshal, test_marshal_unmarshal_vector_bool);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Do the full marshalling/unmarshalling test, types above should also be tested there */</span></div>
<div class="line">  tcase_add_test (tc_marshal, test_marshal_full);</div>
<div class="line"></div>
<div class="line">  suite_add_tcase (s, tc_marshal);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> s;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a14cae643cddb7b34662a96e71017deb7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double relative_error </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>v2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00324">324</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="check__liboml2__omlvalue_8c_source.html#l00407">b</a>.</p>

<p>Referenced by <a class="el" href="check__libshared__marshal_8c_source.html#l00472">START_TEST()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">double</span> a, <a class="code" href="check__liboml2__omlvalue_8c.html#a4313c9563516f94387762ab05763456b">b</a>;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (v1 == v2) <span class="keywordflow">return</span> 0.0;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (v1 == 0.0 &amp;&amp; v2 != 0.0) { a = v2; b = v1; }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v2 == 0.0 &amp;&amp; v1 != 0.0) { a = v1; b = v2; }</div>
<div class="line">  <span class="keywordflow">else</span> { a = v2; b = v1; }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* a is guaranteed to be non-zero */</span></div>
<div class="line">  <span class="keywordflow">return</span> fabs ((a - b) / a);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a96bd26769c4f92505f71a06f65ad7bf9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_init&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00338">338</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, and <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> result = <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line"></div>
<div class="line">  fail_if (result != 0);</div>
<div class="line">  fail_unless (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>[0] == 0xAA);</div>
<div class="line">  fail_unless (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>[1] == 0xAA);</div>
<div class="line">  fail_unless ((<span class="keywordtype">int</span>)mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>[2] == <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa8276e4c0647bc53d45b7cc0079fff91"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_value_long&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00350">350</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l00041">FIRST_VALPTR</a>, <a class="el" href="marshal_8c_source.html#l00187">LONG_T</a>, <a class="el" href="omlc_8h_source.html#l00183">OmlValueU::longValue</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00037">OML_LONG_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00296">omlc_set_long</a>, and <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> initresult = <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line"></div>
<div class="line">  fail_if (initresult != 0);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">  <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(v);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a799e1ce72c79484ef5efe79bf5a408af">omlc_set_long</a>(v, long_values[_i]);</div>
<div class="line">  <span class="keywordtype">int</span> result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a> (mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012a22fda4d714f29db7df49a3574986e67c">OML_LONG_VALUE</a>, &amp;v);</div>
<div class="line"></div>
<div class="line">  uint32_t nv = 0;</div>
<div class="line">  memcpy (&amp;nv, <a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf) + 1, 4);</div>
<div class="line">  uint32_t hv = ntohl (nv);</div>
<div class="line">  <span class="keywordtype">long</span> val = (int32_t)hv;</div>
<div class="line"></div>
<div class="line">  fail_if (result != 1);</div>
<div class="line">  fail_if ((<span class="keywordtype">int</span>)*(<a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf)) != <a class="code" href="marshal_8c.html#a95f0d5df544261dab0fd0dcc5063de1f">LONG_T</a>); <span class="comment">// LONG_T</span></div>
<div class="line">  fail_if (val != oml_value_clamp_long (v.<a class="code" href="unionOmlValueU.html#a68b51dd2d189b56763fe42c44268e588">longValue</a>),</div>
<div class="line">      <span class="stringliteral">&quot;Improrely clamped LONG: expected %ld, got %ld&quot;</span>,</div>
<div class="line">      val, oml_value_clamp_long (v.<a class="code" href="unionOmlValueU.html#a68b51dd2d189b56763fe42c44268e588">longValue</a>));</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acf99cc3fb66016285584cde146c55a9c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_value_int32&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00376">376</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l00041">FIRST_VALPTR</a>, <a class="el" href="marshal_8c_source.html#l00195">INT32_T</a>, <a class="el" href="omlc_8h_source.html#l00186">OmlValueU::int32Value</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00040">OML_INT32_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00281">omlc_set_int32</a>, and <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> initresult = <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line"></div>
<div class="line">  fail_if (initresult != 0);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">  <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(v);</div>
<div class="line">  <a class="code" href="omlc_8h.html#aa8a1827db1559f247bf8a4023e466873">omlc_set_int32</a>(v, int32_values[_i]);</div>
<div class="line">  <span class="keywordtype">int</span> result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a> (mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aab24deeb6fcd36f47779e12dca2c38b9">OML_INT32_VALUE</a>, &amp;v);</div>
<div class="line"></div>
<div class="line">  uint32_t nv = 0;</div>
<div class="line">  memcpy (&amp;nv, <a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf) + 1, 4);</div>
<div class="line">  uint32_t hv = ntohl (nv);</div>
<div class="line">  int32_t val = (int32_t)hv;</div>
<div class="line"></div>
<div class="line">  fail_if (result != 1);</div>
<div class="line">  fail_if ((<span class="keywordtype">int</span>)*(<a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf)) != <a class="code" href="marshal_8c.html#a2251891f2e0a2db27ca4c6507d3f4040">INT32_T</a>); <span class="comment">// INT32_T</span></div>
<div class="line">  fail_if (val != v.<a class="code" href="unionOmlValueU.html#afb7c5ec7f57fa2a4c48f77fa978517a0">int32Value</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af4e367a2b1e79e3bbc46a100141a6fb2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_value_uint32&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00400">400</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l00041">FIRST_VALPTR</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00041">OML_UINT32_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00284">omlc_set_uint32</a>, <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>, <a class="el" href="marshal_8c_source.html#l00197">UINT32_T</a>, and <a class="el" href="omlc_8h_source.html#l00187">OmlValueU::uint32Value</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> initresult = <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line"></div>
<div class="line">  fail_if (initresult != 0);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">  <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(v);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a1e481b1b79bdf517a3507ce8113169b2">omlc_set_uint32</a>(v, (uint32_t)int32_values[_i]);</div>
<div class="line">  <span class="keywordtype">int</span> result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a> (mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aad8721fa7d76e62c5885222061fa7827">OML_UINT32_VALUE</a>, &amp;v);</div>
<div class="line"></div>
<div class="line">  uint32_t nv = 0;</div>
<div class="line">  memcpy (&amp;nv, <a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf) + 1, 4);</div>
<div class="line">  uint32_t hv = ntohl (nv);</div>
<div class="line">  uint32_t val = (uint32_t)hv;</div>
<div class="line"></div>
<div class="line">  fail_if (result != 1);</div>
<div class="line">  fail_if ((<span class="keywordtype">int</span>)*(<a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf)) != <a class="code" href="marshal_8c.html#a6bcb89102f0baaa6be3d8d140b2dc866">UINT32_T</a>); <span class="comment">// UINT32_T</span></div>
<div class="line">  fail_if (val != v.<a class="code" href="unionOmlValueU.html#a7a2c76d60700d46a56dde5f398c73000">uint32Value</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9e4e243c303f29558b8957540bbe4db0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_value_int64&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00424">424</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l00041">FIRST_VALPTR</a>, <a class="el" href="marshal_8c_source.html#l00199">INT64_T</a>, <a class="el" href="omlc_8h_source.html#l00188">OmlValueU::int64Value</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="htonll_8h_source.html#l00038">ntohll</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00042">OML_INT64_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00287">omlc_set_int64</a>, and <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> initresult = <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line"></div>
<div class="line">  fail_if (initresult != 0);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">  <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(v);</div>
<div class="line">  <a class="code" href="omlc_8h.html#ae05c1e9d59d47fac7ce71b2136533958">omlc_set_int64</a>(v, (int64_t)int64_values[_i]);</div>
<div class="line">  <span class="keywordtype">int</span> result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a> (mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012af4f2a3a1e0887652fb41bab6b6bb96ee">OML_INT64_VALUE</a>, &amp;v);</div>
<div class="line"></div>
<div class="line">  uint64_t nv = 0;</div>
<div class="line">  memcpy (&amp;nv, <a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a> (mbuf) + 1, 8);</div>
<div class="line">  uint64_t hv = <a class="code" href="htonll_8h.html#a47f5c12368dfdf98a92bb0a8175c006f">ntohll</a> (nv);</div>
<div class="line">   int64_t val = (int64_t)hv;</div>
<div class="line"></div>
<div class="line">  fail_if (result != 1);</div>
<div class="line">  fail_if ((<span class="keywordtype">int</span>)*(<a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf)) != <a class="code" href="marshal_8c.html#afb3891492b67fa5ded53824df675ae9b">INT64_T</a>); <span class="comment">// INT64_T</span></div>
<div class="line">  fail_if (val != v.<a class="code" href="unionOmlValueU.html#a84566cbb0dd798989bacca5c2ba8dd81">int64Value</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad80f2ea68a85801abf8eca3a6cb6ab11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_value_uint64&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00448">448</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l00041">FIRST_VALPTR</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="htonll_8h_source.html#l00038">ntohll</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00043">OML_UINT64_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00290">omlc_set_uint64</a>, <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>, <a class="el" href="marshal_8c_source.html#l00201">UINT64_T</a>, and <a class="el" href="omlc_8h_source.html#l00189">OmlValueU::uint64Value</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> initresult = <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line"></div>
<div class="line">  fail_if (initresult != 0);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">  <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(v);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a873792518d05507bf5d0b1a96524b091">omlc_set_uint64</a>(v, (uint64_t)int64_values[_i]);</div>
<div class="line">  <span class="keywordtype">int</span> result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a> (mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aa0ecc1e475955c44a641c75e841ca2fc">OML_UINT64_VALUE</a>, &amp;v);</div>
<div class="line"></div>
<div class="line">  uint64_t nv = 0;</div>
<div class="line">  memcpy (&amp;nv, <a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf) + 1, 8);</div>
<div class="line">  uint64_t hv = <a class="code" href="htonll_8h.html#a47f5c12368dfdf98a92bb0a8175c006f">ntohll</a> (nv);</div>
<div class="line">  uint64_t val = (uint64_t)hv;</div>
<div class="line"></div>
<div class="line">  fail_if (result != 1);</div>
<div class="line">  fail_if ((<span class="keywordtype">int</span>)*(<a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf)) != <a class="code" href="marshal_8c.html#a8065a16ba5bd6bb2bd861936a87b31c3">UINT64_T</a>); <span class="comment">// UINT64_T</span></div>
<div class="line">  fail_if (val != v.<a class="code" href="unionOmlValueU.html#a27ebbc99be2387d2b263062333563abd">uint64Value</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3a49038330783541297f933acf2f1f52"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_value_double&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00472">472</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="marshal_8c_source.html#l00191">DOUBLE_NAN</a>, <a class="el" href="marshal_8c_source.html#l00189">DOUBLE_T</a>, <a class="el" href="omlc_8h_source.html#l00184">OmlValueU::doubleValue</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l00043">EPSILON</a>, <a class="el" href="check__text__protocol_8c_source.html#l00139">exp</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l00041">FIRST_VALPTR</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00036">OML_DOUBLE_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00293">omlc_set_double</a>, <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l00324">relative_error()</a>, and <a class="el" href="oml__value_8c_source.html#l00042">type</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> initresult = <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line"></div>
<div class="line">  fail_if (initresult != 0);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">  <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(v);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a6a342646d654733d01aff00bf9a308da">omlc_set_double</a>(v, double_values[_i]);</div>
<div class="line">  <span class="keywordtype">int</span> iexp;</div>
<div class="line">  <span class="keywordtype">double</span> dmant = frexp (v.<a class="code" href="unionOmlValueU.html#a85a9c96bcaecffe21538c0e8a63ab208">doubleValue</a>, &amp;iexp) * (1 &lt;&lt; 30);</div>
<div class="line">  int32_t imant = (int32_t)dmant;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">int</span> result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a> (mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012adf6df4b257026d03f661cfb85dc7d1c3">OML_DOUBLE_VALUE</a>, &amp;v);</div>
<div class="line"></div>
<div class="line">  uint8_t <a class="code" href="oml__value_8c.html#ae1087eeb503fb7b11a810d93605c97df">type</a> = *<a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf);</div>
<div class="line">  uint32_t nv = 0;</div>
<div class="line">  memcpy (&amp;nv, <a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf) + 1, 4);</div>
<div class="line">  int8_t <a class="code" href="check__text__protocol_8c.html#afc541abe000a672ebe850f1448b25306">exp</a> = *(<a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf) + 5);</div>
<div class="line">  uint32_t hv = ntohl (nv);</div>
<div class="line">  <span class="keywordtype">int</span> mant = (int)hv;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> val = ldexp (mant * 1.0 / (1 &lt;&lt; 30), exp);</div>
<div class="line"></div>
<div class="line">  fail_if (result != 1);</div>
<div class="line">  <span class="keywordflow">if</span> (isnan(double_values[_i])) {</div>
<div class="line">    fail_if (type != <a class="code" href="marshal_8c.html#a05c4e15b9701b28975effde191bc9bf6">DOUBLE_NAN</a>);</div>
<div class="line">    imant = 0;</div>
<div class="line">    iexp = 0;</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    fail_if (type != <a class="code" href="marshal_8c.html#a9290324f1f88b0f007de36d523d8cf3a">DOUBLE_T</a>);</div>
<div class="line">  }</div>
<div class="line">  fail_if (mant != imant, <span class="stringliteral">&quot;Value %g:  mismatched mantissa, expected %d, got %d\n&quot;</span>, double_values[_i], imant, mant);</div>
<div class="line">  fail_if (exp != iexp, <span class="stringliteral">&quot;Value %g:  mismatched exponent, expected %d, got %d\n&quot;</span>, double_values[_i], iexp, exp);</div>
<div class="line">  fail_if (<a class="code" href="check__libshared__marshal_8c.html#a14cae643cddb7b34662a96e71017deb7">relative_error</a> (val, v.<a class="code" href="unionOmlValueU.html#a85a9c96bcaecffe21538c0e8a63ab208">doubleValue</a>) &gt; <a class="code" href="check__libshared__marshal_8c.html#a002b2f4894492820fe708b1b7e7c5e70">EPSILON</a>, <span class="stringliteral">&quot;Value %g expected, recovered %f from the buffer, delta=%g\n&quot;</span>, double_values[_i], val, double_values[_i] - val);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abfdf106b045a296ebfd74fb67408c74f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_value_string&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00514">514</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l00041">FIRST_VALPTR</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l00045">MAX_MARSHALLED_STRING_LENGTH</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00039">OML_STRING_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00457">omlc_reset_string</a>, <a class="el" href="omlc_8h_source.html#l00505">omlc_set_string</a>, <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>, and <a class="el" href="check__libshared__marshal_8c_source.html#l00512">string_buf</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> initresult = <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line"></div>
<div class="line">  fail_if (initresult != 0);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">  <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(v);</div>
<div class="line">  <span class="keywordtype">char</span>* test_string = string_values[_i];</div>
<div class="line">  <span class="keywordtype">size_t</span> len = strlen (test_string);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a13be9537ef85ccdc463a6172d4716d3a">omlc_set_string</a>(v, test_string);</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">int</span> result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a> (mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012a42b33eb7c21f79727a894a530a05b559">OML_STRING_VALUE</a>, &amp;v);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="omlc_8h.html#a1434bd8b5a841357336609930bdb05c3">omlc_reset_string</a>(v);</div>
<div class="line"></div>
<div class="line">  fail_if (result != 1);</div>
<div class="line">  fail_if (*<a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf) != 0x4); <span class="comment">// STRING_T</span></div>
<div class="line"></div>
<div class="line">  memset (<a class="code" href="check__libshared__marshal_8c.html#aa7aa04bfed2ab466dc2cd231d9392e1c">string_buf</a>, 0, <a class="code" href="check__libshared__marshal_8c.html#a8eb978c63d7c9fe86a9544bdf8d54fe6">MAX_MARSHALLED_STRING_LENGTH</a>);</div>
<div class="line">  memcpy (<a class="code" href="check__libshared__marshal_8c.html#aa7aa04bfed2ab466dc2cd231d9392e1c">string_buf</a>, <a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a> (mbuf) + 2, *(<a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a> (mbuf) + 1));</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (len &lt;= <a class="code" href="check__libshared__marshal_8c.html#a8eb978c63d7c9fe86a9544bdf8d54fe6">MAX_MARSHALLED_STRING_LENGTH</a>) {</div>
<div class="line">      fail_if (*(<a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf) + 1) != len); <span class="comment">// Length of string</span></div>
<div class="line">      fail_if (strlen ((<span class="keywordtype">char</span>*)<a class="code" href="check__libshared__marshal_8c.html#aa7aa04bfed2ab466dc2cd231d9392e1c">string_buf</a>) != len);</div>
<div class="line">      fail_if (strcmp ((<span class="keywordtype">char</span>*)<a class="code" href="check__libshared__marshal_8c.html#aa7aa04bfed2ab466dc2cd231d9392e1c">string_buf</a>, test_string) != 0);</div>
<div class="line">      <span class="comment">// FIXME:  Check that the buffer is zero past the last element of the test string.</span></div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">      fail_if (*(<a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf) + 1) != <a class="code" href="check__libshared__marshal_8c.html#a8eb978c63d7c9fe86a9544bdf8d54fe6">MAX_MARSHALLED_STRING_LENGTH</a>); <span class="comment">// Length of string</span></div>
<div class="line">      fail_if (strlen((<span class="keywordtype">char</span>*)<a class="code" href="check__libshared__marshal_8c.html#aa7aa04bfed2ab466dc2cd231d9392e1c">string_buf</a>) != <a class="code" href="check__libshared__marshal_8c.html#a8eb978c63d7c9fe86a9544bdf8d54fe6">MAX_MARSHALLED_STRING_LENGTH</a>);</div>
<div class="line">      fail_if (strncmp ((<span class="keywordtype">char</span>*)<a class="code" href="check__libshared__marshal_8c.html#aa7aa04bfed2ab466dc2cd231d9392e1c">string_buf</a>, test_string, <a class="code" href="check__libshared__marshal_8c.html#a8eb978c63d7c9fe86a9544bdf8d54fe6">MAX_MARSHALLED_STRING_LENGTH</a>) != 0);</div>
<div class="line">      <span class="comment">// FIXME:  Check that the buffer doesn&#39;t contain more elements of the test string than it should</span></div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3225d0a7c4dac23cb03838df65d5d766"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_guid&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00556">556</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l00041">FIRST_VALPTR</a>, <a class="el" href="marshal_8c_source.html#l00205">GUID_T</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="htonll_8h_source.html#l00038">ntohll</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00045">OML_GUID_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00299">omlc_set_guid</a>, and <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> initresult = <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line"></div>
<div class="line">  fail_if (initresult != 0);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">  <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(v);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a836a2fe9346677384bf5dd8dee7eb0ed">omlc_set_guid</a>(v, guid_values[_i]);</div>
<div class="line">  <span class="keywordtype">int</span> result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a>(mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012a8f383c792a4697dbf4db99ef2514853f">OML_GUID_VALUE</a>, &amp;v);</div>
<div class="line">  fail_if(result != 1);</div>
<div class="line">  fail_if(*(<a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf)) != <a class="code" href="marshal_8c.html#a06c2c3d86fd6e81c65fa34777944f495">GUID_T</a>);</div>
<div class="line"></div>
<div class="line">  uint64_t nv = 0;</div>
<div class="line">  memcpy(&amp;nv, <a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf) + 1, <span class="keyword">sizeof</span>(nv));</div>
<div class="line">  <a class="code" href="omlc_8h.html#a8679c9edab629e9ce63964b64929aaf1">oml_guid_t</a> val = (<a class="code" href="omlc_8h.html#a8679c9edab629e9ce63964b64929aaf1">oml_guid_t</a>) <a class="code" href="htonll_8h.html#a47f5c12368dfdf98a92bb0a8175c006f">ntohll</a>(nv);</div>
<div class="line">  fail_if(val != guid_values[_i], <span class="stringliteral">&quot;%llx != %llx\n&quot;</span>, val, guid_values[_i]);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a88cb17b6b9b1cea97c82ec426319f739"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_bool&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00578">578</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="marshal_8c_source.html#l00207">BOOL_FALSE_T</a>, <a class="el" href="marshal_8c_source.html#l00209">BOOL_TRUE_T</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l00041">FIRST_VALPTR</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00046">OML_BOOL_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00302">omlc_set_bool</a>, and <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <span class="keywordtype">int</span> initresult = <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line"></div>
<div class="line">  fail_if (initresult != 0);</div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">  <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(v);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a8d84dc9e74c5e2c6fe319a6e1d9f8776">omlc_set_bool</a>(v, bool_values[_i]);</div>
<div class="line">  <span class="keywordtype">int</span> result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a>(mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012ac12a596e1ea36e0a6f0c58d2b63c8046">OML_BOOL_VALUE</a>, &amp;v);</div>
<div class="line">  fail_if(result != 1);</div>
<div class="line">  fail_if(*(<a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf)) != <a class="code" href="marshal_8c.html#aaaece6ec7d7273c485301e9b4a88c27e">BOOL_TRUE_T</a> &amp;&amp; *(<a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf)) != <a class="code" href="marshal_8c.html#a7e5ce4a4afe3c8c5e6a166a98c73bf49">BOOL_FALSE_T</a>);</div>
<div class="line"></div>
<div class="line">  uint8_t val = (uint8_t) *<a class="code" href="check__libshared__marshal_8c.html#ae1436e5becd1f19af3526bc0467c0af1">FIRST_VALPTR</a>(mbuf);</div>
<div class="line">  fail_if((val == <a class="code" href="marshal_8c.html#a7e5ce4a4afe3c8c5e6a166a98c73bf49">BOOL_FALSE_T</a> &amp;&amp; bool_values[_i]) ||</div>
<div class="line">      (val == <a class="code" href="marshal_8c.html#aaaece6ec7d7273c485301e9b4a88c27e">BOOL_TRUE_T</a> &amp;&amp; !bool_values[_i]),</div>
<div class="line">      <span class="stringliteral">&quot;%d and %d do not have the same truth value&quot;</span>,</div>
<div class="line">      (val==<a class="code" href="marshal_8c.html#aaaece6ec7d7273c485301e9b4a88c27e">BOOL_TRUE_T</a>)?1:((val==<a class="code" href="marshal_8c.html#a7e5ce4a4afe3c8c5e6a166a98c73bf49">BOOL_FALSE_T</a>)?0:-1), bool_values[_i]);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af5daf5ee4cdd4e15e6ea1db84f668fff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_unmarshal_long&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00602">602</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="check__libshared__headers_8c_source.html#l00071">header</a>, <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="marshal_8c_source.html#l00187">LONG_T</a>, <a class="el" href="omlc_8h_source.html#l00183">OmlValueU::longValue</a>, <a class="el" href="marshal_8c_source.html#l00897">marshal_finalize()</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00495">marshal_measurements()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00167">mbuf_fill()</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00040">OML_INT32_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00037">OML_LONG_VALUE</a>, <a class="el" href="oml__value_8h_source.html#l00060">oml_value_get_type</a>, <a class="el" href="oml__value_8h_source.html#l00051">oml_value_get_value</a>, <a class="el" href="oml__value_8c_source.html#l00081">oml_value_init()</a>, <a class="el" href="oml__value_8c_source.html#l00217">oml_value_reset()</a>, <a class="el" href="omlc_8h_source.html#l00252">omlc_get_int32</a>, <a class="el" href="omlc_8h_source.html#l00296">omlc_set_long</a>, <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>, <a class="el" href="marshal_8h_source.html#l00041">OmlBinaryHeader::type</a>, <a class="el" href="oml__value_8c_source.html#l00042">type</a>, <a class="el" href="marshal_8c_source.html#l00951">unmarshal_init()</a>, and <a class="el" href="marshal_8c_source.html#l01101">unmarshal_value()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span> VALUES_OFFSET = 7;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT32_LENGTH = 5;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT32_TYPE_OFFSET = 0;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT32_VALUE_OFFSET = 1;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT32_SIZE = <span class="keyword">sizeof</span> (uint32_t);</div>
<div class="line">  <span class="keywordtype">int</span> result;</div>
<div class="line">  <a class="code" href="structOmlValue.html">OmlValue</a> value;</div>
<div class="line"></div>
<div class="line">  <a class="code" href="oml__value_8c.html#aecf953b9ce05c582c030eec0e962c69c">oml_value_init</a>(&amp;value);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a66202b0ff17fc0381752edbfe6fef312">marshal_measurements</a> (mbuf, 42, 43, 42.0);</div>
<div class="line"></div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line"></div>
<div class="line">  VALUES_OFFSET = <a class="code" href="mbuf_8c.html#a60f8a8accde8c37e996b594310c59a26">mbuf_fill</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (long_values); i++) {</div>
<div class="line">    <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">    <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(v);</div>
<div class="line">    <a class="code" href="omlc_8h.html#a799e1ce72c79484ef5efe79bf5a408af">omlc_set_long</a>(v, long_values[i]);</div>
<div class="line">    <span class="keywordtype">int</span> result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a> (mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012a22fda4d714f29db7df49a3574986e67c">OML_LONG_VALUE</a>, &amp;v);</div>
<div class="line"></div>
<div class="line">    uint8_t* buf = &amp;mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>[VALUES_OFFSET + i * UINT32_LENGTH];</div>
<div class="line">    <span class="keywordtype">int</span> <a class="code" href="oml__value_8c.html#ae1087eeb503fb7b11a810d93605c97df">type</a> =  buf[UINT32_TYPE_OFFSET];</div>
<div class="line">    uint8_t* valptr = &amp;buf[UINT32_VALUE_OFFSET];</div>
<div class="line"></div>
<div class="line">    uint32_t nv = 0;</div>
<div class="line">    memcpy (&amp;nv, valptr, UINT32_SIZE);</div>
<div class="line">    uint32_t hv = ntohl (nv);</div>
<div class="line">    <span class="keywordtype">long</span> val = (int32_t)hv;</div>
<div class="line"></div>
<div class="line">    fail_if (result != 1);</div>
<div class="line">    fail_if (type != <a class="code" href="marshal_8c.html#a95f0d5df544261dab0fd0dcc5063de1f">LONG_T</a>); <span class="comment">// LONG_T</span></div>
<div class="line">    fail_if (val != oml_value_clamp_long (v.<a class="code" href="unionOmlValueU.html#a68b51dd2d189b56763fe42c44268e588">longValue</a>));</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <a class="code" href="marshal_8c.html#a0c0615d0abcd3673b56b0c7f68076895">marshal_finalize</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structOmlBinaryHeader.html">OmlBinaryHeader</a> <a class="code" href="check__libshared__headers_8c.html#a41d770ad2f3cb946006035f9e550deca">header</a>;</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a50099442a78fa10193ffa16aaf06c6ab">unmarshal_init</a> (mbuf, &amp;header);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line">  fail_unless (header.<a class="code" href="structOmlBinaryHeader.html#aa74b1de7e6a71da225764bd1dd417914">type</a> == <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (long_values); i++) {</div>
<div class="line">    <a class="code" href="marshal_8c.html#a000380a8534653b3027ec98e04e270c0">unmarshal_value</a> (mbuf, &amp;value);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Since OML_LONG_VALUE is deprecated, server now unmarshals it</span></div>
<div class="line"><span class="comment">     * to OML_INT32_VALUE; the marshalling process clamps the</span></div>
<div class="line"><span class="comment">     * OML_LONG_VALUE to an INT32 anyway.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    fail_unless (<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;value) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aab24deeb6fcd36f47779e12dca2c38b9">OML_INT32_VALUE</a>);</div>
<div class="line">    fail_unless (<a class="code" href="omlc_8h.html#a6314fe3dc202a16edcd064d8504a24d5">omlc_get_int32</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)) == oml_value_clamp_long(long_values[i]),</div>
<div class="line">        <span class="stringliteral">&quot;Unmarshalled value %ld, expected %ld\n&quot;</span>,</div>
<div class="line">        <a class="code" href="omlc_8h.html#a6314fe3dc202a16edcd064d8504a24d5">omlc_get_int32</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)), oml_value_clamp_long(long_values[i]));</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <a class="code" href="oml__value_8c.html#ad73bf2617858cdc9c70722e1ca91eea3">oml_value_reset</a>(&amp;value);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac9fc4ffdae099e3ff4163502b5f949f6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_unmarshal_int32&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00669">669</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="check__libshared__headers_8c_source.html#l00071">header</a>, <a class="el" href="marshal_8c_source.html#l00195">INT32_T</a>, <a class="el" href="omlc_8h_source.html#l00186">OmlValueU::int32Value</a>, <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="marshal_8c_source.html#l00897">marshal_finalize()</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00495">marshal_measurements()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00167">mbuf_fill()</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00040">OML_INT32_VALUE</a>, <a class="el" href="oml__value_8h_source.html#l00060">oml_value_get_type</a>, <a class="el" href="oml__value_8h_source.html#l00051">oml_value_get_value</a>, <a class="el" href="oml__value_8c_source.html#l00081">oml_value_init()</a>, <a class="el" href="oml__value_8c_source.html#l00217">oml_value_reset()</a>, <a class="el" href="omlc_8h_source.html#l00252">omlc_get_int32</a>, <a class="el" href="omlc_8h_source.html#l00281">omlc_set_int32</a>, <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>, <a class="el" href="marshal_8h_source.html#l00041">OmlBinaryHeader::type</a>, <a class="el" href="oml__value_8c_source.html#l00042">type</a>, <a class="el" href="marshal_8c_source.html#l00951">unmarshal_init()</a>, and <a class="el" href="marshal_8c_source.html#l01101">unmarshal_value()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span> VALUES_OFFSET = 7;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT32_LENGTH = 5;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT32_TYPE_OFFSET = 0;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT32_VALUE_OFFSET = 1;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT32_SIZE = <span class="keyword">sizeof</span> (uint32_t);</div>
<div class="line">  <span class="keywordtype">int</span> result;</div>
<div class="line">  <a class="code" href="structOmlValue.html">OmlValue</a> value;</div>
<div class="line"></div>
<div class="line">  <a class="code" href="oml__value_8c.html#aecf953b9ce05c582c030eec0e962c69c">oml_value_init</a>(&amp;value);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a66202b0ff17fc0381752edbfe6fef312">marshal_measurements</a> (mbuf, 42, 43, 42.0);</div>
<div class="line"></div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line"></div>
<div class="line">  VALUES_OFFSET = <a class="code" href="mbuf_8c.html#a60f8a8accde8c37e996b594310c59a26">mbuf_fill</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (int32_values); i++) {</div>
<div class="line">    <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">    <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(v);</div>
<div class="line">    <a class="code" href="omlc_8h.html#aa8a1827db1559f247bf8a4023e466873">omlc_set_int32</a>(v, int32_values[i]);</div>
<div class="line">    <span class="keywordtype">int</span> result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a> (mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aab24deeb6fcd36f47779e12dca2c38b9">OML_INT32_VALUE</a>, &amp;v);</div>
<div class="line"></div>
<div class="line">    uint8_t* buf = &amp;mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>[VALUES_OFFSET + i * UINT32_LENGTH];</div>
<div class="line">    <span class="keywordtype">int</span> <a class="code" href="oml__value_8c.html#ae1087eeb503fb7b11a810d93605c97df">type</a> =  buf[UINT32_TYPE_OFFSET];</div>
<div class="line">    uint8_t* valptr = &amp;buf[UINT32_VALUE_OFFSET];</div>
<div class="line"></div>
<div class="line">    uint32_t nv = 0;</div>
<div class="line">    memcpy (&amp;nv, valptr, UINT32_SIZE);</div>
<div class="line">    uint32_t hv = ntohl (nv);</div>
<div class="line">    int32_t val = (int32_t)hv;</div>
<div class="line"></div>
<div class="line">    fail_if (result != 1);</div>
<div class="line">    fail_if (type != <a class="code" href="marshal_8c.html#a2251891f2e0a2db27ca4c6507d3f4040">INT32_T</a>); <span class="comment">// INT32_T</span></div>
<div class="line">    fail_if (val != v.<a class="code" href="unionOmlValueU.html#afb7c5ec7f57fa2a4c48f77fa978517a0">int32Value</a>);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <a class="code" href="marshal_8c.html#a0c0615d0abcd3673b56b0c7f68076895">marshal_finalize</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structOmlBinaryHeader.html">OmlBinaryHeader</a> <a class="code" href="check__libshared__headers_8c.html#a41d770ad2f3cb946006035f9e550deca">header</a>;</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a50099442a78fa10193ffa16aaf06c6ab">unmarshal_init</a> (mbuf, &amp;header);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line"></div>
<div class="line">  fail_unless (header.<a class="code" href="structOmlBinaryHeader.html#aa74b1de7e6a71da225764bd1dd417914">type</a> == <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (int32_values); i++) {</div>
<div class="line">    <a class="code" href="marshal_8c.html#a000380a8534653b3027ec98e04e270c0">unmarshal_value</a> (mbuf, &amp;value);</div>
<div class="line"></div>
<div class="line">    fail_unless (<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;value) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aab24deeb6fcd36f47779e12dca2c38b9">OML_INT32_VALUE</a>);</div>
<div class="line">    fail_unless (<a class="code" href="omlc_8h.html#a6314fe3dc202a16edcd064d8504a24d5">omlc_get_int32</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)) == int32_values[i],</div>
<div class="line">        <span class="stringliteral">&quot;Unmarshalled value %ld, expected %ld\n&quot;</span>,</div>
<div class="line">        <a class="code" href="omlc_8h.html#a6314fe3dc202a16edcd064d8504a24d5">omlc_get_int32</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)), int32_values[i]);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <a class="code" href="oml__value_8c.html#ad73bf2617858cdc9c70722e1ca91eea3">oml_value_reset</a>(&amp;value);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acc34a8566b9501a3ec815ef55cdcb5d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_unmarshal_uint32&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00732">732</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="check__libshared__headers_8c_source.html#l00071">header</a>, <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="marshal_8c_source.html#l00897">marshal_finalize()</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00495">marshal_measurements()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00167">mbuf_fill()</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00041">OML_UINT32_VALUE</a>, <a class="el" href="oml__value_8h_source.html#l00060">oml_value_get_type</a>, <a class="el" href="oml__value_8h_source.html#l00051">oml_value_get_value</a>, <a class="el" href="oml__value_8c_source.html#l00081">oml_value_init()</a>, <a class="el" href="oml__value_8c_source.html#l00217">oml_value_reset()</a>, <a class="el" href="omlc_8h_source.html#l00255">omlc_get_uint32</a>, <a class="el" href="omlc_8h_source.html#l00284">omlc_set_uint32</a>, <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>, <a class="el" href="marshal_8h_source.html#l00041">OmlBinaryHeader::type</a>, <a class="el" href="oml__value_8c_source.html#l00042">type</a>, <a class="el" href="marshal_8c_source.html#l00197">UINT32_T</a>, <a class="el" href="omlc_8h_source.html#l00187">OmlValueU::uint32Value</a>, <a class="el" href="marshal_8c_source.html#l00951">unmarshal_init()</a>, and <a class="el" href="marshal_8c_source.html#l01101">unmarshal_value()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span> VALUES_OFFSET = 7;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT32_LENGTH = 5;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT32_TYPE_OFFSET = 0;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT32_VALUE_OFFSET = 1;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT32_SIZE = <span class="keyword">sizeof</span> (uint32_t);</div>
<div class="line">  <span class="keywordtype">int</span> result;</div>
<div class="line">  <a class="code" href="structOmlValue.html">OmlValue</a> value;</div>
<div class="line"></div>
<div class="line">  <a class="code" href="oml__value_8c.html#aecf953b9ce05c582c030eec0e962c69c">oml_value_init</a>(&amp;value);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a66202b0ff17fc0381752edbfe6fef312">marshal_measurements</a> (mbuf, 42, 43, 42.0);</div>
<div class="line"></div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line"></div>
<div class="line">  VALUES_OFFSET = <a class="code" href="mbuf_8c.html#a60f8a8accde8c37e996b594310c59a26">mbuf_fill</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (int32_values); i++) {</div>
<div class="line">    <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">    <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(v);</div>
<div class="line">    <a class="code" href="omlc_8h.html#a1e481b1b79bdf517a3507ce8113169b2">omlc_set_uint32</a>(v, (uint32_t)int32_values[i]);</div>
<div class="line">    <span class="keywordtype">int</span> result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a> (mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aad8721fa7d76e62c5885222061fa7827">OML_UINT32_VALUE</a>, &amp;v);</div>
<div class="line"></div>
<div class="line">    uint8_t* buf = &amp;mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>[VALUES_OFFSET + i * UINT32_LENGTH];</div>
<div class="line">    <span class="keywordtype">int</span> <a class="code" href="oml__value_8c.html#ae1087eeb503fb7b11a810d93605c97df">type</a> =  buf[UINT32_TYPE_OFFSET];</div>
<div class="line">    uint8_t* valptr = &amp;buf[UINT32_VALUE_OFFSET];</div>
<div class="line"></div>
<div class="line">    uint32_t nv = 0;</div>
<div class="line">    memcpy (&amp;nv, valptr, UINT32_SIZE);</div>
<div class="line">    uint32_t hv = ntohl (nv);</div>
<div class="line">    uint32_t val = (uint32_t)hv;</div>
<div class="line"></div>
<div class="line">    fail_if (result != 1);</div>
<div class="line">    fail_if (type != <a class="code" href="marshal_8c.html#a6bcb89102f0baaa6be3d8d140b2dc866">UINT32_T</a>); <span class="comment">// UINT32_T</span></div>
<div class="line">    fail_if (val != v.<a class="code" href="unionOmlValueU.html#a7a2c76d60700d46a56dde5f398c73000">uint32Value</a>);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <a class="code" href="marshal_8c.html#a0c0615d0abcd3673b56b0c7f68076895">marshal_finalize</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structOmlBinaryHeader.html">OmlBinaryHeader</a> <a class="code" href="check__libshared__headers_8c.html#a41d770ad2f3cb946006035f9e550deca">header</a>;</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a50099442a78fa10193ffa16aaf06c6ab">unmarshal_init</a> (mbuf, &amp;header);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line">  fail_unless (header.<a class="code" href="structOmlBinaryHeader.html#aa74b1de7e6a71da225764bd1dd417914">type</a> == <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (int32_values); i++) {</div>
<div class="line">    <a class="code" href="marshal_8c.html#a000380a8534653b3027ec98e04e270c0">unmarshal_value</a> (mbuf, &amp;value);</div>
<div class="line"></div>
<div class="line">    fail_unless (<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;value) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aad8721fa7d76e62c5885222061fa7827">OML_UINT32_VALUE</a>);</div>
<div class="line">    fail_unless (<a class="code" href="omlc_8h.html#a1493babcfc9c69f6aa7efebf049c7a22">omlc_get_uint32</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)) == (uint32_t)int32_values[i],</div>
<div class="line">        <span class="stringliteral">&quot;Unmarshalled value %ld, expected %ld\n&quot;</span>,</div>
<div class="line">        <a class="code" href="omlc_8h.html#a1493babcfc9c69f6aa7efebf049c7a22">omlc_get_uint32</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)), (uint32_t)int32_values[i]);</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="oml__value_8c.html#ad73bf2617858cdc9c70722e1ca91eea3">oml_value_reset</a>(&amp;value);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7d7c3661f186fa20ef69b4e295b5b142"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_unmarshal_int64&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00793">793</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="check__libshared__headers_8c_source.html#l00071">header</a>, <a class="el" href="marshal_8c_source.html#l00199">INT64_T</a>, <a class="el" href="omlc_8h_source.html#l00188">OmlValueU::int64Value</a>, <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="marshal_8c_source.html#l00897">marshal_finalize()</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00495">marshal_measurements()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00167">mbuf_fill()</a>, <a class="el" href="htonll_8h_source.html#l00038">ntohll</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00042">OML_INT64_VALUE</a>, <a class="el" href="oml__value_8h_source.html#l00060">oml_value_get_type</a>, <a class="el" href="oml__value_8h_source.html#l00051">oml_value_get_value</a>, <a class="el" href="oml__value_8c_source.html#l00081">oml_value_init()</a>, <a class="el" href="omlc_8h_source.html#l00258">omlc_get_int64</a>, <a class="el" href="omlc_8h_source.html#l00287">omlc_set_int64</a>, <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>, <a class="el" href="marshal_8h_source.html#l00041">OmlBinaryHeader::type</a>, <a class="el" href="oml__value_8c_source.html#l00042">type</a>, <a class="el" href="marshal_8c_source.html#l00951">unmarshal_init()</a>, and <a class="el" href="marshal_8c_source.html#l01101">unmarshal_value()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span> VALUES_OFFSET = 7;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT64_LENGTH = 9;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT64_TYPE_OFFSET = 0;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT64_VALUE_OFFSET = 1;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT64_SIZE = <span class="keyword">sizeof</span> (uint64_t);</div>
<div class="line">  <span class="keywordtype">int</span> result;</div>
<div class="line">  <a class="code" href="structOmlValue.html">OmlValue</a> value;</div>
<div class="line"></div>
<div class="line">  <a class="code" href="oml__value_8c.html#aecf953b9ce05c582c030eec0e962c69c">oml_value_init</a>(&amp;value);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a66202b0ff17fc0381752edbfe6fef312">marshal_measurements</a> (mbuf, 42, 43, 42.0);</div>
<div class="line"></div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line"></div>
<div class="line">  VALUES_OFFSET = <a class="code" href="mbuf_8c.html#a60f8a8accde8c37e996b594310c59a26">mbuf_fill</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (int64_values); i++) {</div>
<div class="line">    <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">    <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(v);</div>
<div class="line">    <a class="code" href="omlc_8h.html#ae05c1e9d59d47fac7ce71b2136533958">omlc_set_int64</a>(v, int64_values[i]);</div>
<div class="line">    <span class="keywordtype">int</span> result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a> (mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012af4f2a3a1e0887652fb41bab6b6bb96ee">OML_INT64_VALUE</a>, &amp;v);</div>
<div class="line"></div>
<div class="line">    uint8_t* buf = &amp;mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>[VALUES_OFFSET + i * UINT64_LENGTH];</div>
<div class="line">    <span class="keywordtype">int</span> <a class="code" href="oml__value_8c.html#ae1087eeb503fb7b11a810d93605c97df">type</a> =  buf[UINT64_TYPE_OFFSET];</div>
<div class="line">    uint8_t* valptr = &amp;buf[UINT64_VALUE_OFFSET];</div>
<div class="line"></div>
<div class="line">    uint64_t nv = 0;</div>
<div class="line">    memcpy (&amp;nv, valptr, UINT64_SIZE);</div>
<div class="line">    uint64_t hv = <a class="code" href="htonll_8h.html#a47f5c12368dfdf98a92bb0a8175c006f">ntohll</a> (nv);</div>
<div class="line">    int64_t val = (int64_t)hv;</div>
<div class="line"></div>
<div class="line">    fail_if (result != 1);</div>
<div class="line">    fail_if (type != <a class="code" href="marshal_8c.html#afb3891492b67fa5ded53824df675ae9b">INT64_T</a>); <span class="comment">// INT64_T</span></div>
<div class="line">    fail_if (val != v.<a class="code" href="unionOmlValueU.html#a84566cbb0dd798989bacca5c2ba8dd81">int64Value</a>);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <a class="code" href="marshal_8c.html#a0c0615d0abcd3673b56b0c7f68076895">marshal_finalize</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structOmlBinaryHeader.html">OmlBinaryHeader</a> <a class="code" href="check__libshared__headers_8c.html#a41d770ad2f3cb946006035f9e550deca">header</a>;</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a50099442a78fa10193ffa16aaf06c6ab">unmarshal_init</a> (mbuf, &amp;header);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line">  fail_unless (header.<a class="code" href="structOmlBinaryHeader.html#aa74b1de7e6a71da225764bd1dd417914">type</a> == <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (int64_values); i++) {</div>
<div class="line">    <a class="code" href="marshal_8c.html#a000380a8534653b3027ec98e04e270c0">unmarshal_value</a> (mbuf, &amp;value);</div>
<div class="line"></div>
<div class="line">    fail_unless (<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;value) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012af4f2a3a1e0887652fb41bab6b6bb96ee">OML_INT64_VALUE</a>);</div>
<div class="line">    fail_unless (<a class="code" href="omlc_8h.html#aeb1480723c7d9b86609a6dea4440a52d">omlc_get_int64</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)) == int64_values[i],</div>
<div class="line">        <span class="stringliteral">&quot;Unmarshalled value %ld, expected %ld\n&quot;</span>,</div>
<div class="line">        <a class="code" href="omlc_8h.html#aeb1480723c7d9b86609a6dea4440a52d">omlc_get_int64</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)), int64_values[i]);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a16fdf784ef43ee02d7d89fa9f2ef60a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_unmarshal_uint64&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00853">853</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="check__libshared__headers_8c_source.html#l00071">header</a>, <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="marshal_8c_source.html#l00897">marshal_finalize()</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00495">marshal_measurements()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00167">mbuf_fill()</a>, <a class="el" href="htonll_8h_source.html#l00038">ntohll</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00043">OML_UINT64_VALUE</a>, <a class="el" href="oml__value_8h_source.html#l00060">oml_value_get_type</a>, <a class="el" href="oml__value_8h_source.html#l00051">oml_value_get_value</a>, <a class="el" href="oml__value_8c_source.html#l00081">oml_value_init()</a>, <a class="el" href="oml__value_8c_source.html#l00217">oml_value_reset()</a>, <a class="el" href="omlc_8h_source.html#l00261">omlc_get_uint64</a>, <a class="el" href="omlc_8h_source.html#l00290">omlc_set_uint64</a>, <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>, <a class="el" href="marshal_8h_source.html#l00041">OmlBinaryHeader::type</a>, <a class="el" href="oml__value_8c_source.html#l00042">type</a>, <a class="el" href="marshal_8c_source.html#l00201">UINT64_T</a>, <a class="el" href="omlc_8h_source.html#l00189">OmlValueU::uint64Value</a>, <a class="el" href="marshal_8c_source.html#l00951">unmarshal_init()</a>, and <a class="el" href="marshal_8c_source.html#l01101">unmarshal_value()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span> VALUES_OFFSET = 7;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT64_LENGTH = 9;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT64_TYPE_OFFSET = 0;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT64_VALUE_OFFSET = 1;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> UINT64_SIZE = <span class="keyword">sizeof</span> (uint64_t);</div>
<div class="line">  <span class="keywordtype">int</span> result;</div>
<div class="line">  <a class="code" href="structOmlValue.html">OmlValue</a> value;</div>
<div class="line"></div>
<div class="line">  <a class="code" href="oml__value_8c.html#aecf953b9ce05c582c030eec0e962c69c">oml_value_init</a>(&amp;value);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a66202b0ff17fc0381752edbfe6fef312">marshal_measurements</a> (mbuf, 42, 43, 42.0);</div>
<div class="line"></div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line"></div>
<div class="line">  VALUES_OFFSET = <a class="code" href="mbuf_8c.html#a60f8a8accde8c37e996b594310c59a26">mbuf_fill</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (int64_values); i++) {</div>
<div class="line">    <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">    <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(v);</div>
<div class="line">    <a class="code" href="omlc_8h.html#a873792518d05507bf5d0b1a96524b091">omlc_set_uint64</a>(v, (uint64_t)int64_values[i]);</div>
<div class="line">    <span class="keywordtype">int</span> result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a> (mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aa0ecc1e475955c44a641c75e841ca2fc">OML_UINT64_VALUE</a>, &amp;v);</div>
<div class="line"></div>
<div class="line">    uint8_t* buf = &amp;mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>[VALUES_OFFSET + i * UINT64_LENGTH];</div>
<div class="line">    <span class="keywordtype">int</span> <a class="code" href="oml__value_8c.html#ae1087eeb503fb7b11a810d93605c97df">type</a> =  buf[UINT64_TYPE_OFFSET];</div>
<div class="line">    uint8_t* valptr = &amp;buf[UINT64_VALUE_OFFSET];</div>
<div class="line"></div>
<div class="line">    uint64_t nv = 0;</div>
<div class="line">    memcpy (&amp;nv, valptr, UINT64_SIZE);</div>
<div class="line">    uint64_t hv = <a class="code" href="htonll_8h.html#a47f5c12368dfdf98a92bb0a8175c006f">ntohll</a> (nv);</div>
<div class="line">    uint64_t val = (uint64_t)hv;</div>
<div class="line"></div>
<div class="line">    fail_if (result != 1);</div>
<div class="line">    fail_if (type != <a class="code" href="marshal_8c.html#a8065a16ba5bd6bb2bd861936a87b31c3">UINT64_T</a>); <span class="comment">// UINT64_T</span></div>
<div class="line">    fail_if (val != v.<a class="code" href="unionOmlValueU.html#a27ebbc99be2387d2b263062333563abd">uint64Value</a>);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <a class="code" href="marshal_8c.html#a0c0615d0abcd3673b56b0c7f68076895">marshal_finalize</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structOmlBinaryHeader.html">OmlBinaryHeader</a> <a class="code" href="check__libshared__headers_8c.html#a41d770ad2f3cb946006035f9e550deca">header</a>;</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a50099442a78fa10193ffa16aaf06c6ab">unmarshal_init</a> (mbuf, &amp;header);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line">  fail_unless (header.<a class="code" href="structOmlBinaryHeader.html#aa74b1de7e6a71da225764bd1dd417914">type</a> == <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (int64_values); i++) {</div>
<div class="line">    <a class="code" href="marshal_8c.html#a000380a8534653b3027ec98e04e270c0">unmarshal_value</a> (mbuf, &amp;value);</div>
<div class="line"></div>
<div class="line">    fail_unless (<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;value) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aa0ecc1e475955c44a641c75e841ca2fc">OML_UINT64_VALUE</a>);</div>
<div class="line">    fail_unless (<a class="code" href="omlc_8h.html#a37958a949ce7353bd25dee96810e2cd6">omlc_get_uint64</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)) == (uint64_t)int64_values[i],</div>
<div class="line">        <span class="stringliteral">&quot;Unmarshalled value %ld, expected %ld\n&quot;</span>,</div>
<div class="line">        <a class="code" href="omlc_8h.html#a37958a949ce7353bd25dee96810e2cd6">omlc_get_uint64</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)), (uint64_t)int64_values[i]);</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="oml__value_8c.html#ad73bf2617858cdc9c70722e1ca91eea3">oml_value_reset</a>(&amp;value);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a803940ece31831641f15ed4f81429698"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_unmarshal_double&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00914">914</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="marshal_8c_source.html#l00191">DOUBLE_NAN</a>, <a class="el" href="marshal_8c_source.html#l00189">DOUBLE_T</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l00043">EPSILON</a>, <a class="el" href="check__text__protocol_8c_source.html#l00139">exp</a>, <a class="el" href="check__libshared__headers_8c_source.html#l00071">header</a>, <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="marshal_8c_source.html#l00897">marshal_finalize()</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00495">marshal_measurements()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00167">mbuf_fill()</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00036">OML_DOUBLE_VALUE</a>, <a class="el" href="oml__value_8h_source.html#l00060">oml_value_get_type</a>, <a class="el" href="oml__value_8h_source.html#l00051">oml_value_get_value</a>, <a class="el" href="oml__value_8c_source.html#l00081">oml_value_init()</a>, <a class="el" href="oml__value_8c_source.html#l00217">oml_value_reset()</a>, <a class="el" href="omlc_8h_source.html#l00264">omlc_get_double</a>, <a class="el" href="omlc_8h_source.html#l00293">omlc_set_double</a>, <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l00324">relative_error()</a>, <a class="el" href="marshal_8h_source.html#l00045">OmlBinaryHeader::seqno</a>, <a class="el" href="marshal_8h_source.html#l00044">OmlBinaryHeader::stream</a>, <a class="el" href="marshal_8h_source.html#l00041">OmlBinaryHeader::type</a>, <a class="el" href="oml__value_8c_source.html#l00042">type</a>, <a class="el" href="marshal_8c_source.html#l00951">unmarshal_init()</a>, and <a class="el" href="marshal_8c_source.html#l01101">unmarshal_value()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span> VALUES_OFFSET = 7;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> DOUBLE_LENGTH = 6;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> DOUBLE_TYPE_OFFSET = 0;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> DOUBLE_MANT_OFFSET = 1;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> DOUBLE_EXP_OFFSET = 5;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> DOUBLE_MANT_SIZE = <span class="keyword">sizeof</span> (int32_t);</div>
<div class="line">  <span class="keywordtype">int</span> result;</div>
<div class="line">  <a class="code" href="structOmlValue.html">OmlValue</a> value;</div>
<div class="line"></div>
<div class="line">  <a class="code" href="oml__value_8c.html#aecf953b9ce05c582c030eec0e962c69c">oml_value_init</a>(&amp;value);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a66202b0ff17fc0381752edbfe6fef312">marshal_measurements</a> (mbuf, 98, 99, 100.0);</div>
<div class="line"></div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line"></div>
<div class="line">  VALUES_OFFSET = <a class="code" href="mbuf_8c.html#a60f8a8accde8c37e996b594310c59a26">mbuf_fill</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (double_values); i++) {</div>
<div class="line">    <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">    <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(v);</div>
<div class="line">    <a class="code" href="omlc_8h.html#a6a342646d654733d01aff00bf9a308da">omlc_set_double</a>(v, double_values[i]);</div>
<div class="line">    result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a> (mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012adf6df4b257026d03f661cfb85dc7d1c3">OML_DOUBLE_VALUE</a>, &amp;v);</div>
<div class="line"></div>
<div class="line">    uint8_t* buf = &amp;mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>[VALUES_OFFSET + i * DOUBLE_LENGTH];</div>
<div class="line">    <span class="keywordtype">int</span> <a class="code" href="oml__value_8c.html#ae1087eeb503fb7b11a810d93605c97df">type</a> =  buf[DOUBLE_TYPE_OFFSET];</div>
<div class="line">    uint8_t* mantptr = &amp;buf[DOUBLE_MANT_OFFSET];</div>
<div class="line">    uint8_t* expptr = &amp;buf[DOUBLE_EXP_OFFSET];</div>
<div class="line"></div>
<div class="line">    uint32_t nv = 0;</div>
<div class="line">    memcpy (&amp;nv, mantptr, DOUBLE_MANT_SIZE);</div>
<div class="line">    uint32_t hv = ntohl (nv);</div>
<div class="line">    int32_t mant = (int32_t)hv;</div>
<div class="line">    int8_t <a class="code" href="check__text__protocol_8c.html#afc541abe000a672ebe850f1448b25306">exp</a> = *((int8_t*)expptr);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> val = ldexp (mant * 1.0 / (1 &lt;&lt; 30), exp);</div>
<div class="line"></div>
<div class="line">    fail_if (result != 1);</div>
<div class="line">    <span class="keywordflow">if</span> (isnan(double_values[i])) {</div>
<div class="line">      fail_if (type != <a class="code" href="marshal_8c.html#a05c4e15b9701b28975effde191bc9bf6">DOUBLE_NAN</a>, <span class="stringliteral">&quot;Type == %d&quot;</span>, type); <span class="comment">// DOUBLE_NAN</span></div>
<div class="line">      <span class="comment">/* NaN is actually encoded as 0., but only the type, DOUBLE_NAN, matters for unmarshalling */</span></div>
<div class="line">      fail_unless (-<a class="code" href="check__libshared__marshal_8c.html#a002b2f4894492820fe708b1b7e7c5e70">EPSILON</a> &lt;= val &amp;&amp; val &lt;= <a class="code" href="check__libshared__marshal_8c.html#a002b2f4894492820fe708b1b7e7c5e70">EPSILON</a>,</div>
<div class="line">          <span class="stringliteral">&quot;Unmarshalled %g, expected %g\n&quot;</span>,</div>
<div class="line">          val, 0);</div>
<div class="line"></div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      fail_if (type != <a class="code" href="marshal_8c.html#a9290324f1f88b0f007de36d523d8cf3a">DOUBLE_T</a>, <span class="stringliteral">&quot;Type == %d&quot;</span>, type); <span class="comment">// DOUBLE_T</span></div>
<div class="line">      fail_if (fabs((val - <a class="code" href="omlc_8h.html#adb34b291e3acb9b9a52c544c34c6568c">omlc_get_double</a>(v))/<a class="code" href="omlc_8h.html#adb34b291e3acb9b9a52c544c34c6568c">omlc_get_double</a>(v)) &gt;= <a class="code" href="check__libshared__marshal_8c.html#a002b2f4894492820fe708b1b7e7c5e70">EPSILON</a>,</div>
<div class="line">          <span class="stringliteral">&quot;Unmarshalled %g, expected %g\n&quot;</span>,</div>
<div class="line">          val, <a class="code" href="omlc_8h.html#adb34b291e3acb9b9a52c544c34c6568c">omlc_get_double</a>(v));</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <a class="code" href="marshal_8c.html#a0c0615d0abcd3673b56b0c7f68076895">marshal_finalize</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structOmlBinaryHeader.html">OmlBinaryHeader</a> <a class="code" href="check__libshared__headers_8c.html#a41d770ad2f3cb946006035f9e550deca">header</a>;</div>
<div class="line">  <a class="code" href="marshal_8c.html#a50099442a78fa10193ffa16aaf06c6ab">unmarshal_init</a>(mbuf, &amp;header);</div>
<div class="line">  fail_unless(header.<a class="code" href="structOmlBinaryHeader.html#aa74b1de7e6a71da225764bd1dd417914">type</a> == <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  fail_unless(header.<a class="code" href="structOmlBinaryHeader.html#a7307c8a8c7e51271dcac40fb068d5bc4">stream</a> == 98);</div>
<div class="line">  fail_unless(header.<a class="code" href="structOmlBinaryHeader.html#afbd06e85da03463c78d51f06c97a384d">seqno</a> == 99);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (double_values); i++) {</div>
<div class="line">    <a class="code" href="marshal_8c.html#a000380a8534653b3027ec98e04e270c0">unmarshal_value</a> (mbuf, &amp;value);</div>
<div class="line"></div>
<div class="line">    fail_unless (<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;value) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012adf6df4b257026d03f661cfb85dc7d1c3">OML_DOUBLE_VALUE</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (isnan(double_values[i])) {</div>
<div class="line">      fail_unless (isnan(<a class="code" href="omlc_8h.html#adb34b291e3acb9b9a52c544c34c6568c">omlc_get_double</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value))),</div>
<div class="line">          <span class="stringliteral">&quot;Unmarshalled value %g, expected %g\n&quot;</span>,</div>
<div class="line">          <a class="code" href="omlc_8h.html#adb34b291e3acb9b9a52c544c34c6568c">omlc_get_double</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)), double_values[i]);</div>
<div class="line"></div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      fail_unless (<a class="code" href="check__libshared__marshal_8c.html#a14cae643cddb7b34662a96e71017deb7">relative_error</a> (<a class="code" href="omlc_8h.html#adb34b291e3acb9b9a52c544c34c6568c">omlc_get_double</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)), double_values[i]) &lt; <a class="code" href="check__libshared__marshal_8c.html#a002b2f4894492820fe708b1b7e7c5e70">EPSILON</a>,</div>
<div class="line">          <span class="stringliteral">&quot;Unmarshalled value %g, expected %g\n&quot;</span>,</div>
<div class="line">          <a class="code" href="omlc_8h.html#adb34b291e3acb9b9a52c544c34c6568c">omlc_get_double</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)), double_values[i]);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="oml__value_8c.html#ad73bf2617858cdc9c70722e1ca91eea3">oml_value_reset</a>(&amp;value);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a85b9ed30111d475095014efb50739652"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_unmarshal_string&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00999">999</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="check__libshared__headers_8c_source.html#l00071">header</a>, <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="marshal_8c_source.html#l00897">marshal_finalize()</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00495">marshal_measurements()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l00045">MAX_MARSHALLED_STRING_LENGTH</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00167">mbuf_fill()</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00039">OML_STRING_VALUE</a>, <a class="el" href="oml__value_8h_source.html#l00060">oml_value_get_type</a>, <a class="el" href="oml__value_8h_source.html#l00051">oml_value_get_value</a>, <a class="el" href="oml__value_8c_source.html#l00081">oml_value_init()</a>, <a class="el" href="oml__value_8c_source.html#l00217">oml_value_reset()</a>, <a class="el" href="omlc_8h_source.html#l00344">omlc_get_string_length</a>, <a class="el" href="omlc_8h_source.html#l00340">omlc_get_string_ptr</a>, <a class="el" href="omlc_8h_source.html#l00457">omlc_reset_string</a>, <a class="el" href="omlc_8h_source.html#l00505">omlc_set_string</a>, <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>, <a class="el" href="marshal_8c_source.html#l00193">STRING_T</a>, <a class="el" href="marshal_8h_source.html#l00041">OmlBinaryHeader::type</a>, <a class="el" href="oml__value_8c_source.html#l00042">type</a>, <a class="el" href="marshal_8c_source.html#l00951">unmarshal_init()</a>, and <a class="el" href="marshal_8c_source.html#l01101">unmarshal_value()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span> VALUES_OFFSET = 7;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> STRING_TYPE_OFFSET = 0;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> STRING_LENGTH_OFFSET = 1;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> STRING_VALUE_OFFSET = 2;</div>
<div class="line">  <span class="keywordtype">int</span> result;</div>
<div class="line">  <span class="keywordtype">char</span> <span class="keywordtype">string</span>[<a class="code" href="check__libshared__marshal_8c.html#a8eb978c63d7c9fe86a9544bdf8d54fe6">MAX_MARSHALLED_STRING_LENGTH</a> + 16];</div>
<div class="line">  <a class="code" href="structOmlValue.html">OmlValue</a> value;</div>
<div class="line"></div>
<div class="line">  <a class="code" href="oml__value_8c.html#aecf953b9ce05c582c030eec0e962c69c">oml_value_init</a>(&amp;value);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a66202b0ff17fc0381752edbfe6fef312">marshal_measurements</a> (mbuf, 42, 43, 42.0);</div>
<div class="line"></div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line"></div>
<div class="line">  VALUES_OFFSET = <a class="code" href="mbuf_8c.html#a60f8a8accde8c37e996b594310c59a26">mbuf_fill</a> (mbuf);</div>
<div class="line">  <span class="keywordtype">int</span> current_index = VALUES_OFFSET;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (string_values); i++) {</div>
<div class="line">    memset (<span class="keywordtype">string</span>, 0, <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(<span class="keywordtype">string</span>));</div>
<div class="line">    <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">    <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(v);</div>
<div class="line">    <a class="code" href="omlc_8h.html#a13be9537ef85ccdc463a6172d4716d3a">omlc_set_string</a>(v, string_values[i]);</div>
<div class="line"></div>
<div class="line">    result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a> (mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012a42b33eb7c21f79727a894a530a05b559">OML_STRING_VALUE</a>, &amp;v);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="omlc_8h.html#a1434bd8b5a841357336609930bdb05c3">omlc_reset_string</a>(v);</div>
<div class="line"></div>
<div class="line">    uint8_t* buf = &amp;mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>[current_index];</div>
<div class="line">    <span class="keywordtype">int</span> <a class="code" href="oml__value_8c.html#ae1087eeb503fb7b11a810d93605c97df">type</a> =  buf[STRING_TYPE_OFFSET];</div>
<div class="line">    uint8_t* lenptr = &amp;buf[STRING_LENGTH_OFFSET];</div>
<div class="line">    uint8_t* valptr = &amp;buf[STRING_VALUE_OFFSET];</div>
<div class="line">    <span class="keywordtype">size_t</span> len = *lenptr;</div>
<div class="line"></div>
<div class="line">    memcpy (<span class="keywordtype">string</span>, valptr, len);</div>
<div class="line"></div>
<div class="line">    fail_if (result != 1);</div>
<div class="line">    fail_if (type != <a class="code" href="marshal_8c.html#a64b41f937ac6a39ee0c32adecfa606dd">STRING_T</a>); <span class="comment">// STRING_T</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (strlen (string_values[i]) &lt;= <a class="code" href="check__libshared__marshal_8c.html#a8eb978c63d7c9fe86a9544bdf8d54fe6">MAX_MARSHALLED_STRING_LENGTH</a>) {</div>
<div class="line">      fail_if (len != strlen (string_values[i]));</div>
<div class="line">      fail_if (strcmp (<span class="keywordtype">string</span>, string_values[i]) != 0,</div>
<div class="line">          <span class="stringliteral">&quot;Expected string:\n%s\nActual string:\n%s\n&quot;</span>,</div>
<div class="line">          string_values[i],</div>
<div class="line">          <span class="keywordtype">string</span>);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      fail_if (len != <a class="code" href="check__libshared__marshal_8c.html#a8eb978c63d7c9fe86a9544bdf8d54fe6">MAX_MARSHALLED_STRING_LENGTH</a>);</div>
<div class="line">      fail_if (strlen (<span class="keywordtype">string</span>) != len);</div>
<div class="line">      fail_if (strncmp (<span class="keywordtype">string</span>, string_values[i], <a class="code" href="check__libshared__marshal_8c.html#a8eb978c63d7c9fe86a9544bdf8d54fe6">MAX_MARSHALLED_STRING_LENGTH</a>) != 0);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    current_index += len + 2;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <a class="code" href="marshal_8c.html#a0c0615d0abcd3673b56b0c7f68076895">marshal_finalize</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structOmlBinaryHeader.html">OmlBinaryHeader</a> <a class="code" href="check__libshared__headers_8c.html#a41d770ad2f3cb946006035f9e550deca">header</a>;</div>
<div class="line">  <a class="code" href="marshal_8c.html#a50099442a78fa10193ffa16aaf06c6ab">unmarshal_init</a> (mbuf, &amp;header);</div>
<div class="line">  fail_unless (header.<a class="code" href="structOmlBinaryHeader.html#aa74b1de7e6a71da225764bd1dd417914">type</a> == <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (string_values); i++) {</div>
<div class="line">    <a class="code" href="marshal_8c.html#a000380a8534653b3027ec98e04e270c0">unmarshal_value</a> (mbuf, &amp;value);</div>
<div class="line"></div>
<div class="line">    fail_unless (<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;value) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012a42b33eb7c21f79727a894a530a05b559">OML_STRING_VALUE</a>);</div>
<div class="line">    fail_if (<a class="code" href="omlc_8h.html#ae5077b9404ef5c4c2f66a1a654430512">omlc_get_string_ptr</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)) == NULL);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span> original_length = strlen (string_values[i]);</div>
<div class="line">    <span class="keywordtype">int</span> len = <a class="code" href="omlc_8h.html#ac67055f6576df153bd9915dd7ccb2f6d">omlc_get_string_length</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value));</div>
<div class="line">    <span class="keywordflow">if</span> (original_length &lt;= <a class="code" href="check__libshared__marshal_8c.html#a8eb978c63d7c9fe86a9544bdf8d54fe6">MAX_MARSHALLED_STRING_LENGTH</a>) {</div>
<div class="line">      fail_unless (len == original_length, <span class="stringliteral">&quot;Expected length %d, unmarshalled length %d\n&quot;</span>, original_length, len);</div>
<div class="line">      fail_unless (strcmp (<a class="code" href="omlc_8h.html#ae5077b9404ef5c4c2f66a1a654430512">omlc_get_string_ptr</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)), string_values[i]) == 0,</div>
<div class="line">          <span class="stringliteral">&quot;Expected string: &#39;%s&#39;, Unmarshalled string:&#39;%s&#39;\n&quot;</span>,</div>
<div class="line">          <a class="code" href="omlc_8h.html#ae5077b9404ef5c4c2f66a1a654430512">omlc_get_string_ptr</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)), string_values[i]);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      fail_unless (len == <a class="code" href="check__libshared__marshal_8c.html#a8eb978c63d7c9fe86a9544bdf8d54fe6">MAX_MARSHALLED_STRING_LENGTH</a>);</div>
<div class="line">      fail_unless (strncmp (<a class="code" href="omlc_8h.html#ae5077b9404ef5c4c2f66a1a654430512">omlc_get_string_ptr</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)), string_values[i], <a class="code" href="check__libshared__marshal_8c.html#a8eb978c63d7c9fe86a9544bdf8d54fe6">MAX_MARSHALLED_STRING_LENGTH</a>) == 0,</div>
<div class="line">          <span class="stringliteral">&quot;Expected string: &#39;%s&#39; Unmarshalled string: &#39;%s&#39;&quot;</span>,</div>
<div class="line">          <a class="code" href="omlc_8h.html#ae5077b9404ef5c4c2f66a1a654430512">omlc_get_string_ptr</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value)), string_values[i]);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="oml__value_8c.html#ad73bf2617858cdc9c70722e1ca91eea3">oml_value_reset</a>(&amp;value);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a61e87431b4980a6b61393a639121721a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_unmarshal_guid&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l01090">1090</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="marshal_8c_source.html#l00205">GUID_T</a>, <a class="el" href="omlc_8h_source.html#l00191">OmlValueU::guidValue</a>, <a class="el" href="check__libshared__headers_8c_source.html#l00071">header</a>, <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="marshal_8c_source.html#l00897">marshal_finalize()</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00495">marshal_measurements()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00167">mbuf_fill()</a>, <a class="el" href="htonll_8h_source.html#l00038">ntohll</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00045">OML_GUID_VALUE</a>, <a class="el" href="oml__value_8h_source.html#l00060">oml_value_get_type</a>, <a class="el" href="oml__value_8c_source.html#l00081">oml_value_init()</a>, <a class="el" href="oml__value_8c_source.html#l00217">oml_value_reset()</a>, <a class="el" href="omlc_8h_source.html#l00270">omlc_get_guid</a>, <a class="el" href="guid_8c_source.html#l00076">omlc_guid_generate()</a>, <a class="el" href="omlc_8h_source.html#l00299">omlc_set_guid</a>, <a class="el" href="marshal_8h_source.html#l00041">OmlBinaryHeader::type</a>, <a class="el" href="oml__value_8c_source.html#l00042">type</a>, <a class="el" href="marshal_8c_source.html#l00951">unmarshal_init()</a>, <a class="el" href="marshal_8c_source.html#l01101">unmarshal_value()</a>, and <a class="el" href="omlc_8h_source.html#l00650">OmlValue::value</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span> VALUES_OFFSET = 7;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> GUID_LENGTH = 9;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> GUID_TYPE_OFFSET = 0;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> GUID_VALUE_OFFSET = 1;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> GUID_SIZE = <span class="keyword">sizeof</span>(<a class="code" href="omlc_8h.html#a8679c9edab629e9ce63964b64929aaf1">oml_guid_t</a>);</div>
<div class="line">  <span class="keywordtype">int</span> result;</div>
<div class="line">  <a class="code" href="structOmlValue.html">OmlValue</a> value;</div>
<div class="line"></div>
<div class="line">  <a class="code" href="oml__value_8c.html#aecf953b9ce05c582c030eec0e962c69c">oml_value_init</a>(&amp;value);</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a>();</div>
<div class="line">  <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a>(mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a66202b0ff17fc0381752edbfe6fef312">marshal_measurements</a>(mbuf, 42, 43, 42.0);</div>
<div class="line">  fail_if(mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line">  fail_if(result == -1);</div>
<div class="line">  VALUES_OFFSET = <a class="code" href="mbuf_8c.html#a60f8a8accde8c37e996b594310c59a26">mbuf_fill</a>(mbuf);</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (guid_values); i++) {</div>
<div class="line">    <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">    <a class="code" href="omlc_8h.html#a0380cd77a24adf779e25f813375ad884">omlc_guid_generate</a>(v);</div>
<div class="line">    <a class="code" href="omlc_8h.html#a836a2fe9346677384bf5dd8dee7eb0ed">omlc_set_guid</a>(v, guid_values[i]);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span> result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a>(mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012a8f383c792a4697dbf4db99ef2514853f">OML_GUID_VALUE</a>, &amp;v);</div>
<div class="line">    uint8_t* buf = &amp;(mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>[VALUES_OFFSET + i * GUID_LENGTH]);</div>
<div class="line">    <span class="keywordtype">int</span> <a class="code" href="oml__value_8c.html#ae1087eeb503fb7b11a810d93605c97df">type</a> = buf[GUID_TYPE_OFFSET];</div>
<div class="line">    uint8_t* valptr = &amp;buf[GUID_VALUE_OFFSET];</div>
<div class="line"></div>
<div class="line">    uint64_t nv = 0;</div>
<div class="line">    memcpy(&amp;nv, valptr, GUID_SIZE);</div>
<div class="line">    uint64_t hv = <a class="code" href="htonll_8h.html#a47f5c12368dfdf98a92bb0a8175c006f">ntohll</a>(nv);</div>
<div class="line">    <a class="code" href="omlc_8h.html#a8679c9edab629e9ce63964b64929aaf1">oml_guid_t</a> val = (<a class="code" href="omlc_8h.html#a8679c9edab629e9ce63964b64929aaf1">oml_guid_t</a>)hv;</div>
<div class="line"></div>
<div class="line">    fail_if(result != 1);</div>
<div class="line">    fail_if(type != <a class="code" href="marshal_8c.html#a06c2c3d86fd6e81c65fa34777944f495">GUID_T</a>);</div>
<div class="line">    fail_if(val != v.<a class="code" href="unionOmlValueU.html#ab44560e9377c5bf19b2179906f0c9e21">guidValue</a>, <span class="stringliteral">&quot;%llx != %llx\n&quot;</span>, val, v.<a class="code" href="unionOmlValueU.html#ab44560e9377c5bf19b2179906f0c9e21">guidValue</a>);</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="marshal_8c.html#a0c0615d0abcd3673b56b0c7f68076895">marshal_finalize</a>(mbuf);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structOmlBinaryHeader.html">OmlBinaryHeader</a> <a class="code" href="check__libshared__headers_8c.html#a41d770ad2f3cb946006035f9e550deca">header</a>;</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a50099442a78fa10193ffa16aaf06c6ab">unmarshal_init</a>(mbuf, &amp;header);</div>
<div class="line">  fail_if(result == -1);</div>
<div class="line">  fail_unless(header.<a class="code" href="structOmlBinaryHeader.html#aa74b1de7e6a71da225764bd1dd417914">type</a> == <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a>(guid_values); i++) {</div>
<div class="line">    <a class="code" href="marshal_8c.html#a000380a8534653b3027ec98e04e270c0">unmarshal_value</a>(mbuf, &amp;value);</div>
<div class="line">    fail_unless(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;value) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012a8f383c792a4697dbf4db99ef2514853f">OML_GUID_VALUE</a>);</div>
<div class="line">    fail_unless(<a class="code" href="omlc_8h.html#a2ef9e64d176c33c11c98d11fae69a5ea">omlc_get_guid</a>(value.<a class="code" href="structOmlValue.html#ab606b56595b2e5357a4b3d7bf40d6260">value</a>) == guid_values[i],</div>
<div class="line">                <span class="stringliteral">&quot;Unmarshalled value %llx, expected %llx\n&quot;</span>,</div>
<div class="line">                <a class="code" href="omlc_8h.html#a2ef9e64d176c33c11c98d11fae69a5ea">omlc_get_guid</a>(value.<a class="code" href="structOmlValue.html#ab606b56595b2e5357a4b3d7bf40d6260">value</a>), guid_values[i]);</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="oml__value_8c.html#ad73bf2617858cdc9c70722e1ca91eea3">oml_value_reset</a>(&amp;value);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a64f3910f995ee5a89e538e63c179ec62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_unmarshal_bool&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l01145">1145</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="marshal_8c_source.html#l00207">BOOL_FALSE_T</a>, <a class="el" href="marshal_8c_source.html#l00209">BOOL_TRUE_T</a>, <a class="el" href="check__libshared__headers_8c_source.html#l00071">header</a>, <a class="el" href="oml__util_8h_source.html#l00027">LENGTH</a>, <a class="el" href="marshal_8c_source.html#l00897">marshal_finalize()</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00495">marshal_measurements()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00167">mbuf_fill()</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="omlc_8h_source.html#l00046">OML_BOOL_VALUE</a>, <a class="el" href="oml__value_8h_source.html#l00060">oml_value_get_type</a>, <a class="el" href="oml__value_8h_source.html#l00051">oml_value_get_value</a>, <a class="el" href="oml__value_8c_source.html#l00081">oml_value_init()</a>, <a class="el" href="oml__value_8c_source.html#l00217">oml_value_reset()</a>, <a class="el" href="omlc_8h_source.html#l00273">omlc_get_bool</a>, <a class="el" href="omlc_8h_source.html#l00302">omlc_set_bool</a>, <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>, <a class="el" href="marshal_8h_source.html#l00041">OmlBinaryHeader::type</a>, <a class="el" href="marshal_8c_source.html#l00951">unmarshal_init()</a>, and <a class="el" href="marshal_8c_source.html#l01101">unmarshal_value()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span> VALUES_OFFSET = 7;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> BOOL_LENGTH = 1;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> BOOL_VALUE_OFFSET = 0;</div>
<div class="line">  uint8_t val;</div>
<div class="line">  <span class="keywordtype">int</span> result;</div>
<div class="line">  <a class="code" href="structOmlValue.html">OmlValue</a> value;</div>
<div class="line"></div>
<div class="line">  <a class="code" href="oml__value_8c.html#aecf953b9ce05c582c030eec0e962c69c">oml_value_init</a>(&amp;value);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a> ();</div>
<div class="line">  <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a> (mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a66202b0ff17fc0381752edbfe6fef312">marshal_measurements</a> (mbuf, 42, 43, 42.0);</div>
<div class="line"></div>
<div class="line">  fail_if (mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line"></div>
<div class="line">  VALUES_OFFSET = <a class="code" href="mbuf_8c.html#a60f8a8accde8c37e996b594310c59a26">mbuf_fill</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (bool_values); i++) {</div>
<div class="line">      <a class="code" href="unionOmlValueU.html">OmlValueU</a> v;</div>
<div class="line">      <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(v);</div>
<div class="line">      <a class="code" href="omlc_8h.html#a8d84dc9e74c5e2c6fe319a6e1d9f8776">omlc_set_bool</a>(v, bool_values[i]);</div>
<div class="line">      <span class="keywordtype">int</span> result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a> (mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012ac12a596e1ea36e0a6f0c58d2b63c8046">OML_BOOL_VALUE</a>, &amp;v);</div>
<div class="line"></div>
<div class="line">      uint8_t* buf = &amp;mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a>[VALUES_OFFSET + i * BOOL_LENGTH];</div>
<div class="line">      uint8_t* valptr = &amp;buf[BOOL_VALUE_OFFSET];</div>
<div class="line"></div>
<div class="line">      fail_if (result != 1);</div>
<div class="line">      fail_unless (<a class="code" href="marshal_8c.html#a7e5ce4a4afe3c8c5e6a166a98c73bf49">BOOL_FALSE_T</a> == *valptr || <a class="code" href="marshal_8c.html#aaaece6ec7d7273c485301e9b4a88c27e">BOOL_TRUE_T</a> == *valptr);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <a class="code" href="marshal_8c.html#a0c0615d0abcd3673b56b0c7f68076895">marshal_finalize</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structOmlBinaryHeader.html">OmlBinaryHeader</a> <a class="code" href="check__libshared__headers_8c.html#a41d770ad2f3cb946006035f9e550deca">header</a>;</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a50099442a78fa10193ffa16aaf06c6ab">unmarshal_init</a> (mbuf, &amp;header);</div>
<div class="line">  fail_if (result == -1);</div>
<div class="line"></div>
<div class="line">  fail_unless (header.<a class="code" href="structOmlBinaryHeader.html#aa74b1de7e6a71da225764bd1dd417914">type</a> == <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="oml__util_8h.html#ad0e13d94164219be2d5bbd4d65e71d1e">LENGTH</a> (bool_values); i++) {</div>
<div class="line">      <a class="code" href="marshal_8c.html#a000380a8534653b3027ec98e04e270c0">unmarshal_value</a> (mbuf, &amp;value);</div>
<div class="line"></div>
<div class="line">      fail_unless (<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;value) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012ac12a596e1ea36e0a6f0c58d2b63c8046">OML_BOOL_VALUE</a>);</div>
<div class="line">      val = <a class="code" href="omlc_8h.html#ad5e34e372b65dec9ccfc9fc61c3fbc6c">omlc_get_bool</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;value));</div>
<div class="line">      fail_unless ((val &amp;&amp; bool_values[i]) ||</div>
<div class="line">          (!val &amp;&amp; !bool_values[i]),</div>
<div class="line">          <span class="stringliteral">&quot;%d (shouldn&#39;t be -1) and %d do not have the same truth value&quot;</span>,</div>
<div class="line">          (<a class="code" href="marshal_8c.html#aaaece6ec7d7273c485301e9b4a88c27e">BOOL_TRUE_T</a>==val)?1:((<a class="code" href="marshal_8c.html#a7e5ce4a4afe3c8c5e6a166a98c73bf49">BOOL_FALSE_T</a>==val)?0:-1), bool_values[_i]);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <a class="code" href="oml__value_8c.html#ad73bf2617858cdc9c70722e1ca91eea3">oml_value_reset</a>(&amp;value);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afd19d64288e3d2e1e3ea05d94673853b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_unmarshal_vector_double&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l01202">1202</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="check__libshared__headers_8c_source.html#l00071">header</a>, <a class="el" href="marshal_8c_source.html#l00897">marshal_finalize()</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00495">marshal_measurements()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="oml__value_8h_source.html#l00060">oml_value_get_type</a>, <a class="el" href="oml__value_8h_source.html#l00051">oml_value_get_value</a>, <a class="el" href="oml__value_8c_source.html#l00081">oml_value_init()</a>, <a class="el" href="omlc_8h_source.html#l00051">OML_VECTOR_DOUBLE_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00568">omlc_get_vector_nof_elts</a>, <a class="el" href="omlc_8h_source.html#l00556">omlc_get_vector_ptr</a>, <a class="el" href="omlc_8h_source.html#l00618">omlc_set_vector_double</a>, <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>, <a class="el" href="marshal_8h_source.html#l00045">OmlBinaryHeader::seqno</a>, <a class="el" href="marshal_8h_source.html#l00044">OmlBinaryHeader::stream</a>, <a class="el" href="marshal_8h_source.html#l00041">OmlBinaryHeader::type</a>, <a class="el" href="marshal_8c_source.html#l00951">unmarshal_init()</a>, <a class="el" href="marshal_8c_source.html#l01101">unmarshal_value()</a>, and <a class="el" href="omlc_8h_source.html#l00650">OmlValue::value</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">size_t</span> i;</div>
<div class="line">  <span class="keywordtype">int</span> result;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">size_t</span> NVALUES = <span class="keyword">sizeof</span>(double_values)/<span class="keyword">sizeof</span>(double_values[0]);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a>();</div>
<div class="line">  <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a>(mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a66202b0ff17fc0381752edbfe6fef312">marshal_measurements</a> (mbuf, 98, 99, 100.0);</div>
<div class="line">  fail_if(-1 == result);</div>
<div class="line">  fail_if(mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="unionOmlValueU.html">OmlValueU</a> out;</div>
<div class="line">  <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(out);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a7e617459382eb85196d93d180f0addc7">omlc_set_vector_double</a>(out, double_values, NVALUES);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a>(mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012acb2346135dde2824348712d936f03353">OML_VECTOR_DOUBLE_VALUE</a>, &amp;out);</div>
<div class="line">  fail_if (result != 1);</div>
<div class="line">  <a class="code" href="marshal_8c.html#a0c0615d0abcd3673b56b0c7f68076895">marshal_finalize</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structOmlBinaryHeader.html">OmlBinaryHeader</a> <a class="code" href="check__libshared__headers_8c.html#a41d770ad2f3cb946006035f9e550deca">header</a>;</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a50099442a78fa10193ffa16aaf06c6ab">unmarshal_init</a> (mbuf, &amp;header);</div>
<div class="line">  fail_unless(1 == result);</div>
<div class="line">  fail_unless(header.<a class="code" href="structOmlBinaryHeader.html#aa74b1de7e6a71da225764bd1dd417914">type</a> == <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  fail_unless(header.<a class="code" href="structOmlBinaryHeader.html#a7307c8a8c7e51271dcac40fb068d5bc4">stream</a> == 98);</div>
<div class="line">  fail_unless(header.<a class="code" href="structOmlBinaryHeader.html#afbd06e85da03463c78d51f06c97a384d">seqno</a> == 99);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structOmlValue.html">OmlValue</a> in;</div>
<div class="line">  <a class="code" href="oml__value_8c.html#aecf953b9ce05c582c030eec0e962c69c">oml_value_init</a>(&amp;in);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a000380a8534653b3027ec98e04e270c0">unmarshal_value</a>(mbuf, &amp;in);</div>
<div class="line">  fail_unless(1 == result);</div>
<div class="line"></div>
<div class="line">  fail_unless(<a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012acb2346135dde2824348712d936f03353">OML_VECTOR_DOUBLE_VALUE</a> == <a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;in));</div>
<div class="line">  fail_unless(<a class="code" href="omlc_8h.html#a00a0a1d69982669384babad1ceff630e">omlc_get_vector_nof_elts</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;in)) == NVALUES);</div>
<div class="line">  <span class="keywordtype">double</span> *actual_values = <a class="code" href="omlc_8h.html#a3e6ebac117f490c57b65321c4753c0a1">omlc_get_vector_ptr</a>(in.<a class="code" href="structOmlValue.html#ab606b56595b2e5357a4b3d7bf40d6260">value</a>);</div>
<div class="line">  <span class="keywordflow">for</span>(i = 0; i &lt; NVALUES; i++) {</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(isnan(double_values[i]))</div>
<div class="line">      fail_unless(isnan(double_values[i]), isnan(actual_values[i]));</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      fail_unless(double_values[i] == actual_values[i]);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4b582f6153d3905134ff1fe49b1f40ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_unmarshal_vector_int32&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l01246">1246</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="check__libshared__headers_8c_source.html#l00071">header</a>, <a class="el" href="marshal_8c_source.html#l00897">marshal_finalize()</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00495">marshal_measurements()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="oml__value_8h_source.html#l00060">oml_value_get_type</a>, <a class="el" href="oml__value_8h_source.html#l00051">oml_value_get_value</a>, <a class="el" href="oml__value_8c_source.html#l00081">oml_value_init()</a>, <a class="el" href="omlc_8h_source.html#l00052">OML_VECTOR_INT32_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00568">omlc_get_vector_nof_elts</a>, <a class="el" href="omlc_8h_source.html#l00556">omlc_get_vector_ptr</a>, <a class="el" href="omlc_8h_source.html#l00622">omlc_set_vector_int32</a>, <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>, <a class="el" href="marshal_8h_source.html#l00045">OmlBinaryHeader::seqno</a>, <a class="el" href="marshal_8h_source.html#l00044">OmlBinaryHeader::stream</a>, <a class="el" href="marshal_8h_source.html#l00041">OmlBinaryHeader::type</a>, <a class="el" href="marshal_8c_source.html#l00951">unmarshal_init()</a>, <a class="el" href="marshal_8c_source.html#l01101">unmarshal_value()</a>, and <a class="el" href="omlc_8h_source.html#l00650">OmlValue::value</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">size_t</span> i;</div>
<div class="line">  <span class="keywordtype">int</span> result;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">size_t</span> NVALUES = <span class="keyword">sizeof</span>(int32_values)/<span class="keyword">sizeof</span>(int32_values[0]);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a>();</div>
<div class="line">  <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a>(mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a66202b0ff17fc0381752edbfe6fef312">marshal_measurements</a> (mbuf, 98, 99, 100.0);</div>
<div class="line">  fail_if(-1 == result);</div>
<div class="line">  fail_if(mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="unionOmlValueU.html">OmlValueU</a> out;</div>
<div class="line">  <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(out);</div>
<div class="line">  <a class="code" href="omlc_8h.html#acaf1ac07dcb567f47b9335b6542f050b">omlc_set_vector_int32</a>(out, int32_values, NVALUES);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a>(mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aed6846ecc2ffcc8aadce26c11162a620">OML_VECTOR_INT32_VALUE</a>, &amp;out);</div>
<div class="line">  fail_if (result != 1);</div>
<div class="line">  <a class="code" href="marshal_8c.html#a0c0615d0abcd3673b56b0c7f68076895">marshal_finalize</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structOmlBinaryHeader.html">OmlBinaryHeader</a> <a class="code" href="check__libshared__headers_8c.html#a41d770ad2f3cb946006035f9e550deca">header</a>;</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a50099442a78fa10193ffa16aaf06c6ab">unmarshal_init</a> (mbuf, &amp;header);</div>
<div class="line">  fail_unless(1 == result);</div>
<div class="line">  fail_unless(header.<a class="code" href="structOmlBinaryHeader.html#aa74b1de7e6a71da225764bd1dd417914">type</a> == <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  fail_unless(header.<a class="code" href="structOmlBinaryHeader.html#a7307c8a8c7e51271dcac40fb068d5bc4">stream</a> == 98);</div>
<div class="line">  fail_unless(header.<a class="code" href="structOmlBinaryHeader.html#afbd06e85da03463c78d51f06c97a384d">seqno</a> == 99);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structOmlValue.html">OmlValue</a> in;</div>
<div class="line">  <a class="code" href="oml__value_8c.html#aecf953b9ce05c582c030eec0e962c69c">oml_value_init</a>(&amp;in);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a000380a8534653b3027ec98e04e270c0">unmarshal_value</a>(mbuf, &amp;in);</div>
<div class="line">  fail_unless(1 == result);</div>
<div class="line"></div>
<div class="line">  fail_unless(<a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aed6846ecc2ffcc8aadce26c11162a620">OML_VECTOR_INT32_VALUE</a> == <a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;in));</div>
<div class="line">  fail_unless(<a class="code" href="omlc_8h.html#a00a0a1d69982669384babad1ceff630e">omlc_get_vector_nof_elts</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;in)) == NVALUES);</div>
<div class="line">  int32_t *actual_values = <a class="code" href="omlc_8h.html#a3e6ebac117f490c57b65321c4753c0a1">omlc_get_vector_ptr</a>(in.<a class="code" href="structOmlValue.html#ab606b56595b2e5357a4b3d7bf40d6260">value</a>);</div>
<div class="line">  <span class="keywordflow">for</span>(i = 0; i &lt; NVALUES; i++) {</div>
<div class="line">    fail_unless(int32_values[i] == actual_values[i]);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9f3b2e4534b437fde22e453306b582ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_unmarshal_vector_int64&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l01286">1286</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="check__libshared__headers_8c_source.html#l00071">header</a>, <a class="el" href="marshal_8c_source.html#l00897">marshal_finalize()</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00495">marshal_measurements()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="oml__value_8h_source.html#l00060">oml_value_get_type</a>, <a class="el" href="oml__value_8h_source.html#l00051">oml_value_get_value</a>, <a class="el" href="oml__value_8c_source.html#l00081">oml_value_init()</a>, <a class="el" href="omlc_8h_source.html#l00054">OML_VECTOR_INT64_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00568">omlc_get_vector_nof_elts</a>, <a class="el" href="omlc_8h_source.html#l00556">omlc_get_vector_ptr</a>, <a class="el" href="omlc_8h_source.html#l00626">omlc_set_vector_int64</a>, <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>, <a class="el" href="marshal_8h_source.html#l00045">OmlBinaryHeader::seqno</a>, <a class="el" href="marshal_8h_source.html#l00044">OmlBinaryHeader::stream</a>, <a class="el" href="marshal_8h_source.html#l00041">OmlBinaryHeader::type</a>, <a class="el" href="marshal_8c_source.html#l00951">unmarshal_init()</a>, <a class="el" href="marshal_8c_source.html#l01101">unmarshal_value()</a>, and <a class="el" href="omlc_8h_source.html#l00650">OmlValue::value</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">size_t</span> i;</div>
<div class="line">  <span class="keywordtype">int</span> result;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">size_t</span> NVALUES = <span class="keyword">sizeof</span>(int64_values)/<span class="keyword">sizeof</span>(int64_values[0]);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a>();</div>
<div class="line">  <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a>(mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a66202b0ff17fc0381752edbfe6fef312">marshal_measurements</a> (mbuf, 98, 99, 100.0);</div>
<div class="line">  fail_if(-1 == result);</div>
<div class="line">  fail_if(mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="unionOmlValueU.html">OmlValueU</a> out;</div>
<div class="line">  <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(out);</div>
<div class="line">  <a class="code" href="omlc_8h.html#ac3cc466d9f6137e2f359dcfd70679046">omlc_set_vector_int64</a>(out, int64_values, NVALUES);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a>(mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012a0b98a39a835deadf7a27de784acd8a93">OML_VECTOR_INT64_VALUE</a>, &amp;out);</div>
<div class="line">  fail_if (result != 1);</div>
<div class="line">  <a class="code" href="marshal_8c.html#a0c0615d0abcd3673b56b0c7f68076895">marshal_finalize</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structOmlBinaryHeader.html">OmlBinaryHeader</a> <a class="code" href="check__libshared__headers_8c.html#a41d770ad2f3cb946006035f9e550deca">header</a>;</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a50099442a78fa10193ffa16aaf06c6ab">unmarshal_init</a> (mbuf, &amp;header);</div>
<div class="line">  fail_unless(1 == result);</div>
<div class="line">  fail_unless(header.<a class="code" href="structOmlBinaryHeader.html#aa74b1de7e6a71da225764bd1dd417914">type</a> == <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  fail_unless(header.<a class="code" href="structOmlBinaryHeader.html#a7307c8a8c7e51271dcac40fb068d5bc4">stream</a> == 98);</div>
<div class="line">  fail_unless(header.<a class="code" href="structOmlBinaryHeader.html#afbd06e85da03463c78d51f06c97a384d">seqno</a> == 99);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structOmlValue.html">OmlValue</a> in;</div>
<div class="line">  <a class="code" href="oml__value_8c.html#aecf953b9ce05c582c030eec0e962c69c">oml_value_init</a>(&amp;in);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a000380a8534653b3027ec98e04e270c0">unmarshal_value</a>(mbuf, &amp;in);</div>
<div class="line">  fail_unless(1 == result);</div>
<div class="line"></div>
<div class="line">  fail_unless(<a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012a0b98a39a835deadf7a27de784acd8a93">OML_VECTOR_INT64_VALUE</a> == <a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;in));</div>
<div class="line">  fail_unless(<a class="code" href="omlc_8h.html#a00a0a1d69982669384babad1ceff630e">omlc_get_vector_nof_elts</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;in)) == NVALUES);</div>
<div class="line">  int64_t *actual_values = <a class="code" href="omlc_8h.html#a3e6ebac117f490c57b65321c4753c0a1">omlc_get_vector_ptr</a>(in.<a class="code" href="structOmlValue.html#ab606b56595b2e5357a4b3d7bf40d6260">value</a>);</div>
<div class="line">  <span class="keywordflow">for</span>(i = 0; i &lt; NVALUES; i++) {</div>
<div class="line">    fail_unless(int64_values[i] == actual_values[i]);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a04677ba86ffbc4a1248eec888629cf55"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_unmarshal_vector_bool&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l01326">1326</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="mbuf_8h_source.html#l00033">MBuffer::base</a>, <a class="el" href="check__libshared__headers_8c_source.html#l00071">header</a>, <a class="el" href="marshal_8c_source.html#l00897">marshal_finalize()</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00495">marshal_measurements()</a>, <a class="el" href="marshal_8c_source.html#l00577">marshal_value()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="oml__value_8h_source.html#l00060">oml_value_get_type</a>, <a class="el" href="oml__value_8h_source.html#l00051">oml_value_get_value</a>, <a class="el" href="oml__value_8c_source.html#l00081">oml_value_init()</a>, <a class="el" href="omlc_8h_source.html#l00056">OML_VECTOR_BOOL_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00568">omlc_get_vector_nof_elts</a>, <a class="el" href="omlc_8h_source.html#l00556">omlc_get_vector_ptr</a>, <a class="el" href="omlc_8h_source.html#l00630">omlc_set_vector_bool</a>, <a class="el" href="omlc_8h_source.html#l00209">omlc_zero</a>, <a class="el" href="marshal_8h_source.html#l00045">OmlBinaryHeader::seqno</a>, <a class="el" href="marshal_8h_source.html#l00044">OmlBinaryHeader::stream</a>, <a class="el" href="marshal_8h_source.html#l00041">OmlBinaryHeader::type</a>, <a class="el" href="marshal_8c_source.html#l00951">unmarshal_init()</a>, <a class="el" href="marshal_8c_source.html#l01101">unmarshal_value()</a>, and <a class="el" href="omlc_8h_source.html#l00650">OmlValue::value</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">size_t</span> i;</div>
<div class="line">  <span class="keywordtype">int</span> result;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">size_t</span> NVALUES = <span class="keyword">sizeof</span>(bool_values)/<span class="keyword">sizeof</span>(bool_values[0]);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a>* mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a>();</div>
<div class="line">  <a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a>(mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a66202b0ff17fc0381752edbfe6fef312">marshal_measurements</a> (mbuf, 98, 99, 100.0);</div>
<div class="line">  fail_if(-1 == result);</div>
<div class="line">  fail_if(mbuf-&gt;<a class="code" href="structMBuffer.html#a99e1431a6e9584380b12df832714b2f9">base</a> == NULL);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="unionOmlValueU.html">OmlValueU</a> out;</div>
<div class="line">  <a class="code" href="omlc_8h.html#a5cd79ce130e86f27ce8bae31400beffe">omlc_zero</a>(out);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a01586898a3109c06ae370fe26e705585">omlc_set_vector_bool</a>(out, bool_values, NVALUES);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#ad6d9ad2684cedac88e911da72a19dc0c">marshal_value</a>(mbuf, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aebca95966d074921730a23e95b5d9dd6">OML_VECTOR_BOOL_VALUE</a>, &amp;out);</div>
<div class="line">  fail_if (result != 1);</div>
<div class="line">  <a class="code" href="marshal_8c.html#a0c0615d0abcd3673b56b0c7f68076895">marshal_finalize</a> (mbuf);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structOmlBinaryHeader.html">OmlBinaryHeader</a> <a class="code" href="check__libshared__headers_8c.html#a41d770ad2f3cb946006035f9e550deca">header</a>;</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a50099442a78fa10193ffa16aaf06c6ab">unmarshal_init</a> (mbuf, &amp;header);</div>
<div class="line">  fail_unless(1 == result);</div>
<div class="line">  fail_unless(header.<a class="code" href="structOmlBinaryHeader.html#aa74b1de7e6a71da225764bd1dd417914">type</a> == <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>);</div>
<div class="line">  fail_unless(header.<a class="code" href="structOmlBinaryHeader.html#a7307c8a8c7e51271dcac40fb068d5bc4">stream</a> == 98);</div>
<div class="line">  fail_unless(header.<a class="code" href="structOmlBinaryHeader.html#afbd06e85da03463c78d51f06c97a384d">seqno</a> == 99);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structOmlValue.html">OmlValue</a> in;</div>
<div class="line">  <a class="code" href="oml__value_8c.html#aecf953b9ce05c582c030eec0e962c69c">oml_value_init</a>(&amp;in);</div>
<div class="line">  result = <a class="code" href="marshal_8c.html#a000380a8534653b3027ec98e04e270c0">unmarshal_value</a>(mbuf, &amp;in);</div>
<div class="line">  fail_unless(1 == result);</div>
<div class="line"></div>
<div class="line">  fail_unless(<a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aebca95966d074921730a23e95b5d9dd6">OML_VECTOR_BOOL_VALUE</a> == <a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;in));</div>
<div class="line">  fail_unless(<a class="code" href="omlc_8h.html#a00a0a1d69982669384babad1ceff630e">omlc_get_vector_nof_elts</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;in)) == NVALUES);</div>
<div class="line">  <span class="keywordtype">bool</span> *actual_values = <a class="code" href="omlc_8h.html#a3e6ebac117f490c57b65321c4753c0a1">omlc_get_vector_ptr</a>(in.<a class="code" href="structOmlValue.html#ab606b56595b2e5357a4b3d7bf40d6260">value</a>);</div>
<div class="line">  <span class="keywordflow">for</span>(i = 0; i &lt; NVALUES; i++) {</div>
<div class="line">    fail_unless(bool_values[i] == actual_values[i]);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abdba2a42e0a13223c08a79dc8d5542be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_marshal_full&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l01374">1374</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>References <a class="el" href="check__liboml2__omlvalue_8c_source.html#l00407">b</a>, <a class="el" href="marshal_8c_source.html#l00203">BLOB_T</a>, <a class="el" href="marshal_8c_source.html#l00207">BOOL_FALSE_T</a>, <a class="el" href="marshal_8c_source.html#l00209">BOOL_TRUE_T</a>, <a class="el" href="stddev__0_8c_source.html#l00021">count</a>, <a class="el" href="marshal_8c_source.html#l00189">DOUBLE_T</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l01366">dumpmessage</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l00043">EPSILON</a>, <a class="el" href="marshal_8c_source.html#l00205">GUID_T</a>, <a class="el" href="msggen_8rb_source.html#l00076">h</a>, <a class="el" href="marshal_8c_source.html#l00195">INT32_T</a>, <a class="el" href="marshal_8c_source.html#l00199">INT64_T</a>, <a class="el" href="marshal_8h_source.html#l00042">OmlBinaryHeader::length</a>, <a class="el" href="marshal_8c_source.html#l00187">LONG_T</a>, <a class="el" href="marshal_8c_source.html#l00897">marshal_finalize()</a>, <a class="el" href="marshal_8c_source.html#l00450">marshal_init()</a>, <a class="el" href="marshal_8c_source.html#l00495">marshal_measurements()</a>, <a class="el" href="marshal_8c_source.html#l00545">marshal_values()</a>, <a class="el" href="mbuf_8c_source.html#l00043">mbuf_create()</a>, <a class="el" href="mbuf_8c_source.html#l00092">mbuf_destroy()</a>, <a class="el" href="mbuf_8c_source.html#l00262">mbuf_message()</a>, <a class="el" href="mbuf_8c_source.html#l00236">mbuf_message_length()</a>, <a class="el" href="htonll_8h_source.html#l00038">ntohll</a>, <a class="el" href="o__log_8h_source.html#l00027">O_LOG_DEBUG2</a>, <a class="el" href="log_8c_source.html#l00083">o_set_log_level()</a>, <a class="el" href="marshal_8h_source.html#l00034">OMB_DATA_P</a>, <a class="el" href="marshal_8h_source.html#l00036">OMB_LDATA_P</a>, <a class="el" href="omlc_8h_source.html#l00044">OML_BLOB_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00046">OML_BOOL_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00036">OML_DOUBLE_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00045">OML_GUID_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00040">OML_INT32_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00042">OML_INT64_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00037">OML_LONG_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00039">OML_STRING_VALUE</a>, <a class="el" href="oml__value_8c_source.html#l00298">oml_type_to_s()</a>, <a class="el" href="omlc_8h_source.html#l00041">OML_UINT32_VALUE</a>, <a class="el" href="omlc_8h_source.html#l00043">OML_UINT64_VALUE</a>, <a class="el" href="oml__value_8h_source.html#l00060">oml_value_get_type</a>, <a class="el" href="oml__value_8h_source.html#l00051">oml_value_get_value</a>, <a class="el" href="oml__value_8c_source.html#l00081">oml_value_init()</a>, <a class="el" href="oml__value_8c_source.html#l00109">oml_value_set_type()</a>, <a class="el" href="omlc_8h_source.html#l00167">OMLC_BOOL_FALSE</a>, <a class="el" href="omlc_8h_source.html#l00168">OMLC_BOOL_TRUE</a>, <a class="el" href="omlc_8h_source.html#l00371">omlc_get_blob_length</a>, <a class="el" href="omlc_8h_source.html#l00368">omlc_get_blob_ptr</a>, <a class="el" href="omlc_8h_source.html#l00273">omlc_get_bool</a>, <a class="el" href="omlc_8h_source.html#l00264">omlc_get_double</a>, <a class="el" href="omlc_8h_source.html#l00270">omlc_get_guid</a>, <a class="el" href="omlc_8h_source.html#l00252">omlc_get_int32</a>, <a class="el" href="omlc_8h_source.html#l00258">omlc_get_int64</a>, <a class="el" href="omlc_8h_source.html#l00344">omlc_get_string_length</a>, <a class="el" href="omlc_8h_source.html#l00340">omlc_get_string_ptr</a>, <a class="el" href="omlc_8h_source.html#l00255">omlc_get_uint32</a>, <a class="el" href="omlc_8h_source.html#l00261">omlc_get_uint64</a>, <a class="el" href="guid_8c_source.html#l00076">omlc_guid_generate()</a>, <a class="el" href="omlc_8h_source.html#l00535">omlc_reset_blob</a>, <a class="el" href="omlc_8h_source.html#l00457">omlc_reset_string</a>, <a class="el" href="omlc_8h_source.html#l00538">omlc_set_blob</a>, <a class="el" href="omlc_8h_source.html#l00302">omlc_set_bool</a>, <a class="el" href="omlc_8h_source.html#l00293">omlc_set_double</a>, <a class="el" href="omlc_8h_source.html#l00299">omlc_set_guid</a>, <a class="el" href="omlc_8h_source.html#l00281">omlc_set_int32</a>, <a class="el" href="omlc_8h_source.html#l00287">omlc_set_int64</a>, <a class="el" href="omlc_8h_source.html#l00296">omlc_set_long</a>, <a class="el" href="omlc_8h_source.html#l00476">omlc_set_string_copy</a>, <a class="el" href="omlc_8h_source.html#l00284">omlc_set_uint32</a>, <a class="el" href="omlc_8h_source.html#l00290">omlc_set_uint64</a>, <a class="el" href="check__libshared__marshal_8c_source.html#l00060">PACKET_HEADER_SIZE</a>, <a class="el" href="marshal_8h_source.html#l00045">OmlBinaryHeader::seqno</a>, <a class="el" href="marshal_8h_source.html#l00044">OmlBinaryHeader::stream</a>, <a class="el" href="marshal_8c_source.html#l00193">STRING_T</a>, <a class="el" href="marshal_8h_source.html#l00046">OmlBinaryHeader::timestamp</a>, <a class="el" href="marshal_8c_source.html#l00197">UINT32_T</a>, <a class="el" href="marshal_8c_source.html#l00201">UINT64_T</a>, <a class="el" href="marshal_8c_source.html#l00951">unmarshal_init()</a>, <a class="el" href="marshal_8c_source.html#l01062">unmarshal_values()</a>, and <a class="el" href="marshal_8h_source.html#l00043">OmlBinaryHeader::values</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <a class="code" href="structMBuffer.html">MBuffer</a> *mbuf;</div>
<div class="line">  <a class="code" href="structOmlValue.html">OmlValue</a> v, *va;</div>
<div class="line">  <a class="code" href="structOmlBinaryHeader.html">OmlBinaryHeader</a> <a class="code" href="msggen_8rb.html#add227bfc6730666ecdd7a5a2f653592b">h</a>;</div>
<div class="line">  int32_t d32 = -42;</div>
<div class="line">  uint32_t u32 = 1337;</div>
<div class="line">  int64_t d64 = (int64_t)d32 &lt;&lt; 32;</div>
<div class="line">  uint64_t u64 = (uint64_t)u32 &lt;&lt; 32;</div>
<div class="line">  <span class="keywordtype">double</span> d = M_PI, d2;</div>
<div class="line">  <span class="keywordtype">long</span> l = d32;</div>
<div class="line">  <span class="keywordtype">char</span> s[] = <span class="stringliteral">&quot;I am both a string AND a blob... Go figure.&quot;</span>;</div>
<div class="line">  <a class="code" href="omlc_8h.html#a8679c9edab629e9ce63964b64929aaf1">oml_guid_t</a> guid = <a class="code" href="omlc_8h.html#a0380cd77a24adf779e25f813375ad884">omlc_guid_generate</a>();</div>
<div class="line">  uint8_t bfalse = <a class="code" href="omlc_8h.html#a33ea04fbefee8fb9eabe9b0f0e2f2087">OMLC_BOOL_FALSE</a>, btrue = <a class="code" href="omlc_8h.html#adb144d30b19909691a929afe2511d257">OMLC_BOOL_TRUE</a>, bval;</div>
<div class="line">  <span class="keywordtype">void</span> *<a class="code" href="check__liboml2__omlvalue_8c.html#a4313c9563516f94387762ab05763456b">b</a> = (<span class="keywordtype">void</span>*)s, *p;</div>
<div class="line">  <span class="keywordtype">int</span> len = strlen(s), <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>=0;</div>
<div class="line">  uint8_t *msg, offset;</div>
<div class="line"></div>
<div class="line">  <a class="code" href="log_8c.html#add76efe2ed8cc1b5444092218e2ee6c6">o_set_log_level</a>(<a class="code" href="o__log_8h.html#aad44cd3a2bea1816db26d7127fc8ced8">O_LOG_DEBUG2</a>);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="oml__value_8c.html#aecf953b9ce05c582c030eec0e962c69c">oml_value_init</a>(&amp;v);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * MARSHALLING STARTS HERE</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  mbuf = <a class="code" href="mbuf_8c.html#a765ec3ef2a50e81e94bdbde95973e362">mbuf_create</a>();</div>
<div class="line">  fail_if(<a class="code" href="marshal_8c.html#abf2845a176c08dbf690333177c8d2327">marshal_init</a>(mbuf, <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>));</div>
<div class="line">  msg = <a class="code" href="mbuf_8c.html#a64f532f1d7946c6969320cc4313bc687">mbuf_message</a>(mbuf);</div>
<div class="line">  offset = 0;</div>
<div class="line">  fail_unless(msg[offset] == 0xAA,</div>
<div class="line">              <span class="stringliteral">&quot;Fist sync byte not set properly; found &#39;%#x&#39; at offset %d&quot;</span>,</div>
<div class="line">              msg[offset], offset);</div>
<div class="line">  offset++;</div>
<div class="line">  fail_unless(msg[offset] == 0xAA,</div>
<div class="line">              <span class="stringliteral">&quot;Second sync byte not set properly; found &#39;%#x&#39; at offset %d&quot;</span>,</div>
<div class="line">              msg[offset], offset);</div>
<div class="line">  offset++;</div>
<div class="line">  fail_unless(msg[offset] == <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a>,</div>
<div class="line">              <span class="stringliteral">&quot;Packet type not set properly; found &#39;%#x&#39; at offset %d&quot;</span>,</div>
<div class="line">              msg[offset], offset);</div>
<div class="line">  offset++;</div>
<div class="line">  fail_unless(<a class="code" href="mbuf_8c.html#a1afcdf8eb3312a3006b1ed5cc8e8843e">mbuf_message_length</a>(mbuf) == 5,</div>
<div class="line">              <span class="stringliteral">&quot;Current message should be 5 bytes&quot;</span>);</div>
<div class="line">  offset+=2;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Verify length */</span></div>
<div class="line">  fail_unless(<a class="code" href="marshal_8c.html#a66202b0ff17fc0381752edbfe6fef312">marshal_measurements</a>(mbuf, 1, 2, 3.) == 1);</div>
<div class="line">  <span class="comment">/* Before finalisation, the first byte of length contains the number of elements */</span></div>
<div class="line">  fail_unless(msg[5] == 0,</div>
<div class="line">      <span class="stringliteral">&quot;Initial number of element not set properly; got %d instead of 0 at offset %d&quot;</span>,</div>
<div class="line">      msg[5], offset);</div>
<div class="line">  offset++;</div>
<div class="line">  fail_unless(msg[offset] == 1,</div>
<div class="line">      <span class="stringliteral">&quot;Stream number not set properly; got %d instead of 1 at offset %d&quot;</span>,</div>
<div class="line">      msg[offset], offset);</div>
<div class="line">  offset++;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Verify seqno */</span></div>
<div class="line">  fail_unless(msg[offset] == <a class="code" href="marshal_8c.html#a2251891f2e0a2db27ca4c6507d3f4040">INT32_T</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Seqno type not set properly; got %d instead of %d at offset %d&quot;</span>,</div>
<div class="line">      msg[offset], <a class="code" href="marshal_8c.html#a2251891f2e0a2db27ca4c6507d3f4040">INT32_T</a>, offset);</div>
<div class="line">  offset++;</div>
<div class="line">  p = &amp;msg[offset];</div>
<div class="line">  fail_unless(ntohl(*(int32_t*)p) == 2,</div>
<div class="line">      <span class="stringliteral">&quot;Seqno not set properly; got %d instead of 2 at offset %d&quot;</span>,</div>
<div class="line">      ntohl(*(int32_t*)p), offset);</div>
<div class="line">  offset+=4;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Verify timestamp */</span></div>
<div class="line">  fail_unless(msg[offset] == <a class="code" href="marshal_8c.html#a9290324f1f88b0f007de36d523d8cf3a">DOUBLE_T</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Timestamp type not set properly; got %d instead of %d&quot;</span>,</div>
<div class="line">      msg[offset], <a class="code" href="marshal_8c.html#a9290324f1f88b0f007de36d523d8cf3a">DOUBLE_T</a>);</div>
<div class="line">  offset++;</div>
<div class="line">  d2 = ((double)(ntohl((int32_t)(msg[offset])) * (1 &lt;&lt; msg[offset+4])))/(1&lt;&lt;30);</div>
<div class="line">  fail_unless(d2 - 3. &lt; <a class="code" href="check__libshared__marshal_8c.html#a002b2f4894492820fe708b1b7e7c5e70">EPSILON</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Timestamp not set properly; got M=%d, x=%d; 2^xM/2^30=%f instead of 3&quot;</span>,</div>
<div class="line">      ntohl((int32_t)(msg[offset])), msg[offset+4], d2, offset);</div>
<div class="line">  offset+=5;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Marshall and verify INT32 */</span></div>
<div class="line">  <a class="code" href="oml__value_8c.html#a7213e167ca9eb81228f8b7952e99f8c9">oml_value_set_type</a>(&amp;v, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aab24deeb6fcd36f47779e12dca2c38b9">OML_INT32_VALUE</a>);</div>
<div class="line">  <a class="code" href="omlc_8h.html#aa8a1827db1559f247bf8a4023e466873">omlc_set_int32</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;v), d32);</div>
<div class="line">  <a class="code" href="marshal_8c.html#a8ed4743985ce5ef8d39b45a8155e2555">marshal_values</a>(mbuf, &amp;v, 1);</div>
<div class="line">  <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>++;</div>
<div class="line">  fail_unless(msg[5] == <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Number of elements not set properly; got %d instead of %d&quot;</span>,</div>
<div class="line">      msg[5], <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>);</div>
<div class="line">  fail_unless(msg[offset] == <a class="code" href="marshal_8c.html#a2251891f2e0a2db27ca4c6507d3f4040">INT32_T</a>,</div>
<div class="line">      <span class="stringliteral">&quot;d32 type not set properly; got %d instead of %d at offset %d&quot;</span>,</div>
<div class="line">      msg[offset], <a class="code" href="marshal_8c.html#a2251891f2e0a2db27ca4c6507d3f4040">INT32_T</a>, offset);</div>
<div class="line">  offset++;</div>
<div class="line">  p = &amp;msg[offset];</div>
<div class="line">  fail_unless(ntohl(*(int32_t*)p) == d32,</div>
<div class="line">      <span class="stringliteral">&quot;d32 not set properly; got %d instead of %&quot;</span> PRId32 <span class="stringliteral">&quot; at offset %d&quot;</span>,</div>
<div class="line">      ntohl(*(int32_t*)p), d32, offset);</div>
<div class="line">  offset+=<span class="keyword">sizeof</span>(int32_t);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Marshall and verify UINT32 */</span></div>
<div class="line">  <a class="code" href="oml__value_8c.html#a7213e167ca9eb81228f8b7952e99f8c9">oml_value_set_type</a>(&amp;v, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aad8721fa7d76e62c5885222061fa7827">OML_UINT32_VALUE</a>);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a1e481b1b79bdf517a3507ce8113169b2">omlc_set_uint32</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;v), u32);</div>
<div class="line">  <a class="code" href="marshal_8c.html#a8ed4743985ce5ef8d39b45a8155e2555">marshal_values</a>(mbuf, &amp;v, 1);</div>
<div class="line">  <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>++;</div>
<div class="line">  fail_unless(msg[5] == <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Number of elements not set properly; got %d instead of %d&quot;</span>,</div>
<div class="line">      msg[5], <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>);</div>
<div class="line">  fail_unless(msg[offset] == <a class="code" href="marshal_8c.html#a6bcb89102f0baaa6be3d8d140b2dc866">UINT32_T</a>,</div>
<div class="line">      <span class="stringliteral">&quot;u32 type not set properly; got %d instead of %d at offset %d&quot;</span>,</div>
<div class="line">      msg[offset], <a class="code" href="marshal_8c.html#a6bcb89102f0baaa6be3d8d140b2dc866">UINT32_T</a>, offset);</div>
<div class="line">  offset++;</div>
<div class="line">  p = &amp;msg[offset];</div>
<div class="line">  fail_unless(ntohl(*(uint32_t*)p) == u32,</div>
<div class="line">      <span class="stringliteral">&quot;u32 not set properly; got %d instead of %&quot;</span> PRIu32 <span class="stringliteral">&quot; at offset %d&quot;</span>,</div>
<div class="line">      ntohl(*(uint32_t*)p), u32, offset);</div>
<div class="line">  offset+=<span class="keyword">sizeof</span>(uint32_t);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Marshall and verify INT64 */</span></div>
<div class="line">  <a class="code" href="oml__value_8c.html#a7213e167ca9eb81228f8b7952e99f8c9">oml_value_set_type</a>(&amp;v, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012af4f2a3a1e0887652fb41bab6b6bb96ee">OML_INT64_VALUE</a>);</div>
<div class="line">  <a class="code" href="omlc_8h.html#ae05c1e9d59d47fac7ce71b2136533958">omlc_set_int64</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;v), d64);</div>
<div class="line">  <a class="code" href="marshal_8c.html#a8ed4743985ce5ef8d39b45a8155e2555">marshal_values</a>(mbuf, &amp;v, 1);</div>
<div class="line">  <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>++;</div>
<div class="line">  fail_unless(msg[5] == <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Number of elements not set properly; got %d instead of %d&quot;</span>,</div>
<div class="line">      msg[5], <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>);</div>
<div class="line">  fail_unless(msg[offset] == <a class="code" href="marshal_8c.html#afb3891492b67fa5ded53824df675ae9b">INT64_T</a>,</div>
<div class="line">      <span class="stringliteral">&quot;d64 type not set properly; got %d instead of %d at offset %d&quot;</span>,</div>
<div class="line">      msg[offset], <a class="code" href="marshal_8c.html#afb3891492b67fa5ded53824df675ae9b">INT64_T</a>, offset);</div>
<div class="line">  offset++;</div>
<div class="line">  p = &amp;msg[offset];</div>
<div class="line">  fail_unless(<a class="code" href="htonll_8h.html#a47f5c12368dfdf98a92bb0a8175c006f">ntohll</a>(*(int64_t*)p) == d64,</div>
<div class="line">      <span class="stringliteral">&quot;d64 not set properly; got %d instead of %&quot;</span> PRId64 <span class="stringliteral">&quot; at offset %d&quot;</span>,</div>
<div class="line">      <a class="code" href="htonll_8h.html#a47f5c12368dfdf98a92bb0a8175c006f">ntohll</a>(*(int64_t*)p), d64, offset);</div>
<div class="line">  offset+=<span class="keyword">sizeof</span>(int64_t);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Marshall and verify UINT64 */</span></div>
<div class="line">  <a class="code" href="oml__value_8c.html#a7213e167ca9eb81228f8b7952e99f8c9">oml_value_set_type</a>(&amp;v, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aa0ecc1e475955c44a641c75e841ca2fc">OML_UINT64_VALUE</a>);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a873792518d05507bf5d0b1a96524b091">omlc_set_uint64</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;v), u64);</div>
<div class="line">  <a class="code" href="marshal_8c.html#a8ed4743985ce5ef8d39b45a8155e2555">marshal_values</a>(mbuf, &amp;v, 1);</div>
<div class="line">  <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>++;</div>
<div class="line">  fail_unless(msg[5] == <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Number of elements not set properly; got %d instead of %d&quot;</span>,</div>
<div class="line">      msg[5], <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>);</div>
<div class="line">  fail_unless(msg[offset] == <a class="code" href="marshal_8c.html#a8065a16ba5bd6bb2bd861936a87b31c3">UINT64_T</a>,</div>
<div class="line">      <span class="stringliteral">&quot;u64 type not set properly; got %d instead of %d at offset %d&quot;</span>,</div>
<div class="line">      msg[offset], <a class="code" href="marshal_8c.html#a8065a16ba5bd6bb2bd861936a87b31c3">UINT64_T</a>, offset);</div>
<div class="line">  offset++;</div>
<div class="line">  p = &amp;msg[offset];</div>
<div class="line">  fail_unless(<a class="code" href="htonll_8h.html#a47f5c12368dfdf98a92bb0a8175c006f">ntohll</a>(*(uint64_t*)p) == u64,</div>
<div class="line">      <span class="stringliteral">&quot;u64 not set properly; got %d instead of %&quot;</span> PRIu64 <span class="stringliteral">&quot; at offset %d&quot;</span>,</div>
<div class="line">      <a class="code" href="htonll_8h.html#a47f5c12368dfdf98a92bb0a8175c006f">ntohll</a>(*(uint64_t*)p), u64, offset);</div>
<div class="line">  offset+=<span class="keyword">sizeof</span>(uint64_t);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Marshall and verify LONG */</span></div>
<div class="line">  <a class="code" href="oml__value_8c.html#a7213e167ca9eb81228f8b7952e99f8c9">oml_value_set_type</a>(&amp;v, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012a22fda4d714f29db7df49a3574986e67c">OML_LONG_VALUE</a>);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a799e1ce72c79484ef5efe79bf5a408af">omlc_set_long</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;v), l);</div>
<div class="line">  <a class="code" href="marshal_8c.html#a8ed4743985ce5ef8d39b45a8155e2555">marshal_values</a>(mbuf, &amp;v, 1);</div>
<div class="line">  <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>++;</div>
<div class="line">  fail_unless(msg[5] == <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Number of elements not set properly; got %d instead of %d&quot;</span>,</div>
<div class="line">      msg[5], <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>);</div>
<div class="line">  fail_unless(msg[offset] == <a class="code" href="marshal_8c.html#a95f0d5df544261dab0fd0dcc5063de1f">LONG_T</a>,</div>
<div class="line">      <span class="stringliteral">&quot;l type not set properly; got %d instead of %d at offset %d&quot;</span>,</div>
<div class="line">      msg[offset], <a class="code" href="marshal_8c.html#a95f0d5df544261dab0fd0dcc5063de1f">LONG_T</a>, offset);</div>
<div class="line">  offset++;</div>
<div class="line">  p = &amp;msg[offset];</div>
<div class="line">  <span class="comment">/* Longs are 4 bytes on the wire, the size of an int32_t*/</span></div>
<div class="line">  fail_unless(ntohl(*(int32_t*)p) == oml_value_clamp_long(l),</div>
<div class="line">      <span class="stringliteral">&quot;l not set properly; got %d instead of %ld at offset %d&quot;</span>,</div>
<div class="line">      ntohl(*(int32_t*)p), oml_value_clamp_long(l), offset);</div>
<div class="line">  offset+=<span class="keyword">sizeof</span>(int32_t);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Marshall and verify DOUBLE */</span></div>
<div class="line">  <a class="code" href="oml__value_8c.html#a7213e167ca9eb81228f8b7952e99f8c9">oml_value_set_type</a>(&amp;v, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012adf6df4b257026d03f661cfb85dc7d1c3">OML_DOUBLE_VALUE</a>);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a6a342646d654733d01aff00bf9a308da">omlc_set_double</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;v), d);</div>
<div class="line">  <a class="code" href="marshal_8c.html#a8ed4743985ce5ef8d39b45a8155e2555">marshal_values</a>(mbuf, &amp;v, 1);</div>
<div class="line">  <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>++;</div>
<div class="line">  fail_unless(msg[5] == <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Number of elements not set properly; got %d instead of %d&quot;</span>,</div>
<div class="line">      msg[5], <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>);</div>
<div class="line">  fail_unless(msg[offset] == <a class="code" href="marshal_8c.html#a9290324f1f88b0f007de36d523d8cf3a">DOUBLE_T</a>,</div>
<div class="line">      <span class="stringliteral">&quot;d type not set properly; got %d instead of %d&quot;</span>,</div>
<div class="line">      msg[offset], <a class="code" href="marshal_8c.html#a9290324f1f88b0f007de36d523d8cf3a">DOUBLE_T</a>);</div>
<div class="line">  offset++;</div>
<div class="line">  d2 = ((double)(ntohl((int32_t)(msg[offset])) * (1 &lt;&lt; msg[offset+4])))/(1&lt;&lt;30);</div>
<div class="line">  fail_unless(d2 - d &lt; <a class="code" href="check__libshared__marshal_8c.html#a002b2f4894492820fe708b1b7e7c5e70">EPSILON</a>,</div>
<div class="line">      <span class="stringliteral">&quot;d not set properly; got M=%d, x=%d; 2^xM/2^30=%f instead of 2&quot;</span>,</div>
<div class="line">      ntohl((int32_t)(msg[offset])), msg[offset+4], d2, offset);</div>
<div class="line">  offset+=5;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Marshall and verify STRING */</span></div>
<div class="line">  <a class="code" href="oml__value_8c.html#a7213e167ca9eb81228f8b7952e99f8c9">oml_value_set_type</a>(&amp;v, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012a42b33eb7c21f79727a894a530a05b559">OML_STRING_VALUE</a>);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a4eed1605fcf935e2bb7f9944066dd62c">omlc_set_string_copy</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;v), s, len);</div>
<div class="line">  <a class="code" href="marshal_8c.html#a8ed4743985ce5ef8d39b45a8155e2555">marshal_values</a>(mbuf, &amp;v, 1);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a1434bd8b5a841357336609930bdb05c3">omlc_reset_string</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;v));</div>
<div class="line">  <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>++;</div>
<div class="line">  fail_unless(msg[5] == <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Number of elements not set properly; got %d instead of %d&quot;</span>,</div>
<div class="line">      msg[5], <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>);</div>
<div class="line">  fail_unless(msg[offset] == <a class="code" href="marshal_8c.html#a64b41f937ac6a39ee0c32adecfa606dd">STRING_T</a>,</div>
<div class="line">      <span class="stringliteral">&quot;s type not set properly; got %d instead of %d at offset %d&quot;</span>,</div>
<div class="line">      msg[offset], <a class="code" href="marshal_8c.html#a64b41f937ac6a39ee0c32adecfa606dd">STRING_T</a>, offset);</div>
<div class="line">  offset++;</div>
<div class="line">  fail_unless(msg[offset] == len,</div>
<div class="line">      <span class="stringliteral">&quot;s length not set properly; got %d instead of %d at offset %d&quot;</span>,</div>
<div class="line">      msg[offset], len, offset);</div>
<div class="line">  offset++;</div>
<div class="line">  fail_if(strncmp((<span class="keywordtype">char</span> *)&amp;msg[offset], s, len),</div>
<div class="line">      <span class="stringliteral">&quot;s mismatch&quot;</span>);</div>
<div class="line">  offset+=len;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Marshall and verify BLOB */</span></div>
<div class="line">  <a class="code" href="oml__value_8c.html#a7213e167ca9eb81228f8b7952e99f8c9">oml_value_set_type</a>(&amp;v, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aea7273ecb417f61976d2089a31e75037">OML_BLOB_VALUE</a>);</div>
<div class="line">  <a class="code" href="omlc_8h.html#af59728cba3c4fd80c107c58fa9a1179c">omlc_set_blob</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;v), s, len);</div>
<div class="line">  <a class="code" href="marshal_8c.html#a8ed4743985ce5ef8d39b45a8155e2555">marshal_values</a>(mbuf, &amp;v, 1);</div>
<div class="line">  <a class="code" href="omlc_8h.html#afd4a7d8b9b3f9c09228329b443e07afd">omlc_reset_blob</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;v));</div>
<div class="line">  <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>++;</div>
<div class="line">  fail_unless(msg[5] == <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Number of elements not set properly; got %d instead of %d&quot;</span>,</div>
<div class="line">      msg[5], <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>);</div>
<div class="line">  fail_unless(msg[offset] == <a class="code" href="marshal_8c.html#a2be536a5a6e8f0b613f766f04743581d">BLOB_T</a>,</div>
<div class="line">      <span class="stringliteral">&quot;b type not set properly; got %d instead of %d at offset %d&quot;</span>,</div>
<div class="line">      msg[offset], <a class="code" href="marshal_8c.html#a2be536a5a6e8f0b613f766f04743581d">BLOB_T</a>, offset);</div>
<div class="line">  offset++;</div>
<div class="line">  <span class="comment">/* Blobs have a 32 bits length field */</span></div>
<div class="line">  p = &amp;msg[offset];</div>
<div class="line">  fail_unless(ntohl(*(uint32_t*)p) == len,</div>
<div class="line">      <span class="stringliteral">&quot;b length not set properly; got %d instead of %&quot;</span> PRIu32 <span class="stringliteral">&quot; at offset %d&quot;</span>,</div>
<div class="line">      ntohl(*(uint32_t*)p), len, offset);</div>
<div class="line">  offset+=<span class="keyword">sizeof</span>(uint32_t);</div>
<div class="line">  fail_if(strncmp((<span class="keywordtype">char</span> *)&amp;msg[offset], s, len),</div>
<div class="line">      <span class="stringliteral">&quot;b mismatch&quot;</span>);</div>
<div class="line">  offset+=len;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Marshall and verify GUID */</span></div>
<div class="line">  <a class="code" href="oml__value_8c.html#a7213e167ca9eb81228f8b7952e99f8c9">oml_value_set_type</a>(&amp;v, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012a8f383c792a4697dbf4db99ef2514853f">OML_GUID_VALUE</a>);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a836a2fe9346677384bf5dd8dee7eb0ed">omlc_set_guid</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;v), guid);</div>
<div class="line">  <a class="code" href="marshal_8c.html#a8ed4743985ce5ef8d39b45a8155e2555">marshal_values</a>(mbuf, &amp;v, 1);</div>
<div class="line">  <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>++;</div>
<div class="line">  fail_unless(msg[5] == <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Number of elements not set properly; got %d instead of %d&quot;</span>,</div>
<div class="line">      msg[5], <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>);</div>
<div class="line">  fail_unless(msg[offset] == <a class="code" href="marshal_8c.html#a06c2c3d86fd6e81c65fa34777944f495">GUID_T</a>,</div>
<div class="line">      <span class="stringliteral">&quot;guid type not set properly; got %d instead of %d at offset %d&quot;</span>,</div>
<div class="line">      msg[offset], <a class="code" href="marshal_8c.html#a06c2c3d86fd6e81c65fa34777944f495">GUID_T</a>, offset);</div>
<div class="line">  offset++;</div>
<div class="line">  p = &amp;msg[offset];</div>
<div class="line">  fail_unless(<a class="code" href="htonll_8h.html#a47f5c12368dfdf98a92bb0a8175c006f">ntohll</a>(*(<a class="code" href="omlc_8h.html#a8679c9edab629e9ce63964b64929aaf1">oml_guid_t</a>*)p) == guid,</div>
<div class="line">      <span class="stringliteral">&quot;guid not set properly; got %d instead of %&quot;</span> PRIu64 <span class="stringliteral">&quot; at offset %d&quot;</span>,</div>
<div class="line">      <a class="code" href="htonll_8h.html#a47f5c12368dfdf98a92bb0a8175c006f">ntohll</a>(*(<a class="code" href="omlc_8h.html#a8679c9edab629e9ce63964b64929aaf1">oml_guid_t</a>*)p), (uint64_t)guid, offset);</div>
<div class="line">  offset+=<span class="keyword">sizeof</span>(<a class="code" href="omlc_8h.html#a8679c9edab629e9ce63964b64929aaf1">oml_guid_t</a>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Marshall and verify BOOL FALSE */</span></div>
<div class="line">  <a class="code" href="oml__value_8c.html#a7213e167ca9eb81228f8b7952e99f8c9">oml_value_set_type</a>(&amp;v, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012ac12a596e1ea36e0a6f0c58d2b63c8046">OML_BOOL_VALUE</a>);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a8d84dc9e74c5e2c6fe319a6e1d9f8776">omlc_set_bool</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;v), bfalse);</div>
<div class="line">  <a class="code" href="marshal_8c.html#a8ed4743985ce5ef8d39b45a8155e2555">marshal_values</a>(mbuf, &amp;v, 1);</div>
<div class="line">  <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>++;</div>
<div class="line">  fail_unless(msg[5] == <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Number of elements not set properly; got %d instead of %d&quot;</span>,</div>
<div class="line">      msg[5], <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>);</div>
<div class="line">  fail_unless(msg[offset] == <a class="code" href="marshal_8c.html#a7e5ce4a4afe3c8c5e6a166a98c73bf49">BOOL_FALSE_T</a>,</div>
<div class="line">      <span class="stringliteral">&quot;bool type not set properly; got %d instead of %d at offset %d&quot;</span>,</div>
<div class="line">      msg[offset], <a class="code" href="marshal_8c.html#a7e5ce4a4afe3c8c5e6a166a98c73bf49">BOOL_FALSE_T</a>, offset);</div>
<div class="line">  offset++;</div>
<div class="line">  <span class="comment">/* The bool type already contains the value */</span></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Marshall and verify BOOL TRUE */</span></div>
<div class="line">  <a class="code" href="oml__value_8c.html#a7213e167ca9eb81228f8b7952e99f8c9">oml_value_set_type</a>(&amp;v, <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012ac12a596e1ea36e0a6f0c58d2b63c8046">OML_BOOL_VALUE</a>);</div>
<div class="line">  <a class="code" href="omlc_8h.html#a8d84dc9e74c5e2c6fe319a6e1d9f8776">omlc_set_bool</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;v), btrue);</div>
<div class="line">  <a class="code" href="marshal_8c.html#a8ed4743985ce5ef8d39b45a8155e2555">marshal_values</a>(mbuf, &amp;v, 1);</div>
<div class="line">  <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>++;</div>
<div class="line">  fail_unless(msg[5] == <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Number of elements not set properly; got %d instead of %d&quot;</span>,</div>
<div class="line">      msg[5], <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>);</div>
<div class="line">  fail_unless(msg[offset] == <a class="code" href="marshal_8c.html#aaaece6ec7d7273c485301e9b4a88c27e">BOOL_TRUE_T</a>,</div>
<div class="line">      <span class="stringliteral">&quot;bool type not set properly; got %d instead of %d at offset %d&quot;</span>,</div>
<div class="line">      msg[offset], <a class="code" href="marshal_8c.html#aaaece6ec7d7273c485301e9b4a88c27e">BOOL_TRUE_T</a>, offset);</div>
<div class="line">  offset++;</div>
<div class="line">  <span class="comment">/* The bool type already contains the value */</span></div>
<div class="line"></div>
<div class="line">  fail_unless(<a class="code" href="marshal_8c.html#a0c0615d0abcd3673b56b0c7f68076895">marshal_finalize</a>(mbuf) == 1);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="check__libshared__marshal_8c.html#aed366c04ade17b819f78a3e69e102f01">dumpmessage</a>(mbuf);</div>
<div class="line"></div>
<div class="line">  fail_unless((msg[2] == <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aa98d5a2a2fd99f1cea2d4f90ece79cf49">OMB_DATA_P</a> &amp;&amp; <a class="code" href="mbuf_8c.html#a1afcdf8eb3312a3006b1ed5cc8e8843e">mbuf_message_length</a>(mbuf)&lt;=UINT16_MAX) ||</div>
<div class="line">      ((msg[2] == <a class="code" href="marshal_8h.html#aae2cbd51c9149df19ecd8e790db4ab0aaa3c47b159216a0127bcfea4f07c4a693">OMB_LDATA_P</a> &amp;&amp; <a class="code" href="mbuf_8c.html#a1afcdf8eb3312a3006b1ed5cc8e8843e">mbuf_message_length</a>(mbuf)&gt;UINT16_MAX)),</div>
<div class="line">      <span class="stringliteral">&quot;Message type not properly adjusted&quot;</span>);</div>
<div class="line">  <span class="comment">/* XXX: The following assumes OMB_DATA_P and will fail for OMB_LDATA_P;</span></div>
<div class="line"><span class="comment">   * need to add 2 to PACKET_HEADER_SIZE in that case */</span></div>
<div class="line">  p = &amp;msg[3];</div>
<div class="line">  fail_unless(ntohs(*(uint16_t*)p) == (<a class="code" href="mbuf_8c.html#a1afcdf8eb3312a3006b1ed5cc8e8843e">mbuf_message_length</a>(mbuf) - <a class="code" href="check__libshared__marshal_8c.html#a69bfb6e73bae0625ac56f441ccf542d1">PACKET_HEADER_SIZE</a>),</div>
<div class="line">      <span class="stringliteral">&quot;Message length not set properly; got %d instead of %d at offset 3&quot;</span>,</div>
<div class="line">      ntohs(*(uint16_t*)p), (<a class="code" href="mbuf_8c.html#a1afcdf8eb3312a3006b1ed5cc8e8843e">mbuf_message_length</a>(mbuf) - <a class="code" href="check__libshared__marshal_8c.html#a69bfb6e73bae0625ac56f441ccf542d1">PACKET_HEADER_SIZE</a>));</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * UNMARSHALLING STARTS HERE</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  fail_unless(<a class="code" href="marshal_8c.html#a50099442a78fa10193ffa16aaf06c6ab">unmarshal_init</a>(mbuf, &amp;h) == 1);</div>
<div class="line">  fail_unless(h.<a class="code" href="structOmlBinaryHeader.html#a2417e0ee3d2094711a98f92ea00d0608">length</a> == (<a class="code" href="mbuf_8c.html#a1afcdf8eb3312a3006b1ed5cc8e8843e">mbuf_message_length</a>(mbuf) - <a class="code" href="check__libshared__marshal_8c.html#a69bfb6e73bae0625ac56f441ccf542d1">PACKET_HEADER_SIZE</a>),</div>
<div class="line">      <span class="stringliteral">&quot;Message length not retrieved properly; got %d instead of %d at offset 3&quot;</span>,</div>
<div class="line">      h.<a class="code" href="structOmlBinaryHeader.html#a2417e0ee3d2094711a98f92ea00d0608">length</a>, (<a class="code" href="mbuf_8c.html#a1afcdf8eb3312a3006b1ed5cc8e8843e">mbuf_message_length</a>(mbuf) - <a class="code" href="check__libshared__marshal_8c.html#a69bfb6e73bae0625ac56f441ccf542d1">PACKET_HEADER_SIZE</a>));</div>
<div class="line">  fail_unless(h.<a class="code" href="structOmlBinaryHeader.html#a3d0aea253e7297a378da0ae9931bf3f7">values</a> == <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Number of elements not retrieved properly; got %d instead of %d&quot;</span>,</div>
<div class="line">      h.<a class="code" href="structOmlBinaryHeader.html#a3d0aea253e7297a378da0ae9931bf3f7">values</a>, <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>);</div>
<div class="line">  fail_unless(h.<a class="code" href="structOmlBinaryHeader.html#a7307c8a8c7e51271dcac40fb068d5bc4">stream</a> == 1,</div>
<div class="line">      <span class="stringliteral">&quot;Stream number not set properly; got %d instead of 1 &quot;</span>,</div>
<div class="line">      h.<a class="code" href="structOmlBinaryHeader.html#a7307c8a8c7e51271dcac40fb068d5bc4">stream</a>);</div>
<div class="line">  fail_unless(h.<a class="code" href="structOmlBinaryHeader.html#afbd06e85da03463c78d51f06c97a384d">seqno</a> == 2,</div>
<div class="line">      <span class="stringliteral">&quot;Seqno not set properly; got %d instead of 2 &quot;</span>,</div>
<div class="line">      h.<a class="code" href="structOmlBinaryHeader.html#afbd06e85da03463c78d51f06c97a384d">seqno</a>);</div>
<div class="line">  fail_unless(h.<a class="code" href="structOmlBinaryHeader.html#ae2557729ebf8397128b88077c465edd6">timestamp</a> - 3. &lt; <a class="code" href="check__libshared__marshal_8c.html#a002b2f4894492820fe708b1b7e7c5e70">EPSILON</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Timestamp not set properly; got =%f instead of 3&quot;</span>,</div>
<div class="line">      h.<a class="code" href="structOmlBinaryHeader.html#ae2557729ebf8397128b88077c465edd6">timestamp</a>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Unmarshal everything into dynamically allocated memory (va) */</span></div>
<div class="line">  <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a> = <a class="code" href="marshal_8c.html#a5398fde39990827c7e2070af9ea94145">unmarshal_values</a>(mbuf, &amp;h, NULL, 0);</div>
<div class="line">  fail_unless(<a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a> == -h.<a class="code" href="structOmlBinaryHeader.html#a3d0aea253e7297a378da0ae9931bf3f7">values</a>,</div>
<div class="line">      <span class="stringliteral">&quot;unmarshal_values() with no storage did not report the right needed space; %d instead of %d&quot;</span>,</div>
<div class="line">      <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>, -h.<a class="code" href="structOmlBinaryHeader.html#a3d0aea253e7297a378da0ae9931bf3f7">values</a>);</div>
<div class="line">  va = malloc(h.<a class="code" href="structOmlBinaryHeader.html#a3d0aea253e7297a378da0ae9931bf3f7">values</a>*<span class="keyword">sizeof</span>(<a class="code" href="structOmlValue.html">OmlValue</a>));</div>
<div class="line">  <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a> = <a class="code" href="marshal_8c.html#a5398fde39990827c7e2070af9ea94145">unmarshal_values</a>(mbuf, &amp;h, va, h.<a class="code" href="structOmlBinaryHeader.html#a3d0aea253e7297a378da0ae9931bf3f7">values</a>);</div>
<div class="line">  fail_unless(<a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a> == h.<a class="code" href="structOmlBinaryHeader.html#a3d0aea253e7297a378da0ae9931bf3f7">values</a>,</div>
<div class="line">      <span class="stringliteral">&quot;unmarshal_values() did not return the expected success value; %d instead of %d&quot;</span>,</div>
<div class="line">      <a class="code" href="stddev__0_8c.html#af16d1aad57793bdd673526c79ac6fbfe">count</a>, h.<a class="code" href="structOmlBinaryHeader.html#a3d0aea253e7297a378da0ae9931bf3f7">values</a>);</div>
<div class="line">  offset = 0;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Verify unmarshalled INT32 */</span></div>
<div class="line">  fail_unless(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset]) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aab24deeb6fcd36f47779e12dca2c38b9">OML_INT32_VALUE</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got invalid type %s instead of %s&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset])), <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aab24deeb6fcd36f47779e12dca2c38b9">OML_INT32_VALUE</a>));</div>
<div class="line">  fail_unless(<a class="code" href="omlc_8h.html#a6314fe3dc202a16edcd064d8504a24d5">omlc_get_int32</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])) == d32,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got %&quot;</span> PRId32 <span class="stringliteral">&quot; instead of %s&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="omlc_8h.html#a6314fe3dc202a16edcd064d8504a24d5">omlc_get_int32</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])), d32);</div>
<div class="line">  offset++;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Verify unmarshalled UINT32 */</span></div>
<div class="line">  fail_unless(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset]) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aad8721fa7d76e62c5885222061fa7827">OML_UINT32_VALUE</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got invalid type %s instead of %s&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset])), <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aad8721fa7d76e62c5885222061fa7827">OML_UINT32_VALUE</a>));</div>
<div class="line">  fail_unless(<a class="code" href="omlc_8h.html#a1493babcfc9c69f6aa7efebf049c7a22">omlc_get_uint32</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])) == u32,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got %&quot;</span> PRIu32 <span class="stringliteral">&quot; instead of %s&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="omlc_8h.html#a1493babcfc9c69f6aa7efebf049c7a22">omlc_get_uint32</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])), u32);</div>
<div class="line">  offset++;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Verify unmarshalled INT64 */</span></div>
<div class="line">  fail_unless(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset]) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012af4f2a3a1e0887652fb41bab6b6bb96ee">OML_INT64_VALUE</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got invalid type %s instead of %s&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset])), <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012af4f2a3a1e0887652fb41bab6b6bb96ee">OML_INT64_VALUE</a>));</div>
<div class="line">  fail_unless(<a class="code" href="omlc_8h.html#aeb1480723c7d9b86609a6dea4440a52d">omlc_get_int64</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])) == d64,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got %&quot;</span> PRId64 <span class="stringliteral">&quot; instead of %&quot;</span> PRId64 <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="omlc_8h.html#aeb1480723c7d9b86609a6dea4440a52d">omlc_get_int64</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])), d64);</div>
<div class="line">  offset++;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Verify unmarshalled UINT64 */</span></div>
<div class="line">  fail_unless(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset]) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aa0ecc1e475955c44a641c75e841ca2fc">OML_UINT64_VALUE</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got invalid type %s instead of %s&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset])), <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aa0ecc1e475955c44a641c75e841ca2fc">OML_UINT64_VALUE</a>));</div>
<div class="line">  fail_unless(<a class="code" href="omlc_8h.html#a37958a949ce7353bd25dee96810e2cd6">omlc_get_uint64</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])) == u64,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got %&quot;</span> PRIu64 <span class="stringliteral">&quot; instead of %&quot;</span> PRIu64 <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="omlc_8h.html#a37958a949ce7353bd25dee96810e2cd6">omlc_get_uint64</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])), u64);</div>
<div class="line">  offset++;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Verify unmarshalled LONG (marshalled as OML_INT32_VALUE) */</span></div>
<div class="line">  fail_unless(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset]) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aab24deeb6fcd36f47779e12dca2c38b9">OML_INT32_VALUE</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got invalid type %s instead of %s&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset])), <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aab24deeb6fcd36f47779e12dca2c38b9">OML_INT32_VALUE</a>));</div>
<div class="line">  fail_unless(<a class="code" href="omlc_8h.html#a6314fe3dc202a16edcd064d8504a24d5">omlc_get_int32</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])) == l,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got %&quot;</span> PRId32 <span class="stringliteral">&quot; instead of %&quot;</span> PRId32 <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="omlc_8h.html#a6314fe3dc202a16edcd064d8504a24d5">omlc_get_int32</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])), l);</div>
<div class="line">  offset++;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Verify unmarshalled DOUBLE */</span></div>
<div class="line">  fail_unless(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset]) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012adf6df4b257026d03f661cfb85dc7d1c3">OML_DOUBLE_VALUE</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got invalid type %s instead of %s&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset])), <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012adf6df4b257026d03f661cfb85dc7d1c3">OML_DOUBLE_VALUE</a>));</div>
<div class="line">  fail_unless(<a class="code" href="omlc_8h.html#adb34b291e3acb9b9a52c544c34c6568c">omlc_get_double</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])) - d &lt; <a class="code" href="check__libshared__marshal_8c.html#a002b2f4894492820fe708b1b7e7c5e70">EPSILON</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got %f instead of %f&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="omlc_8h.html#adb34b291e3acb9b9a52c544c34c6568c">omlc_get_double</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])), d);</div>
<div class="line">  offset++;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Verify unmarshalled STRING */</span></div>
<div class="line">  fail_unless(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset]) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012a42b33eb7c21f79727a894a530a05b559">OML_STRING_VALUE</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got invalid type %s instead of %s&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset])), <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012a42b33eb7c21f79727a894a530a05b559">OML_STRING_VALUE</a>));</div>
<div class="line">  fail_unless(<a class="code" href="omlc_8h.html#ac67055f6576df153bd9915dd7ccb2f6d">omlc_get_string_length</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])) == len,</div>
<div class="line">      <span class="stringliteral">&quot;Read string at offset %d: got invalid length  %d instead of %d&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="omlc_8h.html#ac67055f6576df153bd9915dd7ccb2f6d">omlc_get_string_length</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])), len);</div>
<div class="line">  fail_if(strncmp(<a class="code" href="omlc_8h.html#ae5077b9404ef5c4c2f66a1a654430512">omlc_get_string_ptr</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])), s, len),</div>
<div class="line">      <span class="stringliteral">&quot;Read string at offset %d: mismatch&quot;</span>,</div>
<div class="line">      offset);</div>
<div class="line">  offset++;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Verify unmarshalled BLOB */</span></div>
<div class="line">  fail_unless(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset]) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aea7273ecb417f61976d2089a31e75037">OML_BLOB_VALUE</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got invalid type %s instead of %s&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset])), <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012aea7273ecb417f61976d2089a31e75037">OML_BLOB_VALUE</a>));</div>
<div class="line">  fail_unless(<a class="code" href="omlc_8h.html#a8889e12c16c598b5d1f633ab07680010">omlc_get_blob_length</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])) == len,</div>
<div class="line">      <span class="stringliteral">&quot;Read blob at offset %d: got invalid length  %d instead of %d&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="omlc_8h.html#a8889e12c16c598b5d1f633ab07680010">omlc_get_blob_length</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])), len);</div>
<div class="line">  fail_if(strncmp(<a class="code" href="omlc_8h.html#ab27d41701e48bc5ebd9e41e21e771cf6">omlc_get_blob_ptr</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])), b, len),</div>
<div class="line">      <span class="stringliteral">&quot;Read blob at offset %d: mismatch&quot;</span>,</div>
<div class="line">      offset);</div>
<div class="line">  offset++;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Verify unmarshalled GUID */</span></div>
<div class="line">  fail_unless(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset]) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012a8f383c792a4697dbf4db99ef2514853f">OML_GUID_VALUE</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got invalid type %s instead of %s&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset])), <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012a8f383c792a4697dbf4db99ef2514853f">OML_GUID_VALUE</a>));</div>
<div class="line">  fail_unless(<a class="code" href="omlc_8h.html#a2ef9e64d176c33c11c98d11fae69a5ea">omlc_get_guid</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])) == guid,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got %&quot;</span> PRIu64 <span class="stringliteral">&quot; instead of %&quot;</span> PRIu64 <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="omlc_8h.html#a2ef9e64d176c33c11c98d11fae69a5ea">omlc_get_guid</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset])), (uint64_t)guid);</div>
<div class="line">  offset++;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Verify unmarshalled BOOL FALSE */</span></div>
<div class="line">  fail_unless(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset]) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012ac12a596e1ea36e0a6f0c58d2b63c8046">OML_BOOL_VALUE</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got invalid type %s instead of %s&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset])), <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012ac12a596e1ea36e0a6f0c58d2b63c8046">OML_BOOL_VALUE</a>));</div>
<div class="line">  bval = <a class="code" href="omlc_8h.html#ad5e34e372b65dec9ccfc9fc61c3fbc6c">omlc_get_bool</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset]));</div>
<div class="line">  fail_unless(!bval &amp;&amp; !bfalse,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got truth value %&quot;</span> PRIu8 <span class="stringliteral">&quot; instead of %&quot;</span> PRIu8 <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">      offset, bval, bfalse);</div>
<div class="line">  offset++;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Verify unmarshalled BOOL TRUE */</span></div>
<div class="line">  fail_unless(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset]) == <a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012ac12a596e1ea36e0a6f0c58d2b63c8046">OML_BOOL_VALUE</a>,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got invalid type %s instead of %s&quot;</span>,</div>
<div class="line">      offset, <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="oml__value_8h.html#aa1e9629b4e4c34fe9d24ab381ad4550c">oml_value_get_type</a>(&amp;va[offset])), <a class="code" href="oml__value_8c.html#a7599e6fb79e38eda3ed88a6ead2d2caf">oml_type_to_s</a>(<a class="code" href="omlc_8h.html#ab15565231ebb9d8d8550c14e0aaa3012ac12a596e1ea36e0a6f0c58d2b63c8046">OML_BOOL_VALUE</a>));</div>
<div class="line">  bval = <a class="code" href="omlc_8h.html#ad5e34e372b65dec9ccfc9fc61c3fbc6c">omlc_get_bool</a>(*<a class="code" href="oml__value_8h.html#a4f590bee663b713f2afeee50ca06260b">oml_value_get_value</a>(&amp;va[offset]));</div>
<div class="line">  fail_unless(bval &amp;&amp; btrue,</div>
<div class="line">      <span class="stringliteral">&quot;Read value at offset %d: got truth value %&quot;</span> PRIu8 <span class="stringliteral">&quot; instead of %&quot;</span> PRIu8 <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">      offset, bval, btrue);</div>
<div class="line">  offset++;</div>
<div class="line"></div>
<div class="line">  free(va);</div>
<div class="line">  <a class="code" href="mbuf_8c.html#a15daddf2549ab368d5f307a1175c1df0">mbuf_destroy</a>(mbuf);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<h2>Variable Documentation</h2>
<a class="anchor" id="aa7aa04bfed2ab466dc2cd231d9392e1c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">END_TEST unsigned char string_buf[<a class="el" href="check__libshared__marshal_8c.html#a8eb978c63d7c9fe86a9544bdf8d54fe6">MAX_MARSHALLED_STRING_LENGTH</a> *2]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="check__libshared__marshal_8c_source.html#l00512">512</a> of file <a class="el" href="check__libshared__marshal_8c_source.html">check_libshared_marshal.c</a>.</p>

<p>Referenced by <a class="el" href="check__libshared__marshal_8c_source.html#l00514">START_TEST()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_13e138d54eb8818da29c3992edef070a.html">test</a></li><li class="navelem"><a class="el" href="dir_cb6d4dd8a38058a0954022986ea6be37.html">lib</a></li><li class="navelem"><a class="el" href="check__libshared__marshal_8c.html">check_libshared_marshal.c</a></li>
    <li class="footer">Generated on Thu Jun 25 2015 15:31:54 for oml2 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
