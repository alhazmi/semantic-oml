<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>oml2: OML: The O? Measurement Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="oml_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">oml2
   &#160;<span id="projectnumber">2.12.0pre.79-58cf-dirty</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">OML: The O? Measurement Library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>OML is an instrumentation tool that allows application writers to define customisable measurement points inside new or per-existing applications. Experimenters running the applications can then direct the <em>measurement streams</em> (MS) from these <em>measurement points</em> (MP) to storage in a remote measurement database.</p>
<p>The OML reporting chain consists in several elements:</p>
<ol type="1">
<li>the reporting library (C, Ruby or Python),</li>
<li>the collection server,</li>
<li>the optional proxy, for disconnected experiments.</li>
</ol>
<p>This documentation mainly focuses on configuring the server, and instrumenting applications. Please refer to file <a class="el" href="install.html">INSTALL</a> for instructions on building these programs.</p>
<h1>Running the Server</h1>
<p>The <a href="http://oml.mytestbed.net/doc/oml/2.12/oml2-server.1.html">oml2-server(1)</a> receives measurements streams in the OML protocol (either binary marshalling or text mode), and stores them in a database backend. Currently, SQLite3 is the default, and can be replaced PostgreSQL.</p>
<h2>SQLite</h2>
<p>SQLite <a href="http://sqlite.org/">sqlite</a> is a lightweight SQL file-based database system. Each database is stored as an independent file in the filesystem. The <a href="http://oml.mytestbed.net/doc/oml/2.12/oml2-server.1.html">oml2-server(1)</a> uses this backend by default.</p>
<p>Relevant command line arguments are the following:</p>
<ul>
<li><code>-D DIR</code> or <code>--data-dir=DIR</code> specifies to create the database files in <code>DIR</code>;</li>
<li><code>--user=UID</code> and <code>--group=GID</code> specify as which user (resp. group) the server is run on the system and, consequently, who owns the created database files.</li>
</ul>
<p>Running the server as </p>
<pre class="fragment">$ oml2-server -D /path/to/my/databases --user=oml2 --group=oml2
</pre><p>will instruct it to drop privileges to user:group <code>oml2:oml2</code>, and create and update databases in <code>/path/to/my/databases</code>.</p>
<h2>PostgreSQL</h2>
<p>The database backend can also be PostgreSQL <a href="http://www.postgresql.org/">pgsql</a>. In this case, additional connection information must be passed to the server so it can properly connect to the server, and create databases.</p>
<p>First, a user, say <code>oml</code>, with the appropriate permissions has to be created within PostgreSQL. Note that this username has nothing to do with the system user discussed in the previous section. </p>
<pre class="fragment">$ createuser -U DBADMIN --pwprompt --no-superuser \
    --createdb --no-createrole --no-replication oml
</pre><p><code>DBADMIN</code> is any pre-existing user allowed to create roles in the database. PostgreSQL's default <code>postgres</code> will usually work. The <code>--no-replication</code> argument is only valid with PostgreSQL-9.2. In case of error, simply remove it. A password for the newly created database user will be requested. Alternatively, the role can be created through and interactive console. </p>
<pre class="fragment">$ psql -U DBADMIN
psql (9.3.2)
Type "help" for help.

DBADMIN=# CREATE USER oml WITH PASSWORD 'oml';
CREATE ROLE
DBADMIN=# ALTER ROLE oml WITH CREATEDB;
ALTER ROLE
</pre><p>It is now possible to start the server. Several Postgre-specific options are available (see <a class="el" href="install.html">INSTALL</a> for details on compiling the PostgreSQL backend in).</p>
<ul>
<li><code>--pg-user=USER</code> specifies the name of the user just created (default: <code>oml</code>);</li>
<li><code>--pg-pass=PASS</code> specifies the password of the user just created (default: empty);</li>
<li><code>--pg-host=HOST</code> specifies the host on which the database server runs (default: <code>localhost</code>;</li>
<li><code>--pg-port=PORT</code> specifies the service or port on which the database server expects connections (default: 5432).</li>
</ul>
<p>Of course, it is also necessary to specify that a different database backend is used. This is done with the <code>-b postgresql</code> option. Altogether, the server can be run as </p>
<pre class="fragment">$ oml2-server --user=oml2 --group=oml2 -b postgresql \
    --pg-user=oml --pg-pass=correcthorsebatterystaple \
    --pg-host=db.example.com --pg-port=postgresql
</pre><h2>Server Hook</h2>
<p>The collection server has a rudimentary support for hook scripts to perform some actions when specific conditions occurs. Currently, only database-close and server-exit are supported. The former can be use for, e.g., backup of measurement databases. Example script <a class="el" href="oml2-server-hook_8sh.html">server/oml2-server-hook.sh</a> uses the <code>DBCLOSED</code> event to push experiment databases to IRODS <a href="https://www.irods.org/">irods</a>.</p>
<h2>Integration in Distributions</h2>
<p>Depending on your distribution, there are various ways to change the <a href="http://oml.mytestbed.net/doc/oml/2.12/oml2-server.1.html">oml2-server(1)</a>'s command line arguments to fit it to your needs.</p>
<h3>Debian</h3>
<p>In Debian-based system, file <code>/etc/default/oml2-server</code> can be modified to adjust the parameters of the server. The server can then be (re)started with: </p>
<pre class="fragment">$ sudo service oml2-server restart
</pre><h3>ArchLinux</h3>
<p>ArchLinux uses systemd(1) as its basic system process. A service unit configuration is provided with the package in AUR <a href="https://aur.archlinux.org/">aur</a>. It is installed in <code>/usr/lib/systemd/system/oml2-server.service</code> and uses the SQLite backend in <code>/var/oml2</code>. If you want to override these parameters (e.g., the command line), you need to copy this file to <code>/etc/systemd/system/</code>, and modify that copy. Once done, you'll need to refresh systemd's configuration to take the override into account: </p>
<pre class="fragment"> $ sudo systemctl reenable oml2-server.service
</pre><p>You can then (re)start the service with its new parameters. </p>
<pre class="fragment">$ sudo systemctl (re)start oml2-server.service
</pre><h1>Running the Applications</h1>
<p><a href="http://oml.mytestbed.net/doc/oml/2.12/liboml2.1.html">liboml2(1)</a> extends the command-line parameters of an instrumented application with options specific to reporting. Most of these options can also be passed as environment variables.</p>
<p>OML has the concept of an <em>experimental domain</em>, within which several <em>applications</em> run on one or more <em>node</em>. They generate measurement traffic which is collected and stored together by the <a href="http://oml.mytestbed.net/doc/oml/2.12/oml2-server.1.html">oml2-server(1)</a>. Each experimental domain has its own database, with measurements from all the nodes and applications collected there. More details on these concepts are available at <a href="http://oml.mytestbed.net/projects/oml/wiki/OML_Generic_Interface">oml-gif</a>.</p>
<p>The most important command line arguments (and environment variables) for an instrumented application are the following.</p>
<ul>
<li><code>--oml-id</code> (or <code>OML_ID</code>) is the identifier of the node;</li>
<li><code>--oml-domain</code> (or <code>OML_DOMAIN</code>) is the name of the experimental domain;</li>
<li><code>--oml-collect</code> (or <code>OML_COLLECT</code>) is a URI pointing to the collection server;</li>
<li>each application also defines its own name (see next section).</li>
</ul>
<p>If <code>--oml-collect</code> is not given, a file will be created in the current directory containing text-mode OML protocol <a href="http://oml.mytestbed.net/projects/oml/wiki/Description_of_Text_Protocol">oml-textmode</a>, which can be fed into a server at a later time.</p>
<p>Applications can also be configured more finely through the use of a <a href="http://oml.mytestbed.net/doc/oml/2.12/liboml2.conf.5.html">liboml2.conf(5)</a> file.</p>
<p>More details on these topics are available at <a href="http://oml.mytestbed.net/projects/oml/wiki/Configuring_OML_Client_Applications">oml-conf</a>.</p>
<h1>Instrumenting an Application</h1>
<p>Instrumentation of an application (new or pre-existing) is done through <a href="http://oml.mytestbed.net/doc/oml/2.12/oml2-scaffold.1.html">oml2-scaffold(1)</a>. Based on an concise description of the desired measurement points, this helper generates the relevant header files and appropriate functions to inject measurement samples into a measurement stream.</p>
<p>Essentially, instrumenting an applications therefore consists in writing the application description. A template for this file can be generated for application APPNAME with </p>
<pre class="fragment">$ oml2-scaffold --app APPNAME
</pre><p>After adjusting this template to contain the desired schemas for the various MPs of the application, a header containing helper functions is then generated with </p>
<pre class="fragment">$ oml2-scaffold --oml APPNAME.rb
</pre><p>This creates file <code>APPNAME_oml.h</code> which can be directly included in the application source to provide the oml_inject_MPNAME(3) helpers.</p>
<p>If writing an application from scratch, a template <a class="el" href="generator_8c.html#ac0f2228420376f4db7e1274f2b41667c">main()</a> function and popt(3)-based option parsing code can also be generated with the <code>--main</code> and <code>--opts</code> options.</p>
<p>It is not recommended to manually change the <code>APPNAME_oml.h</code> nor <code>APPNAME_popt.h</code> as they are automatically generated. It is best to include rules for the build system to generate them dynamically as part of the build (<code>BUILT_SOURCES</code>, in the Automake linguo). As a matter of fact, <a href="http://oml.mytestbed.net/doc/oml/2.12/oml2-scaffold.1.html">oml2-scaffold(1)</a> can also generate a rudimentary Makefile which, based on APPNAME.rb and APPNAME.c, can generate all other necessary files, and build the application. This is done with the <code>--make</code> option.</p>
<p>See the example, and its documentation in <a class="el" href="example.html">example/liboml2/README</a>, as well as the <a href="http://oml.mytestbed.net/doc/oml/2.12/oml2-scaffold.1.html">oml2-scaffold(1)</a> and oml_inject_MPNAME(3) manpages for more details.</p>
<p>Some native implementations of the text mode are also available. Though they are built from this same source tree, it might be easier to install them directly from the language-specific module repositories.</p>
<ul>
<li>Python: OML4Py <a href="http://pypi.python.org/pypi/oml4py/">oml4py</a>;</li>
<li>Ruby: OML4R <a href="https://rubygems.org/gems/oml4r/">oml4r</a>;</li>
<li>Java: OML4J <a href="https://github.com/NitLab/oml4j">oml4j</a>, maintained by NITLab <a href="http://nitlab.inf.uth.gr/">nitlab</a>;</li>
</ul>
<h1>Using the Proxy Server</h1>
<p>The <a href="http://oml.mytestbed.net/doc/oml/2.12/oml2-proxy-server.1.html">oml2-proxy-server(1)</a> can be used for situations where a connection to the collection server is temporarily unavailable. It will cache measurement streams until instructed to forward them to the actual collection server.</p>
<p>The proxy has two main states: paused (at startup) and running. It expects instructions on its standard input to change states: <code>OMLPROXY-PAUSE</code>, <code>OMLPROXY-RESUME</code>.</p>
<p>Its most important command line arguments allow to specify the collection server's address (<code>-a ADDR</code> or <code>--dstaddress=ADDR</code>) and port (<code>-p PORT</code> or <code>--dstport=PORT</code>).</p>
<p>Some more details are available at <a href="http://oml.mytestbed.net/projects/oml/wiki/Proxy_Server">oml-proxy</a>.</p>
<h1>Reporting Bugs and Contributing to Development</h1>
<p>External contributions are most welcome. Be they in the form of bug reports or feature request on the tracker <a href="http://oml.mytestbed.net/projects/oml/issues">oml-tracker</a>. You can also register to the mailing list <a href="#" onclick="location.href='mai'+'lto:'+'oml'+'-u'+'ser'+'@l'+'ist'+'s.'+'nic'+'ta'+'.co'+'m.'+'au'; return false;">oml-ml</a>, where you should direct all your questions, comments or contributions. The archives can be consulted at <a href="http://oml.mytestbed.net/tab/show/oml">oml-ml-archives</a>.</p>
<p>The official source tree is stored in a Git repository <a href="git://git.mytestbed.net/oml.git">oml-git</a>. It can be cloned without restrictions. To re-integrate patches (fixing bugs or introducing new features), the best way is to make the Git clone containing the changes public, and submit a pull request. </p>
<pre class="fragment">$ git request-pull origin/release/2.x http://url/of/your/repo \
    # Assuming you started working from origin/release/2.x
</pre><p>Patches formatted by Git are also a good way to do so. </p>
<pre class="fragment">$ git format-patch origin/release/2.x..HEAD \
    # Assuming you started working from origin/release/2.x
</pre><p>In either cases requests and patches should be sent to the mailing list <a href="#" onclick="location.href='mai'+'lto:'+'oml'+'-u'+'ser'+'@l'+'ist'+'s.'+'nic'+'ta'+'.co'+'m.'+'au'; return false;">oml-ml</a>, or a ticket created about them in the issue tracker <a href="http://oml.mytestbed.net/projects/oml/issues">oml-tracker</a>.</p>
<h1>Installing from Distribution Packages</h1>
<p>Though you can build OML from source (see <a class="el" href="install.html">INSTALL</a>), pre-built packages for a few distributions are already available.</p>
<h2>Debian and Ubuntu</h2>
<p>An archive is maintained on the OpenSuSE Build System, with packages for the latest Debian and Ubuntu distributions. You can add it to your <code>/etc/apt/sources.list</code> as </p>
<pre class="fragment">deb http://download.opensuse.org/repositories/home:/cdwertmann:/oml/xUbuntu_12.10/ ./
</pre><p>then run </p>
<pre class="fragment">sudo apt-get update
sudo apt-get install oml2-server liboml2
</pre><p>to install the required components. You'll need <code>liboml2-dev</code> if you want to build instrumented applications.</p>
<h2>ArchLinux</h2>
<p>ArchLinux packages are available from the Arch User Repository <a href="https://aur.archlinux.org/">aur</a>. You can build and install the latest package directly with Yaourt <a href="https://aur.archlinux.org/packages/yaourt/">aur-yaourt</a>. </p>
<pre class="fragment">$ sudo yaourt -S oml2
</pre><p>The stable package is available at <a href="https://aur.archlinux.org/packages/oml2/">aur-oml2</a>, while a development version can be obtained from <a href="https://aur.archlinux.org/packages/oml2-git/">aur-oml2-git</a>.</p>
<h2>RPM-based (CentOS, Fedora)</h2>
<p>RPM packages are also built on the OpenSuSE platform. They are available there [opensuse-oml], as well as the instructions to install them on your system.</p>
<h1>License</h1>
<p>Copyright 2007-2014 National ICT Australia (NICTA), Australia</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Jun 25 2015 15:32:01 for oml2 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
